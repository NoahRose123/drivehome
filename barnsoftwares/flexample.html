<!DOCTYPE html>
<html lang="en">
<head>
    <head>
<link rel="icon" type="image/png" href="/icon.png?v=2">
<link rel="apple-touch-icon" href="/icon.png?v=2">
<link rel="icon" type="image/png" sizes="192x192" href="/iconcropped.png">
<link rel="icon" type="image/png" sizes="512x512" href="/iconcropped.png">
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="#1a365d">
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Farm Management Hub</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Complete Farm Records</title>
</head>
</head>

<artifact identifier="farm-records-with-headers" type="text/html" title="Farm Records with Navigation Headers">
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Complete Farm Records</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
/* Top Header Bar */
.top-header {
   background:#fff;
   color: #2c3e50;
   padding: 15px 20px; /* Reduced from 20px to 15px to make header more compact */
   position: fixed;
   top: 0;
   left: 0;
   right: 0;
   z-index: 1000;
   box-shadow: 0 2px 8px rgba(0,0,0,0.1);
   border-bottom: 3px solid #e9ecef;
}

.top-nav {
   display: flex;
   align-items: center;
   gap: 30px;
}

.logo {
    font-size: 18px;
    font-weight: bold;
    color: #c0392b;
    margin-right: 30px; /* Even more space */
}  

.logo {
    display: flex;
    align-items: center;
    gap: 10px;
    font-size: 18px;
    font-weight: bold;
    color: #c0392b;
    margin-right: 30px;
}

.logo-img {
    height: 80px;  /* Even bigger */
    width: auto;
}
.nav-links {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 25px;
    flex-grow: 1;
    width: 100%;
    padding: 0 20px;
}


.nav-item:hover {
   background: linear-gradient(135deg, #e9ecef 0%, #dee2e6 100%);
   color: #c0392b;
   transform: translateY(-1px);
   box-shadow: 0 3px 6px rgba(0,0,0,0.1);
   border-color: #c0392b;
}

.nav-item.active {
   background: linear-gradient(135deg, #c0392b 0%, #a93226 100%);
   color: white;
   border-color: #a93226;
   box-shadow: 0 3px 6px rgba(192, 57, 43, 0.3);
}

.nav-icon {
  font-weight: normal;
}

/* Collapsible Sidebar Styles */
.sidebar-toggle {
    position: fixed;
    left: 180px;
    top: 120px;
    width: 40px;
    height: 60px;
    background: #c0392b;
    border: 3px solid #fff;
    border-left: none;
    border-top-right-radius: 12px;
    border-bottom-right-radius: 12px;
    cursor: pointer;
    z-index: 9999;
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 1;
    transform: translateX(0);
    transition: all 0.3s ease;
    box-shadow: 3px 0 15px rgba(0,0,0,0.3);
}

.sidebar-toggle:hover {
    background: #a93226;
    width: 45px;
    box-shadow: 3px 0 20px rgba(0,0,0,0.4);
}

.sidebar-toggle-icon {
    font-size: 20px;
    color: white;
    font-weight: bold;
    transform: rotate(0deg);
    transition: transform 0.3s ease;
}

.sidebar-collapsed .sidebar-toggle {
    left: 0;
    background: #27ae60;
    border-color: #fff;
}

.sidebar-collapsed .sidebar-toggle:hover {
    background: #229954;
}

.sidebar-collapsed .sidebar-toggle-icon {
    transform: rotate(180deg);
}

.sidebar-toggle-icon i {
    font-size: 18px;
}
.left-sidebar {
    transform: translateX(0);
    transition: transform 0.3s ease;
}

.sidebar-collapsed .left-sidebar {
    transform: translateX(-100%);
}

.sidebar-collapsed body {
    margin-left: 20px !important;
    transition: margin-left 0.3s ease;
}

.sidebar-collapsed .main-content {
    width: calc(100% + 180px) !important;
    max-width: calc(9.35in + 180px) !important;
    transition: width 0.3s ease, max-width 0.3s ease;
    transform: scale(1.10) !important;
}
.left-sidebar {
    position: fixed;
    left: 0;
    top: 120px; /* Increased from 105px to 120px */
    width: 180px;
    height: calc(100vh - 120px); /* Adjust height calculation to match */
    background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
    border-right: 3px solid #dee2e6; /* Keep right border */
    border-bottom: 3px solid #dee2e6; /* Add bottom border */
    border-top: none; /* Remove top border */
    border-left: none; /* Remove left border */
    padding-top: 25px; /* Increase top padding to push buttons down */
    padding-left: 15px;
    padding-right: 15px;
    padding-bottom: 15px;
    z-index: 998;
    box-shadow: 2px 0 10px rgba(0,0,0,0.05);
}

/* Safety margin for all screen sizes */
@media screen {
    body {
        min-height: calc(100vh - 140px);
        padding-top: 30px; /* Additional top padding for safety */
    }
}

.sidebar-section {
   margin-bottom: 25px;
}

.sidebar-title {
   font-size: 12px;
   font-weight: bold;
   color: #6c757d;
   text-transform: uppercase;
   margin-bottom: 15px;
   letter-spacing: 1px;
   border-bottom: 2px solid #dee2e6;
   padding-bottom: 5px;
}

.sidebar-button {
   display: flex;
   align-items: center;
   gap: 10px;
   width: 100%;
   padding: 12px 15px;
   margin-bottom: 8px;
   background: linear-gradient(135deg, white 0%, #f8f9fa 100%);
   border: 2px solid #dee2e6;
   border-radius: 8px;
   color: #2c3e50;
   text-decoration: none;
   font-size: 13px;
   font-weight: 600;
   transition: all 0.3s ease;
   cursor: pointer;
   box-shadow: 0 2px 4px rgba(0,0,0,0.05);
}

.sidebar-button:hover {
   background: linear-gradient(135deg, #e9ecef 0%, #dee2e6 100%);
   color: #c0392b;
   transform: translateY(-1px);
   box-shadow: 0 3px 6px rgba(0,0,0,0.1);
   border-color: #c0392b;
}

.sidebar-icon {
   font-size: 16px;
}
body {
    font-family: Arial, sans-serif;
    max-width: none;
    margin: 0 auto;
    margin-left: 200px;
    margin-top: 140px;
    padding: 20px;
    background-color: #f8f9fa;
    color: #333;
    font-size: 11px;
    line-height: 1.3;
    min-height: calc(100vh - 140px);
    display: flex;
    flex-direction: column;
    justify-content: center;
}
.page {
    width: 100%;
    max-width: 8.5in;
    margin: 0 auto;
}
.page {
    margin-bottom: 50px;        /* Keep spacing between sections */
    padding-bottom: 30px;       /* Keep internal padding */
    border-bottom: none;        /* Remove the lines */
    page-break-after: always;   /* Keep print page breaks */
}

    .page:last-child {
        border-bottom: none;
        page-break-after: auto;
    }

    .page-title {
        font-size: 20px;
        font-weight: bold;
        text-align: center;
        margin-bottom: 30px;
        color: #2c3e50;
        border-bottom: 2px solid #2c3e50;
        padding-bottom: 10px;
    }

    .header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: 20px;
    }

    .logo-left, .logo-right {
        width: 80px;
        height: 80px;
        border-radius: 50%;

      
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 8px;
        text-align: center;
        flex-direction: column;
    }

    .title-section {
        flex-grow: 1;
        text-align: center;
        padding: 0 20px;
    }

    .main-title {
        font-size: 16px;
        font-weight: bold;
        margin-bottom: 5px;
    }

    .subtitle {
        font-size: 12px;
        margin-bottom: 10px;
    }

    .version {
        font-size: 14px;
        font-weight: bold;
    }

    .header-info {
        display: flex;
        justify-content: space-between;
        margin-bottom: 20px;
        font-weight: bold;
    }

    .header-note {
        text-align: right;
        font-style: italic;
        margin-bottom: 20px;
        color: #666;
    }
.production-info {
    margin-bottom: 15px;
    padding: 0;
    text-align: left;
    max-width: 100%;
    width: 100%;
}
.left-column, .right-column {
    width: 100%;
}

.left-column > div:first-child {
    font-weight: bold;
    margin-bottom: 8px;
    color: #333;
    font-size: 12px;
    text-align: left;
}

.info-row {
    margin-bottom: 4px;
    display: flex;
    align-items: baseline;
}

.info-label {
    font-weight: bold;
    margin-right: 8px;
    width: 80px;
    font-size: 10px;
    color: #333;
    flex-shrink: 0;
}
.production-info .left-column {
    max-width: 100%;
}
.info-value-no-underline {
    border-bottom: none;
    padding: 1px 3px;
    font-size: 10px;
    flex-grow: 1;
    min-height: 14px;
    font-weight: bold;
}

/* Mobile nav icons - match desktop colors */
.mobile-nav-item[data-page="vas-b1-F1-MC.html"] i {
  color: #e74c3c !important; /* Red for Daily Mortality */
}

.mobile-nav-item[data-page="vas-b1-VF.html"] i {
  color: #e67e22 !important; /* Orange for Visitors */
}

.mobile-nav-item[data-page="../floors/vbarn-1-1.html"] i {
  color: #2ecc71 !important; /* Green for Mortality Records */
}

.mobile-nav-item[data-page="vas-b1-FL.html"] i {
  color: #3498db !important; /* Blue for Flock */
}

.mobile-nav-item[data-page="vas-b1-SF.html"] i {
  color: #1a365d !important; /* Navy for Shipping */
}

/* Show right column for chick quality assessment */
.right-column {
    display: block;
}
    .section {
        margin-bottom: 25px;
        border: 1px solid #666;
        background-color: white;
    }

    .section-header {
      background-color: #1a73e8;
color: white;
        padding: 8px;
        font-weight: bold;
        font-size: 12px;
    }

    .section-content {
        padding: 10px;
    }

    table {
        width: 100%;
        border-collapse: collapse;
        margin-bottom: 15px;
    }

    th, td {
        border: 1px solid #666;
        padding: 6px;
        text-align: left;
        vertical-align: top;
    }

    th {
        background-color: #e9ecef;
        font-weight: bold;
        font-size: 10px;
    }



    .checkbox {
        width: 15px;
        height: 15px;
        border: 1px solid #666;
        display: inline-block;
        margin-right: 5px;
        position: relative;
    }

    .checkbox.checked::after {
        content: "✓";
        position: absolute;
        top: -3px;
        left: 2px;
        font-size: 12px;
        color: #333;
    }

    .note {
        font-style: italic;
        font-size: 10px;
        margin: 10px 0;
    }

    .handwriting {
        font-family: cursive;
        color: #0066cc;
    }

    .form-row {
        margin-bottom: 8px;
    }

    .form-row label {
        display: inline-block;
        width: 200px;
        font-weight: bold;
    }

    .input-field {
        border-bottom: 1px solid #666;
        display: inline-block;
        min-width: 150px;
        padding: 2px;
    }

   .signature-section {
        display: flex;
        justify-content: space-between;
        margin-top: 20px;
        padding-top: 15px;
    }
    .highlighted {
        background-color: #90EE90;
    }

    .crossed-out {
        text-decoration: line-through;
    }

    .task-description {
        width: 50%;
        
    }

    .date-column {
        width: 15%;
        text-align: center;
    }

    .product-column {
        width: 35%;
    }

    .signature-area {
        margin-top: 30px;
        text-align: center;
    }
/* Form input styles - STANDARDIZED */
    input[type="text"], input[type="date"], input[type="number"], textarea, select {
        border: 1px solid #666 !important;
        padding: 4px !important;
        font-size: 10px !important;
        font-family: Arial, sans-serif !important;
        background-color: white !important;
        width: 100% !important;
        box-sizing: border-box !important;
        min-height: 20px !important;
    }

    input[type="checkbox"] {
        width: 15px;
        height: 15px;
        margin: 2px;
    }

    .form-input {
        min-width: 80px;
        display: inline-block;
    }

    .small-input {
        width: 60px;
    }

    .medium-input {
        width: 120px;
    }

    .large-input {
        width: 200px;
    }

    .full-width {
        width: 100%;
    }

    textarea {
        height: 40px;
        resize: vertical;
    }

    .checkbox-container {
        display: inline-flex;
        align-items: center;
        margin-right: 15px;
        margin-bottom: 5px;
    }

    .checkbox-container label {
        margin-left: 5px;
        font-size: 10px;
    }

    .radio-group {
        display: flex;
        gap: 15px;
        flex-wrap: wrap;
    }

    .radio-option {
        display: flex;
        align-items: center;
        gap: 5px;
    }

    input[type="radio"] {
        width: 15px;
        height: 15px;
    }

  .table-input {
    border: none !important;
    background: transparent !important;
    padding: 2px !important;
    font-size: 10px !important;
    min-height: 18px !important;
    width: 100% !important;
    box-sizing: border-box !important;
}

.table-input:focus {
    background-color: #f0f8ff !important;
    border: 1px solid #3498db !important;
}

    .signature-input {
        border-bottom: 1px solid #666;
        border-top: none;
        border-left: none;
        border-right: none;
        background: transparent;
        min-width: 150px;
        padding: 2px;
    }

   

@media screen and (max-width: 768px) {
    /* Hide desktop navigation */
    .nav-links {
        display: none !important;
    }
    
    /* Show mobile navigation */
    .mobile-nav {
        display: block !important;
    }
    
    /* Clean mobile layout */
    .left-sidebar {
        width: 50px !important;
        padding: 10px 5px !important;
        top: 165px !important;
        height: calc(100vh - 165px) !important;
    }
    
    /* Hide sidebar text, keep icons only */
    .sidebar-button span:not(.sidebar-icon) {
        display: none !important;
    }

    
    
    .sidebar-button {
        padding: 8px 5px !important;
        margin-bottom: 5px !important;
        font-size: 20px !important;
        min-height: 40px !important;
        justify-content: center !important;
    }
    
    .sidebar-toggle {
        left: 50px !important;
        top: 175px !important;
        width: 35px !important;
        height: 45px !important;
    }
    
    .sidebar-collapsed .sidebar-toggle {
        left: 0 !important;
    }
    
    /* Mobile body layout */
 body {
    margin-top: 83px !important;
    padding: 0 !important;
    font-size: 12px !important;
    }
 .sidebar-collapsed body {
    margin-left: 10px !important;
}
   /* Proper mobile content scaling */
    .main-content {
     transform: scale(1.0) !important;
        max-width: 100% !important;
        width: 100% !important;
        padding: 10px !important;
        margin: 0 !important;
    }
 .sidebar-collapsed .main-content {
    transform: scale(0.5) !important;
    margin-left: -10px !important;
}
    /* Mobile page structure */
.page {
    width: 100% !important;
    margin: 0 0 25px 0 !important;
    padding: 15px !important;
    box-sizing: border-box !important;
    }
    
    /* Mobile sections */
    .section {
        margin-bottom: 20px !important;
        width: 100% !important;
    }
    
    .section-header {
        font-size: 14px !important;
        padding: 12px !important;
        line-height: 1.3 !important;
    }
    
    .section-content {
        padding: 15px !important;
    }
    
  @media screen and (max-width: 768px) {
    /* Hide desktop navigation */
    .nav-links {
        display: none !important;
    }
    
    /* Show mobile navigation */
    .mobile-nav {
        display: block !important;
    }
    
    /* Clean mobile layout */
    .left-sidebar {
        width: 50px !important;
        padding: 10px 5px !important;
        top: 165px !important;
        height: calc(100vh - 165px) !important;
    }
    
    /* Hide sidebar text, keep icons only */
    .sidebar-button span:not(.sidebar-icon) {
        display: none !important;
    }
    
    .sidebar-button {
        padding: 8px 5px !important;
        margin-bottom: 5px !important;
        font-size: 20px !important;
        min-height: 40px !important;
        justify-content: center !important;
    }
    
    .sidebar-toggle {
        left: 50px !important;
        top: 175px !important;
        width: 35px !important;
        height: 45px !important;
    }
    
    .sidebar-collapsed .sidebar-toggle {
        left: 0 !important;
    }
    
    /* Mobile body layout */
    body {
        margin-left: 60px !important;
        margin-top: 180px !important;
        padding: 10px !important;
        font-size: 12px !important;
    }
    
    .sidebar-collapsed body {
        margin-left: 15px !important;
    }
    
    /* Proper mobile content scaling */
    .main-content {
        width: 100% !important;
        max-width: none !important;
        transform: scale(1.0) !important;
        transform-origin: top left !important;
        padding: 0 !important;
    }
    
    .sidebar-collapsed .main-content {
        transform: scale(1.1) !important;
    }
    
    /* Mobile page structure */
    .page {
        width: 100% !important;
        margin-bottom: 25px !important;
        padding: 15px !important;
        box-sizing: border-box !important;
    }
    
    /* Mobile sections */
    .section {
        margin-bottom: 25px !important;
        width: 100% !important;
        border: 2px solid #666 !important;
        border-radius: 8px !important;
        overflow: hidden !important;
    }
    
    .section-header {
        font-size: 15px !important;
        padding: 15px 12px !important;
        line-height: 1.4 !important;
        font-weight: bold !important;
        text-align: left !important;
        word-wrap: break-word !important;
    }
    
    .section-content {
        padding: 18px 15px !important;
    }
    
    /* Mobile note sections */
    .note {
        font-size: 12px !important;
        line-height: 1.4 !important;
        margin: 15px 0 !important;
        padding: 8px !important;
        background: #f9f9f9 !important;
        border-radius: 4px !important;
    }
    
    /* Mobile form rows */
    .form-row {
        margin-bottom: 15px !important;
        display: flex !important;
        flex-direction: column !important;
        gap: 8px !important;
    }
    
    .form-row label {
        font-size: 14px !important;
        font-weight: bold !important;
        margin-bottom: 4px !important;
    }
    
    /* Better mobile tables */
    .section table {
        width: 100% !important;
        font-size: 12px !important;
        table-layout: fixed !important;
        border-collapse: collapse !important;
    }
    
th, td {
    padding: 8px 6px !important;
    font-size: 12px !important;
    line-height: 1.4 !important;
    word-wrap: normal !important;
    vertical-align: top !important;
    border: 1px solid #666 !important;
    overflow-wrap: normal !important;
    hyphens: none !important;
    white-space: normal !important;
}
    
    /* Mobile table header improvements */
    th {
        font-size: 11px !important;
        font-weight: bold !important;
        text-align: center !important;
        padding: 10px 4px !important;
        line-height: 1.2 !important;
    }
    
/* Specific column width fixes for mobile - make content columns much wider */
.section table th:first-child,
.section table td:first-child {
    width: 45% !important;
}

.section table th:nth-child(2),
.section table td:nth-child(2) {
    width: 35% !important;
}

.section table th:nth-child(3),
.section table td:nth-child(3) {
    width: 25% !important;
}

.section table th:nth-child(4),
.section table td:nth-child(4) {
    width: 20% !important;
}

.section table th:nth-child(5),
.section table td:nth-child(5) {
    width: 15% !important;
}
    
.section:has(.section-header:contains("Medications")) table th:last-child,
.section:has(.section-header:contains("Medications")) table td:last-child {
    width: 8px !important;
    min-width: 8px !important;
    max-width: 8px !important;
    padding: 0px !important;
}
 
/* Make delete buttons smaller on mobile */
button[onclick*="delete"] {
    min-width: 18px !important;
    min-height: 18px !important;
    width: 18px !important;
    height: 18px !important;
    font-size: 10px !important;
    padding: 0 !important;
}

    
    /* Mobile textarea improvements */
    textarea {
        min-height: 50px !important;
        resize: vertical !important;
        line-height: 1.4 !important;
    }
    
    .table-input textarea {
        min-height: 40px !important;
        font-size: 12px !important;
    }
    
    /* Mobile production info */
    .production-info {
        flex-direction: column !important;
        gap: 15px !important;
    }
    
    .info-row {
        margin-bottom: 10px !important;
    }
    
    .info-label {
        font-size: 12px !important;
        margin-bottom: 4px !important;
        display: block !important;
    }
    
    .info-value {
        font-size: 12px !important;
        min-height: 28px !important;
        padding: 4px !important;
    }
    
    /* Mobile headers */
    .page-title {
        font-size: 18px !important;
        margin-bottom: 20px !important;
    }
    
    .main-title {
        font-size: 16px !important;
    }
    
    .subtitle {
        font-size: 12px !important;
    }
    
    /* Mobile checkboxes */
    input[type="checkbox"] {
        width: 18px !important;
        height: 18px !important;
        margin: 4px !important;
        cursor: pointer !important;
    }
    
    .checkbox-container {
        margin-right: 15px !important;
        margin-bottom: 10px !important;
        display: flex !important;
        align-items: center !important;
        gap: 6px !important;
    }
    
    .checkbox-container label {
        font-size: 13px !important;
        margin-left: 0 !important;
        cursor: pointer !important;
        line-height: 1.3 !important;
    }
    
    /* Mobile radio buttons */
    input[type="radio"] {
        width: 18px !important;
        height: 18px !important;
        margin: 4px !important;
    }
    
    /* Mobile date inputs */
    input[type="date"] {
        min-height: 40px !important;
        font-size: 14px !important;
        padding: 8px !important;
    }
    
    .table-input[type="date"] {
        min-height: 36px !important;
        font-size: 13px !important;
        padding: 6px !important;
    }
    
    /* Mobile signature section */
    .signature-section {
        flex-direction: column !important;
        gap: 15px !important;
    }
    
.section table th:last-child,
.section table td:last-child {
    width: 2px !important;
    min-width: 2px !important;
    max-width: 2px !important;
    text-align: center !important;
    padding: 0px !important;
    font-size: 6px !important;
    overflow: hidden !important;
}
button[onclick*="delete"] {
    width: 2px !important;
    height: 8px !important;
    min-width: 2px !important;
    min-height: 8px !important;
    font-size: 4px !important;
    padding: 0 !important;
    line-height: 1 !important;
    border-radius: 0px !important;
    overflow: hidden !important;
}
    
    /* Mobile button improvements */
    button {
        font-size: 15px !important;
        padding: 12px 18px !important;
        min-height: 44px !important;
        border-radius: 6px !important;
        border: none !important;
        cursor: pointer !important;
        font-weight: bold !important;
        margin: 8px 4px !important;
    }
    
    /* Delete button specific styling */
    button[onclick*="delete"] {
        background-color: #dc3545 !important;
        color: white !important;
        min-width: 28px !important;
        min-height: 28px !important;
        padding: 2px !important;
        font-size: 14px !important;
        border-radius: 3px !important;
        margin: 0 !important;
        line-height: 1 !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
    }
    
    /* Add entry button styling */
    button[id*="add"] {
        background-color: #007bff !important;
        color: white !important;
        min-height: 50px !important;
        font-size: 16px !important;
        margin: 15px auto !important;
        display: block !important;
        width: auto !important;
        padding: 12px 24px !important;
    }
}
    /* Mobile Navigation Styles */
.mobile-nav {
    position: fixed;
    top: 105px;
    left: 0;
    right: 0;
    background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
    border-bottom: 3px solid #dee2e6;
    padding: 15px;
    z-index: 999;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

.mobile-nav-content {
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.mobile-nav-title {
    font-size: 12px;
    font-weight: bold;
    color: #6c757d;
    text-transform: uppercase;
    letter-spacing: 1px;
    border-bottom: 2px solid #dee2e6;
    padding-bottom: 5px;
}

.mobile-nav-buttons {
    display: none; /* Hidden on desktop by default */
    gap: 10px;
}

.mobile-nav-btn {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 8px 12px;
    background: linear-gradient(135deg, white 0%, #f8f9fa 100%);
    border: 2px solid #dee2e6;
    border-radius: 8px;
    color: #2c3e50;
    font-size: 12px;
    font-weight: 600;
    cursor: pointer;
    box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    transition: all 0.3s ease;
}

.mobile-nav-btn:hover {
    background: linear-gradient(135deg, #e9ecef 0%, #dee2e6 100%);
    color: #c0392b;
    transform: translateY(-1px);
    box-shadow: 0 3px 6px rgba(0,0,0,0.1);
    border-color: #c0392b;
}

/* Mobile table container to prevent horizontal overflow */
.section-content {
    overflow-x: auto !important;
    -webkit-overflow-scrolling: touch !important;
}

/* Specific column width adjustments for problematic tables */
.section table th:first-child,
.section table td:first-child {
    min-width: 80px !important;
    width: 35% !important;
}

.section table th:nth-child(2),
.section table td:nth-child(2) {
    min-width: 60px !important;
    width: 20% !important;
}

.section table th:last-child,
.section table td:last-child {
    min-width: 60px !important;
    width: 25% !important;
}

/* Fix for wide tables like Feed Transfer Record */
.section table th,
.section table td {
    max-width: 0 !important;
}


@media screen and (max-width: 1200px) {
    .nav-links {
        display: none !important;
    }
    
    .mobile-nav-buttons {
        display: flex !important;
    }
}






    /* Keep left sidebar but make it mobile-friendly */
    .left-sidebar {
        width: 50px !important;
        padding: 10px 5px !important;
        top: 105px !important;
        height: calc(100vh - 105px) !important;
    }
    
    /* Hide text in sidebar buttons, show only icons */
    .sidebar-button span:not(.sidebar-icon) {
        display: none !important;
    }
    
    .sidebar-button {
        padding: 8px 5px !important;
        margin-bottom: 5px !important;
        font-size: 16px !important;
        min-height: 40px !important;
        justify-content: center !important;
    }
    
    .sidebar-title {
        display: none !important;
    }
    
    body {
        margin-left: 60px !important;
        margin-top: 120px !important;
        padding: 10px !important;
        font-size: 10px;
        max-width: calc(100% - 60px) !important;
    }
    
    /* Scale down all form content */
    .page {
        transform: scale(0.85);
        transform-origin: top left;
        width: 117.65%; /* Compensate for 0.85 scale (1/0.85) */
        margin-bottom: 15px;
    }
    
    /* Header adjustments */
    .top-header {
        padding: 15px 10px;
    }
    
    .logo-img {
        height: 50px;
    }
    
    .mobile-nav-btn {
        padding: 6px 10px;
        font-size: 11px;
    }
    
    /* Form content scaling */
    .title-section {
        padding: 0 10px;
    }
    
    .main-title {
        font-size: 14px;
    }
    
    .subtitle {
        font-size: 10px;
    }
    
    .production-info {
        flex-direction: column;
        gap: 15px;
    }
    
    .left-column, .right-column {
        width: 100%;
    }
    
     table {
        width: 100% !important;
        font-size: 11px !important;
        table-layout: auto !important;
    }
    
    th, td {
        padding: 8px 4px !important;
        font-size: 11px !important;
        word-wrap: break-word !important;
        vertical-align: top !important;
    }
    /* Input scaling */
    input, textarea, select {
        font-size: 8px !important;
        padding: 2px !important;
        min-height: 20px;
    }
    
    .table-input {
        font-size: 8px !important;
        padding: 1px !important;
        min-height: 18px;
    }
    
    textarea {
        min-height: 30px !important;
        max-height: 60px !important;
    }
    
    /* Section headers */
    .section-header {
        font-size: 10px !important;
        padding: 6px !important;
    }
    
    .page-title {
        font-size: 16px !important;
        margin-bottom: 20px !important;
    }
    
    /* Checkbox adjustments */
    input[type="checkbox"] {
        width: 12px !important;
        height: 12px !important;
    }
    
    .checkbox-container {
        margin-right: 8px;
        margin-bottom: 3px;
    }
    
    .checkbox-container label {
        font-size: 8px !important;
    }
    
    /* Button adjustments */
    button {
        font-size: 10px !important;
        padding: 4px 8px !important;
    }
    
    /* Logo adjustments */
    .logo-left, .logo-right {
        width: 50px;
        height: 50px;
        font-size: 6px;
    }
    
 /* Info rows */
.info-row {
    margin-bottom: 5px;
    display: flex;
    flex-direction: row;
    align-items: baseline;
    text-align: left;
}

.info-label {
    font-size: 9px;
    min-width: 80px;
    margin-right: 8px;
    margin-bottom: 0;
    flex-shrink: 0;
    text-align: left;
}

.info-value {
    font-size: 9px;
    flex-grow: 1;
    text-align: left;
}
    
    /* Signature section */
    .signature-section {
        flex-direction: column;
        gap: 10px;
    }
    
    /* Special table column handling for mobile */
    .task-description {
        width: 40% !important;
        font-size: 7px !important;
    }
    
    .date-column {
        width: 20% !important;
    }
    
    .product-column {
        width: 40% !important;
    }
    
   .section-content > div[style*="grid"] {
        display: grid !important;
        grid-template-columns: 1fr !important;
        gap: 10px !important;
    }
    
    /* Deviation chart specific */
    .deviation-types-checkboxes {
        display: grid !important;
        grid-template-columns: 1fr 1fr !important;
        gap: 5px !important;
    }
}

    @media screen and (max-width: 768px) {
    .left-sidebar {
        display: none !important;
    }
    
    .sidebar-toggle {
        display: none !important;
    }}

@media screen and (max-width: 480px) {
    .left-sidebar {
        width: 50px !important;
        padding: 8px 3px !important;
    }
    
    body {
        margin-left: 60px !important; /* Account for 50px sidebar + 10px buffer */
        padding: 10px !important;
        width: calc(100vw - 60px) !important;
    }
    
    .main-content {
        max-width: 6in !important; /* Even smaller for tiny screens */
        transform: scale(1.25) !important; /* Smaller scale to prevent cutoff */
    }
    
    .logo-left, .logo-right {
        width: 40px;
        height: 40px;
        font-size: 5px;
    }
    
    th, td {
        padding: 2px;
        font-size: 8px;
    }
    
    input, textarea, select {
        font-size: 8px !important;
        min-height: 18px !important;
    }
    
    .table-input {
        font-size: 8px !important;
        min-height: 16px !important;
    }
    
    .logo-img {
        height: 35px;
    }
}
@media screen and (max-width: 360px) {
    body {
        padding: 2px !important;
    }
    
    .main-content {
        transform: scale(1.05) !important;
        max-width: 99.5% !important;
        width: 99.5% !important;
    }
    
    th, td {
        padding: 2px !important;
        font-size: 8px !important;
    }
    
    input, textarea, select {
        font-size: 8px !important;
        min-height: 18px !important;
    }
    
    .table-input {
        font-size: 8px !important;
        min-height: 16px !important;
    }
}
/* Center all page content consistently */
.page {
    display: flex !important;
    flex-direction: column !important;
    align-items: center !important;
    width: 100% !important;
    margin: 0 auto !important;
    padding: 0 !important;
}

.page > * {
    width: 100% !important;
    max-width: 100% !important;
    margin: 0 auto !important;
}

/* Ensure all sections are centered regardless of parent */
.section {
    width: 100% !important;
    max-width: 100% !important;
    margin: 0 auto 25px auto !important;
    box-sizing: border-box !important;
}

.page-title {
    width: 100% !important;
    text-align: center !important;
    margin: 0 auto 30px auto !important;
}

/* Make sure all content inside main-content is centered */
.main-content > * {
    width: 100% !important;
    margin-left: auto !important;
    margin-right: auto !important;
}

/* Specific centering for production info and title sections */
.title-section,
.production-info {
    width: 100% !important;
    margin: 0 auto !important;
    display: block !important;
}



</style>
<style>
/* Make all sections have consistent width across all screen sizes */
.production-info,
.section,
.page {
   width: 100% !important;
   max-width: 100% !important;
}

table {
   width: 100% !important;
   max-width: 100% !important;
}

.left-column, 
.right-column {
   width: 100% !important;
}

/* Ensure chick quality table matches other sections */
.right-column table {
   width: 100% !important;
   table-layout: fixed !important;
}

/* iPhone specific fixes */
@media screen and (max-width: 768px) and (-webkit-min-device-pixel-ratio: 1) {
   .production-info,
   .section,
   .page {
       width: 100vw !important;
       max-width: 100vw !important;
       transform: none !important;
       -webkit-transform: none !important;
   }
   
   table {
       width: 100% !important;
       max-width: 100% !important;
       -webkit-transform: none !important;
   }
   
   .main-content {
       width: 100vw !important;
       max-width: 100vw !important;
       transform: scale(1) !important;
       -webkit-transform: scale(1) !important;
       transform-origin: top left !important;
       -webkit-transform-origin: top left !important;
   }
}

/* Safari/iPhone specific viewport fixes */
@supports (-webkit-appearance: none) {
   @media screen and (max-width: 768px) {
       .production-info,
       .section,
       .page {
           width: 100vw !important;
           max-width: 100vw !important;
           box-sizing: border-box !important;
       }
       
       .main-content {
           width: 100vw !important;
           max-width: 100vw !important;
           transform: scale(1) !important;
           -webkit-transform: scale(1) !important;
       }
       
       body {
           width: 100vw !important;
           overflow-x: hidden !important;
       }
   }
}

/* Mobile screens - general */
@media screen and (max-width: 768px) {
   .production-info,
   .section,
   .page {
       width: 100% !important;
       max-width: 100% !important;
       transform: none !important;
   }
   
   .main-content {
       width: 100% !important;
       max-width: 100% !important;
       transform: scale(1) !important;
   }
}
</style>
<style>
/* Consistent width for all sections - desktop and mobile */
.production-info,
.section,
.page {
   width: 100% !important;
   max-width: 100% !important;
}

table {
   width: 100% !important;
   max-width: 100% !important;
}

.left-column, 
.right-column {
   width: 100% !important;
}

.right-column table {
   width: 100% !important;
   table-layout: fixed !important;
}

/* Mobile sidebar collapsed behavior - page grows same way as desktop */
@media screen and (max-width: 768px) {
   .sidebar-collapsed .main-content {
       width: calc(100% + 60px) !important;
       max-width: calc(100% + 60px) !important;
       transform: scale(1.1) !important;
       -webkit-transform: scale(1.1) !important;
       margin-left: 0 !important;
   }
   
   .sidebar-collapsed .production-info,
   .sidebar-collapsed .section,
   .sidebar-collapsed .page {
       width: 100% !important;
       max-width: 100% !important;
   }
   
   .sidebar-collapsed table {
       width: 100% !important;
       max-width: 100% !important;
   }
}

/* iPhone specific collapsed behavior */
@supports (-webkit-appearance: none) {
   @media screen and (max-width: 768px) {
       .sidebar-collapsed .main-content {
           width: calc(100% + 60px) !important;
           max-width: calc(100% + 60px) !important;
           transform: scale(1.1) !important;
           -webkit-transform: scale(1.1) !important;
       }
   }
}

/* Small mobile screens collapsed */
@media screen and (max-width: 480px) {
   .sidebar-collapsed .main-content {
       width: calc(100% + 50px) !important;
       max-width: calc(100% + 50px) !important;
       transform: scale(1.08) !important;
   }
}
</style>
<style>
/* Consistent width for all sections */
.production-info,
.section,
.page {
    width: 100% !important;
    max-width: 100% !important;
}

table {
    width: 100% !important;
    max-width: 100% !important;
}

.left-column, 
.right-column {
    width: 100% !important;
}

.right-column table {
    width: 100% !important;
    table-layout: fixed !important;
}

/* Fix mobile sidebar collapsed - make it GROW not shrink */
@media screen and (max-width: 768px) {
    .sidebar-collapsed .main-content {
        transform: scale(1.2) !important;
        -webkit-transform: scale(1.2) !important;
        width: 120% !important;
        max-width: 120% !important;
        margin-left: 0 !important;
    }
}

/* iPhone specific fix */
@supports (-webkit-appearance: none) {
    @media screen and (max-width: 768px) {
        .sidebar-collapsed .main-content {
            transform: scale(1.2) !important;
            -webkit-transform: scale(1.2) !important;
            width: 120% !important;
            max-width: 120% !important;
        }
    }
}

/* Small mobile screens */
@media screen and (max-width: 480px) {
    .sidebar-collapsed .main-content {
        transform: scale(1.15) !important;
        width: 115% !important;
        max-width: 115% !important;
    }
}
</style>
<style>
/* OVERRIDE: Fix Mobile Sidebar Collapse Expansion - CONTROLLED EXPANSION ONLY */
@media screen and (max-width: 768px) {
    /* When sidebar is collapsed on mobile - EXPAND the available space like desktop */

    
    /* Body uses the gained space from hidden sidebar */
    .sidebar-collapsed body {
        margin-left: 10px !important; /* Use some of the gained 50px space */
        overflow-x: hidden !important;
    }
    
    /* Sections expand to use the extra width naturally */
    .sidebar-collapsed .production-info,
    .sidebar-collapsed .section,
    .sidebar-collapsed .page {
        width: 100% !important;
        max-width: 100% !important;
        overflow: visible !important;
        box-sizing: border-box !important;
    }
    
    /* Tables expand to use extra width naturally */
    .sidebar-collapsed table {
        width: 100% !important;
        max-width: 100% !important;
        table-layout: auto !important;
        overflow: visible !important;
        box-sizing: border-box !important;
    }
    

}

/* Small mobile screens - controlled expansion */
@media screen and (max-width: 480px) {
    .sidebar-collapsed .main-content {
        width: calc(200% + 45px) !important; /* Gain the sidebar space */
        max-width: calc(200% + 45px) !important;
        transform: scale(0.48) !important; /* Keep proportional scale */
        -webkit-transform: scale(0.48) !important;
        margin-left: 0px !important;
    }
    
    .sidebar-collapsed body {
        margin-left: 8px !important;
        overflow-x: hidden !important;
    }
}

/* Very small screens - controlled expansion */
@media screen and (max-width: 360px) {
    .sidebar-collapsed .main-content {
        width: calc(200% + 40px) !important; /* Gain the sidebar space */
        max-width: calc(200% + 40px) !important;
        transform: scale(0.45) !important; /* Keep proportional scale */
        -webkit-transform: scale(0.45) !important;
        margin-left: 0px !important;
    }
    
    .sidebar-collapsed body {
        margin-left: 5px !important;
    }
}

/* Force controlled expansion - no uncontrolled scaling */
@media screen and (max-width: 768px) {
    body.sidebar-collapsed .main-content {
        width: calc(200% + 50px) !important;
        max-width: calc(200% + 50px) !important;
        transform: scale(0.5) !important; /* SAME scale as normal mobile */
        -webkit-transform: scale(0.5) !important;
        overflow: visible !important;
        box-sizing: border-box !important;
    }
    

}
</style>
<style>
    /* Add this CSS to your stylesheet */
.section-navigator {
  position: fixed;
  right: 20px;
  top: 50%;
  transform: translateY(-50%);
  background-color: #ffffff;
  border-radius: 12px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.1);
  padding: 12px;
  z-index: 1000;
  width: 150px;
  border: 1px solid #e9ecef;
  transition: transform 0.3s ease, opacity 0.3s ease;
}

.section-navigator.collapsed {
  transform: translateY(-50%) translateX(140px);
}

.section-nav-header {
  font-weight: 600;
  font-size: 14px;
  margin-bottom: 10px;
  color: #1a73e8;
  padding-bottom: 6px;
  border-bottom: 1px solid #e9ecef;
}

.section-nav-items {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.section-nav-item {
  font-size: 13px;
  color: #495057;
  text-decoration: none;
  padding: 5px 8px;
  border-radius: 6px;
  transition: all 0.2s ease;
}

.section-nav-item:hover {
  background-color: #f8f9fa;
  color: #1a73e8;
}

.section-nav-item.active {
  background-color: #e8f0fe;
  color: #1a73e8;
  font-weight: 500;
}

.section-nav-toggle {
  position: absolute;
  left: -12px;
  top: 10px;
  width: 24px;
  height: 24px;
  background-color: #ffffff;
  border: 1px solid #e9ecef;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
  color: #6c757d;
  padding: 0;
  transition: all 0.2s ease;
}
/* Add this to your existing section-navigator CSS */
@media screen and (max-width: 768px) {
  .section-navigator {
    display: none;
  }
}
.section-nav-toggle:hover {
  color: #1a73e8;
  box-shadow: 0 3px 6px rgba(0,0,0,0.15);
}

/* Add these ID attributes to your section elements */
/* Example: <div class="section" id="water-section"> */
</style>
</body> 
<script>
document.addEventListener('DOMContentLoaded', function() {
  // Add IDs to all section elements
  const sections = document.querySelectorAll('.section');
  const sectionIds = [
    'water-section', 
    'feed-section',
    'feed-transfer',
    'barn-cleaning',
    'facilities-preparation',
    'pest-control',
    'medications',
    'deviation-chart',
    'daily-checks'
  ];
  
  // Add ID to production info section
  const productionInfo = document.querySelector('.production-info');
  if (productionInfo) {
    productionInfo.id = 'production-info';
  }
  
  // Add ID to chick quality assessment section
  const chickQuality = document.querySelector('.right-column');
  if (chickQuality) {
    chickQuality.id = 'chick-quality';
  }
  
  // Add IDs to sections based on their order
  sections.forEach((section, index) => {
    if (index < sectionIds.length) {
      section.id = sectionIds[index];
    }
  });
  
  // Rest of your code...
    
    // Handle navigation item clicks
    const navItems = document.querySelectorAll('.section-nav-item');
    navItems.forEach(item => {
      item.addEventListener('click', function(e) {
        e.preventDefault();
        
        // Remove active class from all items
        navItems.forEach(navItem => navItem.classList.remove('active'));
        
        // Add active class to clicked item
        this.classList.add('active');
        
        // Scroll to the section
        const targetId = this.getAttribute('href').substring(1);
        const targetSection = document.getElementById(targetId);
        
        if (targetSection) {
          window.scrollTo({
            top: targetSection.offsetTop - 20,
            behavior: 'smooth'
          });
        }
      });
    });
    
    // Handle toggle button click
    const toggleButton = document.querySelector('.section-nav-toggle');
    const navigator = document.querySelector('.section-navigator');
    
    toggleButton.addEventListener('click', function() {
      navigator.classList.toggle('collapsed');
    });
    
    // Update active section based on scroll position
    window.addEventListener('scroll', function() {
      const scrollPosition = window.scrollY + 100;
      
      // Find the current section in view
    const chickQuality = document.querySelector('#chick-quality');
const allSections = [productionInfo, chickQuality, ...sections];
      let currentSection = null;
      
      allSections.forEach(section => {
        if (section && section.offsetTop <= scrollPosition) {
          currentSection = section;
        }
      });
      
      if (currentSection) {
        // Remove active class from all items
        navItems.forEach(navItem => navItem.classList.remove('active'));
        
        // Add active class to current section nav item
        const currentNavItem = document.querySelector(`.section-nav-item[href="#${currentSection.id}"]`);
        if (currentNavItem) {
          currentNavItem.classList.add('active');
        }
      }
    });
  });
  // Function to convert certain input fields to textareas
function convertInputsToTextareas() {
  // Target specific fields that should be expandable
  const fieldsToConvert = [
    // Barn Cleaning section
    'input[placeholder="Condition and type"]',
    'td:contains("Inspect inside and outside of feed bin") + td + td input[type="text"]',
    
    // Facilities Preparation section
    'input[placeholder="Status"]',
    'input[placeholder="Test results"]',
    
    // Pest Control section
    'input[placeholder="Product/method"]',
    'input[placeholder="Controls"]',
    
    // All product description fields
    'input[placeholder="Product name"]',
    'input[placeholder="Service/product"]',
    'input[placeholder="Service/procedure"]',
    'input[placeholder="Prevail Disinfectant"]'
  ];
  
  // Convert each matched field
  fieldsToConvert.forEach(selector => {
    const inputs = document.querySelectorAll(selector);
    inputs.forEach(input => {
      // Skip if already converted or if it's not an input
      if (input.tagName.toLowerCase() !== 'input') return;
      
      // Create textarea with same attributes
      const textarea = document.createElement('textarea');
      textarea.className = input.className;
      textarea.placeholder = input.placeholder;
      textarea.value = input.value;
      textarea.style.minHeight = '30px';
      textarea.style.resize = 'vertical';
      
      // Replace input with textarea
      input.parentNode.replaceChild(textarea, input);
    });
  });
}

// Run this function after DOM loads and after form data loads
document.addEventListener('DOMContentLoaded', function() {
  // First load data, then convert inputs
  loadFormData().then(() => {
    setTimeout(convertInputsToTextareas, 500);
  });
});
</script>
</head>
<body>
<!-- Add this HTML right after your opening <body> tag -->
<div class="section-navigator">
  <div class="section-nav-header">Quick Nav</div>
<div class="section-nav-items">
  <a href="#production-info" class="section-nav-item">Production Info</a>
    <a href="#chick-quality" class="section-nav-item">Chick Quality Assessment</a>
  <a href="#water-section" class="section-nav-item">Water</a>
  <a href="#feed-section" class="section-nav-item">Feed</a>
  <a href="#feed-transfer" class="section-nav-item">Feed Transfer</a>
  <a href="#barn-cleaning" class="section-nav-item">Barn Cleaning</a>
  <a href="#facilities-preparation" class="section-nav-item">Facilities Preparation</a>
  <a href="#pest-control" class="section-nav-item">Pest Control</a>
  <a href="#medications" class="section-nav-item">Medications</a>
  <a href="#deviation-chart" class="section-nav-item">Deviation Chart</a>
  <a href="#daily-checks" class="section-nav-item">Daily Checks</a>
</div>
  <button class="section-nav-toggle">
    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <line x1="18" y1="6" x2="6" y2="18"></line>
      <line x1="6" y1="6" x2="18" y2="18"></line>
    </svg>
  </button>
</div>


<!-- Add Font Awesome CSS to your head section -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<!-- Add responsive CSS -->
<style>
/* Responsive navigation styles */
.nav-icon-responsive {
    font-size: clamp(14px, 2.8vw, 42px); /* Even more aggressive scaling */
}

.nav-text-responsive {
    font-size: 11px; /* Changed from clamp(6px, 1vw, 14px) */
    font-weight: 600;
    color: #2c3e50;
    text-align: center;
    line-height: 1.2;
    margin-top: 3px;
    white-space: nowrap;
    display: block; /* Add this */
}
.nav-container-responsive {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    min-width: 70px; /* Changed from clamp values */
    padding: 8px;
    text-align: center;
}
.mobile-nav-icon {
  font-size: 20px;
}

.mobile-nav-text {
    font-size: clamp(5px, 0.8vw, 12px);
    font-weight: 900;
    color: #2c3e50;
    margin-top: 1px;
    white-space: nowrap;
}

.nav-links {
    display: flex;
    align-items: center;
    gap: 4px;
    background: var(--background-secondary);
    border-radius: 32px;
    padding: 8px;  /* Increased from 4px to 8px */
    border: 1px solid var(--border-color);
}

.top-nav {
    display: flex;
    align-items: center;
    justify-content: space-between;
    width: 100%;
    gap: 20px;
}
/* Adjust mobile nav buttons for smaller screens */
.mobile-nav-buttons {
    display: flex;
    gap: clamp(3px, 1vw, 15px);
    align-items: center;
    flex-shrink: 0;
}

/* Remove all borders and hover effects */
.nav-item {
    border: none !important;
    background: transparent !important;
    box-shadow: none !important;
    transition: none !important;
    transform: none !important;
}

.nav-item:hover {
    background: transparent !important;
    color: inherit !important;
    transform: none !important;
    box-shadow: none !important;
    border: none !important;
    border-color: transparent !important;
}

.mobile-nav-btn {
    border: none !important;
    background: transparent !important;
    box-shadow: none !important;
    transition: none !important;
    transform: none !important;
}

.mobile-nav-btn:hover {
    background: transparent !important;
    color: inherit !important;
    transform: none !important;
    box-shadow: none !important;
    border: none !important;
}

/* Specific breakpoints for very small screens */
@media (max-width: 480px) {
    .nav-text-responsive {
        font-size: 6px;
        line-height: 0.9;
    }
    
    .nav-icon-responsive {
        font-size: 14px;
    }
    
    .nav-container-responsive {
        min-width: 35px;
        max-width: 45px;
        padding: 1px;
    }
    
    .nav-links {
        gap: 1px;
        padding: 0 2px;
    }
}

@media (max-width: 360px) {
    .nav-text-responsive {
        font-size: 5px;
        margin-top: 0;
    }
    
    .nav-icon-responsive {
        font-size: 12px;
    }
    
    .nav-container-responsive {
        min-width: 30px;
        max-width: 35px;
        padding: 0;
    }
    
    .nav-links {
        gap: 0;
        padding: 0 1px;
    }
    
    .mobile-nav-text {
        font-size: 5px;
    }
    
    .mobile-nav-icon {
        font-size: 12px;
    }
}

@media (max-width: 320px) {
    .nav-text-responsive {
        font-size: 4px;
        display: none; /* Hide text on very small screens */
    }
    
    .nav-icon-responsive {
        font-size: 11px;
    }
    
    .nav-container-responsive {
        min-width: 25px;
        max-width: 30px;
        padding: 0;
    }
    
    .mobile-nav-text {
        display: none; /* Hide mobile text too */
    }
}

@media screen and (max-width: 768px) {
    /* ... existing mobile rules ... */
    
    /* IMPORTANT: Override desktop sidebar collapse behavior on mobile */
    .sidebar-collapsed .main-content {
        transform: scale(0.5) !important;
        width: 200% !important;
        margin-left: 0 !important;
    }
}
</style>
<style>
/* Make mobile navigation icons much bigger with nice blue styling */
.mobile-nav-icon {
    font-size: 24px !important; /* 15% smaller (28px * 0.85 = 23.8px, rounded to 24px) */
    color: white !important; /* White icons on blue background */
}

.mobile-nav-btn {
    padding: 10px 13px !important; /* 15% smaller padding */
    min-width: 51px !important; /* 15% smaller (60px * 0.85 = 51px) */
    min-height: 51px !important; /* 15% smaller (60px * 0.85 = 51px) */
    background: linear-gradient(135deg, #3498db 0%, #2980b9 100%) !important; /* Nice blue gradient */
    border: 2px solid #2980b9 !important; /* Blue border */
    border-radius: 10px !important; /* Slightly smaller rounded corners */
    box-shadow: 0 4px 8px rgba(52, 152, 219, 0.3) !important; /* Blue shadow */
    transition: all 0.3s ease !important;
}

.mobile-nav-btn:hover {
    background: linear-gradient(135deg, #2980b9 0%, #1f639a 100%) !important; /* Darker blue on hover */
    transform: translateY(-2px) !important; /* Lift effect */
    box-shadow: 0 6px 12px rgba(52, 152, 219, 0.4) !important; /* Stronger shadow on hover */
}

.mobile-nav-btn:active {
    transform: translateY(0px) !important; /* Press effect */
    box-shadow: 0 2px 4px rgba(52, 152, 219, 0.2) !important;
}

.mobile-nav-text {
    font-size: 12px !important; /* Slightly bigger text too */
    margin-top: 4px !important;
    color: black !important; /* Black text for better visibility */
    font-weight: bold !important;
    text-shadow: none !important; /* Remove text shadow since it's now black */
}
/* Bigger on mobile screens but not too big - 20% smaller */
@media screen and (max-width: 768px) {
    .mobile-nav-icon {
        font-size: 19px !important; /* 20% smaller (24px * 0.8 = 19.2px, rounded to 19px) */
    }
    
    .mobile-nav-btn {
        padding: 8px 10px !important; /* 20% smaller padding */
        min-width: 41px !important; /* 20% smaller (51px * 0.8 = 40.8px, rounded to 41px) */
        min-height: 41px !important; /* 20% smaller (51px * 0.8 = 40.8px, rounded to 41px) */
    }
    
    .mobile-nav-text {
        font-size: 8px !important; /* 20% smaller (10px * 0.8 = 8px) */
        margin-top: 3px !important; /* Slightly reduced margin */
    }
}

/* Better size for iPhone screens */
@media screen and (max-width: 480px) {
    .mobile-nav-icon {
        font-size: 20px !important; /* Bigger than 16px but smaller than original */
    }
    
    .mobile-nav-btn {
        padding: 8px 10px !important; /* More padding */
        min-width: 42px !important; /* Bigger width */
        min-height: 42px !important; /* Bigger height */
        border-radius: 8px !important; /* Slightly bigger border radius */
    }
    
    .mobile-nav-text {
        font-size: 9px !important; /* Bigger text */
        margin-top: 3px !important; /* More margin */
        font-weight: bold !important;
    }
}

/* Force all tables to use auto layout and preserve desktop proportions */
@media screen and (max-width: 768px) {
    .section table {
        table-layout: auto !important;
        width: 100% !important;
    }
    
    /* Remove all column width overrides - let tables size naturally */
    .section table th,
    .section table td {
        width: auto !important;
        min-width: auto !important;
        max-width: none !important;
    }
    
    /* Only control the delete button column */
    .section table th:last-child,
    .section table td:last-child {
        width: 30px !important;
        min-width: 30px !important;
        max-width: 30px !important;
    }
    
    /* Make delete buttons properly sized */
    button[onclick*="delete"] {
        width: 25px !important;
        height: 25px !important;
        font-size: 12px !important;
    }
}
</style>
<style>
/* Fix left sidebar positioning on mobile to avoid header overlap */
@media screen and (max-width: 768px) {
    .left-sidebar {
        top: 160px !important; /* Increased to match body margin-top + buffer */
        height: calc(100vh - 160px) !important;
        padding-top: 20px !important; /* Extra top padding inside sidebar */
    }
    
    .sidebar-icon {
        font-size: 24px !important;
    }
    
    .sidebar-button {
        padding: 8px 5px !important;
        min-height: 40px !important;
        justify-content: center !important;
        margin-bottom: 8px !important; /* Space between buttons */
    }
    
    .sidebar-button span:not(.sidebar-icon) {
        display: none !important;
    }
}

/* Small mobile screens */
@media screen and (max-width: 480px) {
    .left-sidebar {
        top: 170px !important; /* Even more clearance for small screens */
        height: calc(100vh - 170px) !important;
        padding-top: 15px !important;
    }
    
    .sidebar-icon {
        font-size: 26px !important;
    }
    
    .sidebar-button {
        padding: 6px 3px !important;
        min-height: 38px !important;
        justify-content: center !important;
        margin-bottom: 6px !important;
    }
}
</style>

<style>
/* Reduce padding by 50% on large screens */
body {
  margin-top: 64px; /* Changed from 156px */
    padding-top: 23px !important; /* Reduced from 47px to 23px (-24px, which is about 50% less) */
}

/* Keep mobile screens unchanged */
@media screen and (max-width: 768px) {
    body {
        margin-top: 155px !important; /* Keep mobile the same */
        padding-top: 2px !important; /* Keep mobile the same */
    }
}

/* Keep small mobile screens unchanged */
@media screen and (max-width: 480px) {
    body {
        margin-top: 160px !important; /* Keep small mobile the same */
        padding-top: 0px !important; /* Keep small mobile the same */
    }
}
</style>
<style>
/* Make left sidebar taller to match the reduced form padding */
.left-sidebar {
    top: 85px !important; /* Start even higher to fill gap */
    height: calc(100vh - 85px) !important; /* Make it taller */
    padding-top: 60px !important; /* Keep buttons in same visual position */
}

/* Mobile screens - adjust for mobile header height */
@media screen and (max-width: 768px) {
    .left-sidebar {
        top: 115px !important; /* Keep mobile positioning */
        height: calc(100vh - 115px) !important; /* Taller sidebar */
        padding-top: 60px !important; /* Keep buttons in same place visually */
    }
}

/* Small mobile screens */
@media screen and (max-width: 480px) {
    .left-sidebar {
        top: 120px !important; /* Keep small mobile positioning */
        height: calc(100vh - 120px) !important; /* Taller sidebar */
        padding-top: 65px !important; /* Keep buttons positioned correctly */
    }
}
</style>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flock View - Farm Management</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>

    <!-- Navigation Buttons in Orange Header -->

</div>
    </div>

  <!-- Modern Header -->
<header class="modern-header">
    <div class="header-container">
<!-- Logo Section -->
<div class="logo-section">
    <button class="nav-btn" id="backButton" title="Go Back">
        <i class="fas fa-arrow-left"></i>
    </button>
    <button class="nav-btn" id="mainMenuButton" title="Main Menu">
        <i class="fas fa-home"></i>
    </button>
    <img src="/rosefarmmangement.jpeg" alt="Rose Farm Management" class="main-logo-img">
</div>

        <!-- Navigation -->
        <nav class="nav-container">
            <div class="nav-links">
                <a href="#" class="nav-item active" data-page="vas-b1-F1-MC.html" title="Daily Mortality Floor 1">
                    <i class="fas fa-chart-line nav-icon"></i>
                    <span class="nav-label">Daily Mortality</span>
                </a>
                <a href="#" class="nav-item" data-page="vas-b1-VF.html" title="Visitor Log">
                    <i class="fas fa-users nav-icon"></i>
                    <span class="nav-label">Visitors</span>
                </a>
                <a href="#" class="nav-item" data-page="../floors/vbarn-1-1.html" title="Mortality Card Floor 1">
                    <i class="fas fa-clipboard-list nav-icon"></i>
                    <span class="nav-label">Mortality Records</span>
                </a>
                <a href="#" class="nav-item" data-page="vas-b1-FL.html" title="Flock Log">
                    <i class="fas fa-feather-alt nav-icon"></i>
                    <span class="nav-label">Flock</span>
                </a>
                <a href="#" class="nav-item" data-page="vas-b1-SF.html" title="Shipping Log">
                    <i class="fas fa-shipping-fast nav-icon"></i>
                    <span class="nav-label">Shipping</span>
                </a>
            </div>
        </nav>

        <!-- Action Buttons -->
        <div class="action-buttons">
            <button class="action-btn secondary" id="saveFormButton" title="Save Changes">
                <i class="fas fa-save"></i>
                <span>Save</span>
            </button>
            <button class="action-btn primary" id="printPDFButton" title="Print as PDF">
                <i class="fas fa-file-pdf"></i>
                <span>Print PDF</span>
            </button>
        </div>

        <!-- Mobile Menu Toggle -->
        <button class="mobile-menu-toggle" id="mobileMenuToggle" aria-label="Toggle mobile menu">
            <span></span>
            <span></span>
            <span></span>
        </button>
    </div>

    <!-- Mobile Navigation Menu -->
    <div class="mobile-nav-menu" id="mobileNavMenu">
        <div class="mobile-nav-content">
            <div class="mobile-nav-links">
                <a href="#" class="mobile-nav-item active" data-page="vas-b1-F1-MC.html">
                    <i class="fas fa-chart-line"></i>
                    <span>Daily Mortality</span>
                </a>
                <a href="#" class="mobile-nav-item" data-page="vas-b1-VF.html">
                    <i class="fas fa-users"></i>
                    <span>Visitors</span>
                </a>
                <a href="#" class="mobile-nav-item" data-page="../floors/vbarn-1-1.html">
                    <i class="fas fa-clipboard-list"></i>
                    <span>Mortality Records</span>
                </a>
                <a href="#" class="mobile-nav-item" data-page="vas-b1-FL.html">
                    <i class="fas fa-feather-alt"></i>
                    <span>Flock</span>
                </a>
                <a href="#" class="mobile-nav-item" data-page="vas-b1-SF.html">
                    <i class="fas fa-shipping-fast"></i>
                    <span>Shipping</span>
                </a>
            </div>

            <div class="mobile-actions">
                <button class="mobile-action-item" id="mobileSaveButton">
                    <i class="fas fa-save"></i>
                    <span>Save Changes</span>
                </button>
                <button class="mobile-action-item" id="mobilePrintButton">
                    <i class="fas fa-file-pdf"></i>
                    <span>Print PDF</span>
                </button>
            </div>
        </div>
    </div>
</header>

<!-- Status Messages -->
<div class="status-messages">
    <div id="saveStatus" class="status-message"></div>
    <div id="resetStatus" class="status-message"></div>
</div>


     

 

     <style>
        /* CSS Variables for consistent theming */
        :root {
            --primary-color: #1a73e8;
            --primary-dark: #1557b0;
            --secondary-color: #5f6368;
            --secondary-dark: #3c4043;
            --success-color: #137333;
            --warning-color: #f9ab00;
            --error-color: #d93025;
            --text-primary: #202124;
            --text-secondary: #5f6368;
            --text-muted: #9aa0a6;
            --background-primary: #ffffff;
            --background-secondary: #f8f9fa;
            --background-glass: rgba(255, 255, 255, 0.95);
            --border-color: #dadce0;
            --shadow-sm: 0 1px 3px rgba(60, 64, 67, 0.15);
            --shadow-md: 0 2px 6px rgba(60, 64, 67, 0.15);
            --shadow-lg: 0 4px 12px rgba(60, 64, 67, 0.15);
            --radius-sm: 8px;
            --radius-md: 12px;
            --radius-lg: 16px;
            --transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* Reset and Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Google Sans', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--background-secondary);
            color: var(--text-primary);
            line-height: 1.5;
            margin-top: 64px;
            min-height: 100vh;
        }

   .modern-header {
    background: var(--background-primary);
    border-bottom: 1px solid var(--border-color);
    box-shadow: var(--shadow-sm);
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    z-index: 1000;
    height: 83px;
    transition: var(--transition);
}

        .header-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 24px;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        /* Logo Section */
        .logo-section {
            display: flex;
            align-items: center;
            gap: 12px;
            flex-shrink: 0;
        }
.main-logo-img {
    height: 38px;  /* Increased from 32px (32px × 1.1 = 35.2px) */
    width: auto;
    max-width: none;
    border: none;
    border-radius: 0;
    object-fit: contain;
}

        .logo-text {
            display: flex;
            flex-direction: column;
        }

        .logo-title {
            font-size: 18px;
            font-weight: 500;
            color: var(--text-primary);
            line-height: 1.2;
        }

        .logo-subtitle {
            font-size: 12px;
            color: var(--text-secondary);
            font-weight: 400;
        }

        /* Navigation */
        .nav-container {
            display: flex;
            align-items: center;
            flex: 1;
            justify-content: center;
            max-width: 600px;
            margin: 0 24px;
        }

        .nav-links {
            display: flex;
            align-items: center;
            gap: 2px;
            background: var(--background-secondary);
            border-radius: 32px;
            padding: 2px;
            border: 1px solid var(--border-color);
        }
.nav-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 40px;
    background: var(--background-secondary);
    border: 1px solid var(--border-color);
    border-radius: var(--radius-md);
    color: #000000;
    cursor: pointer;
    transition: var(--transition);
    font-size: 16px;
}

.nav-item:hover {
  background: transparent;
  transform: none;
  box-shadow: none;
}

.nav-item:hover .nav-icon,
.nav-item:hover .nav-label {
    color: var(--primary-color);
}
/* Ensure the entire nav-item area is hoverable */
.nav-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 4px;
    padding: 8px 16px;
    border-radius: 24px;
    text-decoration: none;
    color: #000000;
    font-size: 14px;
    font-weight: 900;
    transition: var(--transition);
    white-space: nowrap;
    min-height: 60px;
    cursor: pointer;
    justify-content: center;
}

/* Remove any pointer events from child elements */
/* Remove any pointer events from child elements */
.nav-icon,
.nav-label {
    pointer-events: none;
}
.nav-btn i {
    font-weight: 900;
    color: #000000;
}



    .nav-item:hover {
    background: rgba(26, 115, 232, 0.08);
    color: var(--primary-color);
}
.nav-item.active {
    background: var(--background-secondary);
    color: #000000;
    box-shadow: var(--shadow-sm);
    border: 1px solid var(--primary-color);
}
.nav-icon {
    font-size: 22px;
    transition: var(--transition);
    flex-shrink: 0;
    min-width: 22px;
    font-weight: normal;
}
.action-btn i {
    font-weight: 900;
    font-size: 12px;  /* Make the icons in action buttons smaller too */
}
.mobile-nav-item i {
    font-weight: 900;
}

.mobile-action-item i {
    font-weight: 900;
}
.nav-label {
    font-size: 14px;
    font-weight: 900;
    line-height: 1.2;
}

/* Daily Mortality - red like the dashboard */
.nav-item[data-page="vas-b1-F1-MC.html"] .nav-icon {
  color: #e74c3c !important;
  display: inline-block !important;
  visibility: visible !important;
  font-family: "Font Awesome 6 Free" !important;
  font-weight: 900 !important;
}

/* Visitors - orange like the visitor card */
.nav-item[data-page="vas-b1-VF.html"] .nav-icon {
  color: #e67e22 !important;
  display: inline-block !important;
  visibility: visible !important;
  font-family: "Font Awesome 6 Free" !important;
  font-weight: 900 !important;
}
/* Mortality Records - green like the mortality card */
.nav-item[data-page="../floors/vbarn-1-1.html"] .nav-icon {
  color: #2ecc71 !important;
  display: inline-block !important;
  visibility: visible !important;
  font-family: "Font Awesome 6 Free" !important;
  font-weight: 900 !important;
}

/* Flock - blue like the flock card */
.nav-item[data-page="vas-b1-FL.html"] .nav-icon {
  color: #3498db !important;
  display: inline-block !important;
  visibility: visible !important;
  font-family: "Font Awesome 6 Free" !important;
  font-weight: 900 !important;
}

/* Shipping - navy blue like the shipping card */
.nav-item[data-page="vas-b1-SF.html"] .nav-icon {
  color: #1a365d !important;
  display: inline-block !important;
  visibility: visible !important;
  font-family: "Font Awesome 6 Free" !important;
  font-weight: 900 !important;
}

/* Universal fix for all Font Awesome icons */
.fa, .fas, .far, .fab, .nav-icon {
  font-family: "Font Awesome 6 Free" !important;
  font-weight: 900 !important;
  display: inline-block !important;
  visibility: visible !important;
}
/* Make action button icons match their button colors */
.action-btn.secondary .fas {
  color: inherit;
}


.action-btn.primary .fas {
    color: white;
}


        /* Action Buttons */
        .action-buttons {
            display: flex;
            align-items: center;
            gap: 8px;
            flex-shrink: 0;
        }

.action-btn {
    display: flex;
    align-items: center;
    gap: 9px;  /* Decreased from 10px (10px × 0.9 = 9px) */
    padding: 9px 16px;  /* Decreased from 10px 18px */
    border-radius: var(--radius-md);
    text-decoration: none;
    font-weight: 700;
    font-size: 13px;  /* Decreased from 15px (15px × 0.9 = 13.5px) */
    transition: var(--transition);
    border: 1px solid var(--border-color);
    cursor: pointer;
    min-height: 40px;  /* Decreased from 44px (44px × 0.9 = 39.6px) */
}

        .action-btn.primary {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .action-btn.primary:hover {
            background: var(--primary-dark);
            border-color: var(--primary-dark);
            box-shadow: var(--shadow-md);
        }

        .action-btn.secondary {
            background: var(--background-primary);
            color: var(--text-primary);
        }

        .action-btn.secondary:hover {
            background: var(--background-secondary);
            box-shadow: var(--shadow-md);
        }


            /* ADD THE NEW CODE HERE: */
        .nav-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            background: var(--background-secondary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            color: var(--text-secondary);
            cursor: pointer;
            transition: var(--transition);
            font-size: 16px;
        }

        .nav-btn:hover {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
            box-shadow: var(--shadow-md);
        }

        .main-content {
            width: 100%;
            max-width: 9.35in;
            margin: 0 auto;
            transform: scale(1.10);
            transform-origin: top center;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .page {
            width: 100%;
            max-width: 8.5in;
            margin: 0 auto;
        }

        /* Mobile Menu Toggle */
        .mobile-menu-toggle {
            display: none;
            flex-direction: column;
            gap: 4px;
            padding: 8px;
            background: transparent;
            border: none;
            border-radius: var(--radius-sm);
            cursor: pointer;
            transition: var(--transition);
        }

        .mobile-menu-toggle:hover {
            background: var(--background-secondary);
        }

        .mobile-menu-toggle span {
            width: 20px;
            height: 2px;
            background: var(--text-secondary);
            border-radius: 1px;
            transition: var(--transition);
        }

        .mobile-menu-toggle.active span:nth-child(1) {
            transform: rotate(45deg) translate(5px, 5px);
        }

        .mobile-menu-toggle.active span:nth-child(2) {
            opacity: 0;
        }

        .mobile-menu-toggle.active span:nth-child(3) {
            transform: rotate(-45deg) translate(7px, -6px);
        }

        /* Mobile Navigation Menu */
        .mobile-nav-menu {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: var(--background-primary);
            border-bottom: 1px solid var(--border-color);
            box-shadow: var(--shadow-lg);
            transform: translateY(-100%);
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
            z-index: 999;
        }

        .mobile-nav-menu.active {
            transform: translateY(0);
            opacity: 1;
            visibility: visible;
        }

        .mobile-nav-content {
            padding: 24px;
            display: flex;
            flex-direction: column;
            gap: 24px;
        }

        .mobile-nav-links {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

.mobile-nav-item {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 12px 16px;
    border-radius: var(--radius-md);
    text-decoration: none;
    color: var(--text-primary);
    transition: var(--transition);
    border: 1px solid var(--border-color);
    background: rgba(26, 115, 232, 0.08);
}

.mobile-nav-item:hover {
    background: rgba(26, 115, 232, 0.12);
    border-color: var(--primary-color);
}

.mobile-nav-item.active {
    background: rgba(26, 115, 232, 0.15);
    color: var(--primary-color);
    border-color: var(--primary-color);
}

        .mobile-actions {
            display: flex;
            flex-direction: column;
            gap: 8px;
            border-top: 1px solid var(--border-color);
            padding-top: 24px;
        }

        .mobile-action-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            background: var(--background-secondary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: var(--transition);
            color: var(--text-primary);
            font-weight: 500;
        }

        .mobile-action-item:hover {
            background: var(--background-primary);
            box-shadow: var(--shadow-sm);
        }

        /* Status Messages */
        .status-messages {
            position: fixed;
            top: 80px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 1002;
            pointer-events: none;
        }

        .status-message {
            margin-bottom: 8px;
            padding: 12px 24px;
            border-radius: var(--radius-md);
            font-weight: 500;
            text-align: center;
            opacity: 0;
            transform: translateY(-20px);
            transition: var(--transition);
            pointer-events: auto;
            box-shadow: var(--shadow-md);
        }

        .status-message.show {
            opacity: 1;
            transform: translateY(0);
        }

        .status-message.success {
            background: rgba(19, 115, 51, 0.1);
            color: var(--success-color);
            border: 1px solid rgba(19, 115, 51, 0.2);
        }

        .status-message.error {
            background: rgba(217, 48, 37, 0.1);
            color: var(--error-color);
            border: 1px solid rgba(217, 48, 37, 0.2);
        }

        .nav-btn i {
    font-weight: 900;
}

/* Mobile nav icons - match desktop colors */
.mobile-nav-item[data-page="vas-b1-F1-MC.html"] i {
  color: #e74c3c !important; /* Red for Daily Mortality */
}

.mobile-nav-item[data-page="vas-b1-VF.html"] i {
  color: #e67e22 !important; /* Orange for Visitors */
}

.mobile-nav-item[data-page="../floors/vbarn-1-1.html"] i {
  color: #2ecc71 !important; /* Green for Mortality Records */
}

.mobile-nav-item[data-page="vas-b1-FL.html"] i {
  color: #3498db !important; /* Blue for Flock */
}

.mobile-nav-item[data-page="vas-b1-SF.html"] i {
  color: #1a365d !important; /* Navy for Shipping */
}

/* Make mobile dropdown bigger */
@media (max-width: 768px) {
    .mobile-nav-content {
        padding: 32px 24px !important; /* Increased from 24px */
        gap: 32px !important; /* Increased from 24px */
    }
    
    .mobile-nav-item {
        padding: 16px 20px !important; /* Increased from 12px 16px */
        font-size: 16px !important; /* Add explicit font size */
        display: flex;
        align-items: center;
        gap: 12px;
        border-radius: var(--radius-md);
        text-decoration: none;
        color: var(--primary-color) !important; /* Blue text like Daily Mortality */
        transition: var(--transition);
        border: 1px solid var(--primary-color) !important; /* Blue border */
        background: rgba(26, 115, 232, 0.08) !important; /* Light blue background like Daily Mortality */
    }
    
    .mobile-nav-item:hover {
        background: rgba(26, 115, 232, 0.12) !important;
        border-color: var(--primary-color) !important;
    }

    /* Remove the active state distinction - make all look the same */
    .mobile-nav-item.active {
        background: rgba(26, 115, 232, 0.08) !important; /* Same as regular state */
        color: var(--primary-color) !important;
        border-color: var(--primary-color) !important;
    }
    
    .mobile-nav-item i {
        font-size: 20px !important; /* Make icons bigger */
    }
    
    .mobile-action-item {
        padding: 16px 20px !important; /* Increased from 12px 16px */
        font-size: 16px !important; /* Add explicit font size */
    }
    
    .mobile-action-item i {
        font-size: 18px !important; /* Make action icons bigger */
    }
    
    .mobile-actions {
        gap: 12px !important; /* Increased from 8px */
        padding-top: 32px !important; /* Increased from 24px */
    }
    
    .mobile-nav-links {
        gap: 12px !important; /* Increased from 8px */
    }
}

/* Add black borders to back and main menu buttons (mobile and desktop) */
.nav-btn {
    border: 2px solid #000000 !important;
}

.nav-btn:hover {
    border-color: #000000 !important;
}

/* Make mobile back and menu icons 20% larger */
@media (max-width: 768px) {
    .nav-btn {
        font-size: 19.2px !important; /* 20% larger - increased from 16px (16px × 1.2 = 19.2px) */
    }
    
    .nav-btn i {
        font-size: 19.2px !important; /* Make sure the icons inside are also bigger */
    }
}


        /* Responsive Design */
        @media (max-width: 768px) {
            body {
                    margin-top: 83px;
            }
            
            .header-container {
                padding: 0 16px;
            }
            
            .nav-container {
                display: none;
            }
            
            .mobile-menu-toggle {
                display: flex;
            }
            
            .action-buttons {
                display: none;
            }
            
            .logo-title {
                font-size: 16px;
            }
            
            .logo-subtitle {
                display: none;
            }

               .main-logo-img {
        height: 39px;  /* 28px × 1.4 = 39.2px */
        width: auto;
    }

        }

        @media (max-width: 480px) {
            .header-container {
                padding: 0 12px;
            }
            
            .main-logo-img {
                height: 28px;
                width: 28px;
            }
            
            .mobile-nav-content {
                padding: 16px;
            }
        }
    </style>

    <script>
        // Enhanced Navigation functionality
        class HeaderNavigation {
            constructor() {
                this.initializeNavigation();
                this.initializeMobileMenu();
                this.initializeActionButtons();
                this.bindEvents();
            }

            initializeNavigation() {
                // Navigation items
                this.navItems = document.querySelectorAll('.nav-item, .mobile-nav-item');
                this.navItems.forEach(item => {
                    item.addEventListener('click', this.handleNavClick.bind(this));
                });
            }

          initializeMobileMenu() {
    this.mobileToggle = document.getElementById('mobileMenuToggle');
    this.mobileMenu = document.getElementById('mobileNavMenu');
    
    if (this.mobileToggle) {
        this.mobileToggle.addEventListener('click', (e) => {
            e.preventDefault();
            e.stopPropagation();
            e.stopImmediatePropagation();
            this.toggleMobileMenu();
            return false;
        });
    }
}

initializeActionButtons() {
  // Desktop navigation buttons
  this.desktopBackButton = document.getElementById('desktopBackButton');
  this.desktopMainMenuButton = document.getElementById('desktopMainMenuButton');
  
  // Desktop action buttons
  this.saveButton = document.getElementById('saveFormButton');
  this.resetButton = document.getElementById('resetFormButton');
  this.printButton = document.getElementById('printPDFButton');
  
  // Mobile action buttons
  this.mobileSaveButton = document.getElementById('mobileSaveButton');
  this.mobileResetButton = document.getElementById('mobileResetButton');
  this.mobilePrintButton = document.getElementById('mobilePrintButton');
  this.mobileBackButton = document.getElementById('mobileBackButton');
  this.mobileMainMenuButton = document.getElementById('mobileMainMenuButton');

  // Bind navigation handlers
  if (this.desktopBackButton) this.desktopBackButton.addEventListener('click', this.handleBack.bind(this));
  if (this.desktopMainMenuButton) this.desktopMainMenuButton.addEventListener('click', this.handleMainMenu.bind(this));

  // Bind action handlers
  if (this.saveButton) this.saveButton.addEventListener('click', this.handleSave.bind(this));
  if (this.resetButton) this.resetButton.addEventListener('click', this.handleReset.bind(this));
  if (this.printButton) this.printButton.addEventListener('click', this.handlePrint.bind(this));
  
  if (this.mobileSaveButton) this.mobileSaveButton.addEventListener('click', this.handleSave.bind(this));
  if (this.mobileResetButton) this.mobileResetButton.addEventListener('click', this.handleReset.bind(this));
  if (this.mobilePrintButton) this.mobilePrintButton.addEventListener('click', this.handlePrint.bind(this));
  if (this.mobileBackButton) this.mobileBackButton.addEventListener('click', this.handleBack.bind(this));
  if (this.mobileMainMenuButton) this.mobileMainMenuButton.addEventListener('click', this.handleMainMenu.bind(this));
}
            bindEvents() {
                // Close mobile menu on outside click
                document.addEventListener('click', this.handleOutsideClick.bind(this));
                
                // Handle window resize
                window.addEventListener('resize', this.handleResize.bind(this));
            }

            handleNavClick(event) {
                event.preventDefault();
                
                const clickedItem = event.currentTarget;
                const page = clickedItem.dataset.page;
                
                // Remove active class from all items
                this.navItems.forEach(item => item.classList.remove('active'));
                
                // Add active class to clicked item and its counterpart
                clickedItem.classList.add('active');
                
                // Find and activate the counterpart (desktop/mobile)
                const counterpart = document.querySelector(
                    clickedItem.classList.contains('nav-item') 
                        ? `.mobile-nav-item[data-page="${page}"]`
                        : `.nav-item[data-page="${page}"]`
                );
                
                if (counterpart) {
                    counterpart.classList.add('active');
                }
                
                // Close mobile menu
                this.closeMobileMenu();
                
                // Navigate to page
                if (page) {
                    this.navigateToPage(page);
                }
            }

            toggleMobileMenu() {
                const isActive = this.mobileToggle.classList.contains('active');
                
                if (isActive) {
                    this.closeMobileMenu();
                } else {
                    this.openMobileMenu();
                }
            }

            openMobileMenu() {
                this.mobileToggle.classList.add('active');
                this.mobileMenu.classList.add('active');
                document.body.style.overflow = 'hidden'; // Prevent background scroll
            }

            closeMobileMenu() {
                this.mobileToggle.classList.remove('active');
                this.mobileMenu.classList.remove('active');
                document.body.style.overflow = ''; // Restore scroll
            }

            handleOutsideClick(event) {
                if (this.mobileMenu && this.mobileToggle && 
                    !this.mobileMenu.contains(event.target) && 
                    !this.mobileToggle.contains(event.target) &&
                    this.mobileMenu.classList.contains('active')) {
                    this.closeMobileMenu();
                }
            }

            handleResize() {
                // Close mobile menu on resize to larger screen
                if (window.innerWidth > 768 && this.mobileMenu.classList.contains('active')) {
                    this.closeMobileMenu();
                }
            }

            // Action handlers
            handleSave() {
                this.showStatusMessage('Changes saved successfully!', 'success');
                // Add your save logic here
            }

            handleReset() {
                if (confirm('Are you sure you want to reset the form? All unsaved changes will be lost.')) {
                    this.showStatusMessage('Form reset successfully!', 'success');
                    // Add your reset logic here
                }
            }


            handleBack() {
                this.closeMobileMenu();
                // Navigate back - you can customize this
                if (window.history.length > 1) {
                    window.history.back();
                } else {
                    this.navigateToPage('../floors-dash/v-floor-b1.html');
                }
            }

            handleMainMenu() {
                this.closeMobileMenu();
                this.navigateToPage('../Extra/main-dashboard.html');
            }

            // Utility functions
            navigateToPage(page) {
                if (page) {
                    // Add loading state
                    this.showStatusMessage('Loading page...', 'success');
                    
                    // Simulate navigation - replace with actual navigation logic
                    setTimeout(() => {
                        window.location.href = page;
                    }, 300);
                }
            }

            showStatusMessage(message, type = 'success') {
                const statusContainer = document.querySelector('.status-messages');
                const statusElement = document.createElement('div');
                statusElement.className = `status-message ${type}`;
                statusElement.textContent = message;
                
                statusContainer.appendChild(statusElement);
                
                // Trigger animation
                setTimeout(() => {
                    statusElement.classList.add('show');
                }, 100);
                
                // Remove after 3 seconds
                setTimeout(() => {
                    statusElement.classList.remove('show');
                    setTimeout(() => {
                        if (statusElement.parentNode) {
                            statusElement.parentNode.removeChild(statusElement);
                        }
                    }, 300);
                }, 3000);
            }

            // Update status indicator
            updateConnectionStatus(isOnline = true) {
                const statusIndicator = document.querySelector('.status-indicator');
                const statusDot = document.querySelector('.status-dot');
                const statusText = statusIndicator.querySelector('span');
                
                if (isOnline) {
                    statusDot.style.background = 'var(--success-color)';
                    statusText.textContent = 'Online';
                    statusIndicator.style.color = 'white';
                } else {
                    statusDot.style.background = 'var(--warning-color)';
                    statusText.textContent = 'Offline';
                    statusIndicator.style.color = 'white';
                }
            }
        }

        // Create a new document export function
function exportDocument(options = {}) {
  // Default options
  const defaultOptions = {
    filename: 'Flock Log - Vassilaokos Farm Inc. - Barn #1',
    format: 'pdf' // pdf or txt
  };
  
  // Merge default options with provided options
  const settings = {...defaultOptions, ...options};
  
  // Show a modal with options before generating
  showExportOptionsModal(settings);
}

// Function to show the export options modal
// Replace the existing showExportOptionsModal function with this improved version
function showExportOptionsModal(settings) {
  // Remove any existing modal first to prevent duplicates
  const existingModal = document.querySelector('.export-options-modal');
  if (existingModal) {
    document.body.removeChild(existingModal);
  }
  
  // Create modal container
  const modal = document.createElement('div');
  modal.className = 'export-options-modal';
  modal.style.cssText = `
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: rgba(0,0,0,0.5);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 9999;
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
  `;
  
  // Create modal content
  const modalContent = document.createElement('div');
  modalContent.className = 'export-options-content';
  modalContent.style.cssText = `
    background-color: white;
    border-radius: 8px;
    width: 400px;
    max-width: 90%;
    padding: 24px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.2);
    display: flex;
    flex-direction: column;
    gap: 20px;
  `;
  
  const modalHeader = document.createElement('div');
  modalHeader.innerHTML = `
    <h2 style="margin:0; color:#1a73e8; font-size:20px; font-weight:500;">Export PDF</h2>
    <p style="margin:8px 0 0; color:#5f6368; font-size:14px;">Choose your filename</p>
  `;
  
  // Create form for options
  const form = document.createElement('form');
  form.style.cssText = `display: flex; flex-direction: column; gap: 16px;`;
  
  // Add filename option
  const filenameGroup = document.createElement('div');
  filenameGroup.style.cssText = `display: flex; flex-direction: column; gap: 6px;`;
  filenameGroup.innerHTML = `
    <label for="export-filename" style="font-size:14px; font-weight:500; color:#202124;">Filename</label>
    <input type="text" id="export-filename" value="${settings.filename}" style="padding:10px; border-radius:4px; border:1px solid #dadce0; font-size:14px;">
  `;
  
  // Add buttons
  const buttonGroup = document.createElement('div');
  buttonGroup.style.cssText = `
    display: flex;
    justify-content: flex-end;
    gap: 12px;
    margin-top: 8px;
  `;
  
  // Cancel button
  const cancelButton = document.createElement('button');
  cancelButton.textContent = 'Cancel';
  cancelButton.type = 'button';
  cancelButton.style.cssText = `
    padding: 10px 16px;
    border: 1px solid #dadce0;
    border-radius: 4px;
    background: white;
    color: #5f6368;
    font-size: 14px;
    font-weight: 500;
    cursor: pointer;
  `;
  
  const generateButton = document.createElement('button');
  generateButton.textContent = 'Export PDF';
  generateButton.type = 'button';
  generateButton.style.cssText = `
    padding: 10px 16px;
    border: none;
    border-radius: 4px;
    background: #1a73e8;
    color: white;
    font-size: 14px;
    font-weight: 500;
    cursor: pointer;
  `;
  
  // Add all elements to the form
  form.appendChild(filenameGroup);
  form.appendChild(buttonGroup);
  buttonGroup.appendChild(cancelButton);
  buttonGroup.appendChild(generateButton);
  
  // Add form to modal content
  modalContent.appendChild(modalHeader);
  modalContent.appendChild(form);
  
  // Add modal content to modal
  modal.appendChild(modalContent);
  
  // Add modal to body
  document.body.appendChild(modal);
  
  // Function to close modal - extracted to a separate function
  // to ensure we only have one handler
  function closeModal() {
    if (modal.parentNode) {
      document.body.removeChild(modal);
    }
  }
  
  // Cancel button event - using the extracted function
  cancelButton.addEventListener('click', closeModal, { once: true });
  
  // Close on clicking outside the modal content
  modal.addEventListener('click', function(e) {
    if (e.target === modal) {
      closeModal();
    }
  });
  
  // Close on ESC key
  document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') {
      closeModal();
    }
  }, { once: true });
  
  // Generate button event
  generateButton.addEventListener('click', function() {
    // Collect values from form
    const filename = document.getElementById('export-filename').value || 'farm-records';
    const format = 'pdf'; // Always use PDF format
    
    // Remove modal
    closeModal();
    
    // Show loading indicator
    showLoading();
    
    // Start document generation based on format
    setTimeout(() => {
      createAndDownloadPDF(filename + '.pdf');
    }, 100);
  }, { once: true });
}


// Function to show loading indicator
function showLoading() {
  const loadingEl = document.createElement('div');
  loadingEl.id = 'export-loading-indicator';
  loadingEl.style.cssText = `
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: rgba(255,255,255,0.8);
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    z-index: 9999;
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
  `;
  
  loadingEl.innerHTML = `
    <div style="width: 40px; height: 40px; border: 4px solid #f3f3f3; border-top: 4px solid #1a73e8; border-radius: 50%; animation: export-spinner 1s linear infinite;"></div>
    <p style="margin-top: 16px; color: #1a73e8; font-size: 16px; font-weight: 500;">Generating document...</p>
    <style>
      @keyframes export-spinner {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
      }
    </style>
  `;
  
  document.body.appendChild(loadingEl);
}

// Function to hide loading indicator
function hideLoading() {
  const loadingEl = document.getElementById('export-loading-indicator');
  if (loadingEl) {
    document.body.removeChild(loadingEl);
  }
}

async function createAndDownloadPDF(filename) {
  try {
    // Show loading indicator
    showLoading();
    
    // Load required libraries dynamically
    await loadLibraries([
      'https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js',
      'https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js'
    ]);
    
    // Create PDF with fixed format and orientation
    const pdf = new jspdf.jsPDF({
      format: 'letter',
      orientation: 'portrait',
      unit: 'mm',
      compress: true
    });
    
    // Get PDF dimensions
    const pdfWidth = pdf.internal.pageSize.getWidth();
    const pdfHeight = pdf.internal.pageSize.getHeight();
    
    // Define margins
    const margin = 10; // mm
    const usableHeight = pdfHeight - (2 * margin); // Height available for content
    
    // Add special class to body for PDF styling
    document.body.classList.add('pdf-export-mode');
    
    // Create and add PDF-specific styles - this will be applied globally
    const pdfStylesheet = document.createElement('style');
    pdfStylesheet.id = 'pdf-export-styles';
    pdfStylesheet.textContent = `
      .pdf-export-mode {
        background-color: white !important;
      }
      
   .pdf-export-mode .title-section {
  text-align: center !important;
  margin-bottom: 15px !important;
  margin-top: -90px !important;
}
      
      .pdf-export-mode .main-title {
        font-size: 18px !important;
        font-weight: bold !important;
        margin-bottom: 5px !important;
      }
      
      .pdf-export-mode .subtitle {
        font-size: 14px !important;
      }
      
      .pdf-export-mode .section-header {
        background-color: #1a73e8 !important;
        color: white !important;
        padding: 8px 10px !important;
        font-weight: 500 !important;
      }
      
      .pdf-export-mode table {
        border-collapse: collapse !important;
        width: 100% !important;
      }
      
      .pdf-export-mode th {
        background-color: #e8f0fe !important;
        color: #1a73e8 !important;
        padding: 8px !important;
        text-align: left !important;
        border: 1px solid #dadce0 !important;
      }
      
      .pdf-export-mode td {
        padding: 8px !important;
        border: 1px solid #dadce0 !important;
      }
      
      /* Special styling for Chick Quality Assessment in right-column */
      .pdf-export-mode .right-column table {
        width: 100% !important;
        table-layout: fixed !important;
      }
      
      .pdf-export-mode .right-column th {
        text-align: center !important;
        font-size: 10px !important;
        padding: 6px !important;
        background-color: #e8f0fe !important;
        color: #1a73e8 !important;
        border: 1px solid #dadce0 !important;
      }
      
      .pdf-export-mode .right-column td {
        text-align: center !important;
        vertical-align: middle !important;
        padding: 6px !important;
      }
      
      /* Preserve all columns in right-column tables */
      .pdf-export-mode .right-column table tr th,
      .pdf-export-mode .right-column table tr td {
        display: table-cell !important;
        visibility: visible !important;
        opacity: 1 !important;
        position: static !important;
        width: auto !important;
      }
      
      /* Additional selector to catch any "remove" buttons */
      .pdf-export-mode button[onclick*="delete"],
      .pdf-export-mode button[onclick*="remove"],
      .pdf-export-mode td:has(button[onclick*="delete"]),
      .pdf-export-mode td:has(button[onclick*="remove"]) {
        display: none !important;
        visibility: hidden !important;
        width: 0 !important;
        max-width: 0 !important;
        padding: 0 !important;
        margin: 0 !important;
        border: none !important;
        font-size: 0 !important;
        line-height: 0 !important;
        height: 0 !important;
        opacity: 0 !important;
        position: absolute !important;
        left: -9999px !important;
        overflow: hidden !important;
      }
      
      /* Hide "Add Entry" buttons and containers */
      .pdf-export-mode button[id*="add"],
      .pdf-export-mode div:has(> button[id*="add"]) {
        display: none !important;
        visibility: hidden !important;
        height: 0 !important;
        margin: 0 !important;
        padding: 0 !important;
        overflow: hidden !important;
      }
      
      /* Remove borders from inputs */
      .pdf-export-mode input, 
      .pdf-export-mode select, 
      .pdf-export-mode textarea {
        border: none !important;
        background: transparent !important;
        font-family: inherit !important;
      }
      
      /* Fix checkbox appearance */
      .pdf-export-mode input[type="checkbox"] {
        -webkit-appearance: none !important;
        -moz-appearance: none !important;
        appearance: none !important;
        width: 14px !important;
        height: 14px !important;
        border: 1px solid #333 !important;
        border-radius: 2px !important;
        position: relative !important;
      }
      
      .pdf-export-mode input[type="checkbox"]:checked::after {
        content: "✓" !important;
        position: absolute !important;
        top: -2px !important;
        left: 2px !important;
        font-size: 14px !important;
        color: #333 !important;
      }
      
      /* Hide elements not needed in PDF */
      .pdf-export-mode .section-navigator,
      .pdf-export-mode .mobile-nav-menu,
      .pdf-export-mode .top-header,
      .pdf-export-mode .left-sidebar,
      .pdf-export-mode .mobile-menu-toggle,
      .pdf-export-mode .status-messages,
      .pdf-export-mode .modern-header,
      .pdf-export-mode button[id*="add"] {
        display: none !important;
      }
      
      /* Logo styling for PDF */
      .pdf-logo {
        position: absolute !important;
        top: 10px !important;
        left: 10px !important;
     width: 130.5px !important;
        height: auto !important;
        z-index: 100 !important;
      }

    /* Remove borders from date inputs specifically */
.pdf-export-mode input[type="date"] {
  border: none !important;
  background: transparent !important;
  font-family: inherit !important;
  outline: none !important;
  box-shadow: none !important;
}

/* Remove borders from No pets in the RA signature input */
.pdf-export-mode .signature-input {
  border: none !important;
  border-bottom: none !important;
  background: transparent !important;
  outline: none !important;
  box-shadow: none !important;
}

/* Remove borders from Downtime number input */
.pdf-export-mode input[type="number"] {
  border: none !important;
  background: transparent !important;
  font-family: inherit !important;
  outline: none !important;
  box-shadow: none !important;
}

    `;
    document.head.appendChild(pdfStylesheet);
    
    // Function to clean up element for PDF
    function cleanElementForPDF(element) {
      const cleaned = element.cloneNode(true);
      
      // Special handling for the right-column (Chick Quality Assessment)
      if (cleaned.classList && cleaned.classList.contains('right-column')) {
        // Find the table
        const table = cleaned.querySelector('table');
        if (table) {
          // Mark this table to exclude it from column hiding
          table.classList.add('chick-quality-table');
          
          // Ensure the table header structure is preserved
          const thead = table.querySelector('thead');
          if (thead) {
            // Make sure ALL header rows are visible
            const allHeaderRows = thead.querySelectorAll('tr');
            allHeaderRows.forEach(row => {
              row.style.display = 'table-row';
              row.style.visibility = 'visible';
              
              // Make sure all header cells in each row are visible
              const allHeaderCells = row.querySelectorAll('th');
              allHeaderCells.forEach(cell => {
                cell.style.display = 'table-cell';
                cell.style.visibility = 'visible';
                cell.style.textAlign = 'center';
                cell.style.border = '1px solid #dadce0';
                cell.style.backgroundColor = '#e8f0fe';
                cell.style.color = '#1a73e8';
                cell.style.padding = '6px';
                cell.style.fontWeight = 'bold';
                cell.style.fontSize = '10px';
                
                // Preserve rowspan and colspan attributes
                if (cell.hasAttribute('rowspan')) {
                  cell.style.verticalAlign = 'middle';
                }
              });
            });
          }
          
          // Center all body cells
          const allCells = table.querySelectorAll('td');
          allCells.forEach(cell => {
            cell.style.textAlign = 'center';
            cell.style.verticalAlign = 'middle';
            cell.style.display = 'table-cell';
            cell.style.visibility = 'visible';
          });
        }
        
        return cleaned;
      }
      
      // Check section headers to determine handling
      const sectionHeader = cleaned.querySelector('.section-header');
      const headerText = sectionHeader ? sectionHeader.textContent : '';
      
      // These sections should keep all columns
      const keepAllColumns = ['BARN CLEANING', 'Facilities Preparation', 'Pest Control'];
      const shouldKeepAllColumns = keepAllColumns.some(text => headerText.includes(text));
      
      // These sections should hide the last column
      const hideLastColumn = ['Water - Record all products', 'Feed', 'Feed Transfer Record', 'Medications - Complete', 'Deviation Chart'];
      const shouldHideLastColumn = hideLastColumn.some(text => headerText.includes(text));
      
      if (shouldKeepAllColumns) {
        // Don't hide any columns for these sections
        const tables = cleaned.querySelectorAll('table');
        tables.forEach(table => {
          table.classList.add('keep-all-columns');
          // Ensure all cells are visible
          const allCells = table.querySelectorAll('th, td');
          allCells.forEach(cell => {
            cell.style.display = 'table-cell';
            cell.style.visibility = 'visible';
          });
        });
      } else if (shouldHideLastColumn) {
        // For these sections, definitely hide the last column
        const tables = cleaned.querySelectorAll('table');
        tables.forEach(table => {
          const rows = table.querySelectorAll('tr');
          rows.forEach(row => {
            const cells = row.querySelectorAll('th, td');
            if (cells.length > 0) {
              const lastCell = cells[cells.length - 1];
              
              // Force hide the last cell
              lastCell.style.display = 'none';
              lastCell.style.visibility = 'hidden';
              lastCell.style.width = '0';
              lastCell.style.maxWidth = '0';
              lastCell.style.padding = '0';
              lastCell.style.margin = '0';
              lastCell.style.border = 'none';
              lastCell.style.fontSize = '0';
              lastCell.style.lineHeight = '0';
              lastCell.style.height = '0';
              lastCell.style.opacity = '0';
              lastCell.style.position = 'absolute';
              lastCell.style.left = '-9999px';
              lastCell.style.overflow = 'hidden';
              
              // Also remove the cell from DOM to be extra sure
              lastCell.innerHTML = '';
            }
          });
        });
      }
      
      // Hide all add buttons
      const addButtons = cleaned.querySelectorAll('button[id*="add"]');
      addButtons.forEach(button => {
        button.style.display = 'none';
        button.style.visibility = 'hidden';
        button.style.height = '0';
        button.style.margin = '0';
        button.style.padding = '0';
        
        // Also hide the parent container
        const container = button.parentNode;
        if (container) {
          container.style.display = 'none';
          container.style.visibility = 'hidden';
          container.style.height = '0';
          container.style.margin = '0';
          container.style.padding = '0';
          container.style.overflow = 'hidden';
        }
      });
      
      return cleaned;
    }
    
    // Function to measure element height accurately
    async function measureElementHeight(element) {
      const tempContainer = document.createElement('div');
      tempContainer.style.position = 'absolute';
      tempContainer.style.left = '-9999px';
      tempContainer.style.top = '0';
      tempContainer.style.width = `${pdfWidth - 2 * margin}mm`;
      tempContainer.style.backgroundColor = 'white';
      
      const clonedElement = element.cloneNode(true);
      tempContainer.appendChild(clonedElement);
      
      document.body.appendChild(tempContainer);
      
      // Force layout calculation
      await new Promise(resolve => setTimeout(resolve, 0));
      
      const rect = tempContainer.getBoundingClientRect();
      const height = rect.height;
      
      document.body.removeChild(tempContainer);
      
      // Convert pixels to mm (approximate)
      const heightInMm = (height / 96) * 25.4; // 96 DPI
      
      return heightInMm;
    }
    
    // Get all content elements
    const titleSection = document.querySelector('.title-section');
    const productionInfo = document.querySelector('.production-info');
    const placementNotes = document.querySelector('div[style*="margin: 20px 0"]');
    const sections = Array.from(document.querySelectorAll('.section'));
    
    // Get logo
    const logoImg = document.querySelector('.main-logo-img');
    const logoSrc = logoImg ? logoImg.src : null;
    
    // Prepare all content elements with their heights
    const contentElements = [];
    
    // Add title section
    if (titleSection) {
      const cleaned = cleanElementForPDF(titleSection);
      const height = await measureElementHeight(cleaned);
      contentElements.push({ element: cleaned, height: height, type: 'title' });
    }
    
    // Add production info
    if (productionInfo) {
      const cleaned = cleanElementForPDF(productionInfo);
      const height = await measureElementHeight(cleaned);
      contentElements.push({ element: cleaned, height: height, type: 'productionInfo' });
    }
    
    // Add placement notes
    if (placementNotes) {
      const cleaned = cleanElementForPDF(placementNotes);
      const height = await measureElementHeight(cleaned);
      contentElements.push({ element: cleaned, height: height, type: 'placementNotes' });
    }
    
    // Add all sections
    for (const section of sections) {
      const cleaned = cleanElementForPDF(section);
      const height = await measureElementHeight(cleaned);
      contentElements.push({ element: cleaned, height: height, type: 'section' });
    }
    
    // Organize content into pages
    const pages = [];
    let currentPage = [];
    let currentPageHeight = 0;
    let isFirstPage = true;
    
    // Reserve space for logo on first page
const logoSpace = isFirstPage && logoSrc ? 56 : 0; // 56mm for logo
    let maxHeight = usableHeight - logoSpace;
    
    for (const content of contentElements) {
      // Check if adding this content would exceed page height
      if (currentPageHeight + content.height > maxHeight && currentPage.length > 0) {
        // Save current page
        pages.push(currentPage);
        
        // Start new page
        currentPage = [];
        currentPageHeight = 0;
        isFirstPage = false;
        maxHeight = usableHeight; // No logo space needed after first page
      }
      
      // Add content to current page
      currentPage.push(content);
      currentPageHeight += content.height;
    }
    
    // Add remaining content as last page
    if (currentPage.length > 0) {
      pages.push(currentPage);
    }
    
    // Render each page
    for (let pageIndex = 0; pageIndex < pages.length; pageIndex++) {
      if (pageIndex > 0) {
        pdf.addPage();
      }
      
      // Create container for this page
      const pageContainer = document.createElement('div');
      pageContainer.style.width = `${pdfWidth - 2 * margin}mm`;
      pageContainer.style.padding = `${margin}mm`;
      pageContainer.style.backgroundColor = 'white';
      pageContainer.style.position = 'relative';
      
      // Add logo to first page only
      if (pageIndex === 0 && logoSrc) {
        const logoElement = document.createElement('img');
        logoElement.src = logoSrc;
        logoElement.className = 'pdf-logo';
        logoElement.style.position = 'absolute';
        logoElement.style.top = '0';
        logoElement.style.left = '0';
     logoElement.style.width = '130.5px';
        logoElement.style.height = 'auto';
        logoElement.style.marginBottom = '10px';
        pageContainer.appendChild(logoElement);
        
        // Add spacer div to push content down
        const spacer = document.createElement('div');
      spacer.style.height = '145.5px';
        pageContainer.appendChild(spacer);
      }
      
      // Add all content for this page
      pages[pageIndex].forEach(content => {
        pageContainer.appendChild(content.element);
      });
      
      // Add to document temporarily
      document.body.appendChild(pageContainer);
      
      try {
        // Render to canvas
        const canvas = await html2canvas(pageContainer, {
          scale: 2,
          useCORS: true,
          logging: false,
          backgroundColor: '#ffffff',
          allowTaint: true,
          onclone: function(clonedDocument) {
            // Ensure logo is visible on first page
            if (pageIndex === 0) {
              const clonedLogo = clonedDocument.querySelector('.pdf-logo');
              if (clonedLogo) {
                clonedLogo.style.display = 'block';
                clonedLogo.style.visibility = 'visible';
              }
            }
            
            // In the cloned document, ensure right-column table headers are preserved
            const rightColumn = clonedDocument.querySelector('.right-column');
            if (rightColumn) {
              const table = rightColumn.querySelector('table');
              if (table) {
                // Ensure the complete header structure is preserved
                const thead = table.querySelector('thead');
                if (thead) {
                  // Make sure both header rows are visible
                  const headerRows = thead.querySelectorAll('tr');
                  headerRows.forEach((row, index) => {
                    row.style.display = 'table-row';
                    row.style.visibility = 'visible';
                    
                    const cells = row.querySelectorAll('th');
                    cells.forEach(cell => {
                      cell.style.display = 'table-cell';
                      cell.style.visibility = 'visible';
                      cell.style.textAlign = 'center';
                      cell.style.verticalAlign = 'middle';
                      cell.style.border = '1px solid #dadce0';
                      cell.style.backgroundColor = '#e8f0fe';
                      cell.style.color = '#1a73e8';
                      cell.style.fontWeight = 'bold';
                      cell.style.fontSize = '10px';
                    });
                  });
                }
                
                // Ensure all body cells are visible and centered
                const allCells = table.querySelectorAll('td');
                allCells.forEach(cell => {
                  cell.style.display = 'table-cell';
                  cell.style.visibility = 'visible';
                  cell.style.textAlign = 'center';
                  cell.style.verticalAlign = 'middle';
                });
              }
            }
            
            // Apply additional hiding for sections that need it
            const sections = clonedDocument.querySelectorAll('.section');
            sections.forEach(section => {
              const header = section.querySelector('.section-header');
              if (header) {
                const headerText = header.textContent;
                const shouldHide = ['Water - Record all products', 'Feed', 'Feed Transfer Record', 'Medications - Complete', 'Deviation Chart'].some(text => headerText.includes(text));
                
                if (shouldHide) {
                  const tables = section.querySelectorAll('table');
                  tables.forEach(table => {
                    const rows = table.querySelectorAll('tr');
                    rows.forEach(row => {
                      const cells = row.querySelectorAll('th, td');
                      if (cells.length > 0) {
                        const lastCell = cells[cells.length - 1];
                        lastCell.style.display = 'none';
                        lastCell.style.visibility = 'hidden';
                        lastCell.style.width = '0';
                        lastCell.style.padding = '0';
                        lastCell.style.margin = '0';
                        lastCell.style.border = 'none';
                        lastCell.innerHTML = '';
                      }
                    });
                  });
                }
              }
            });
          }
        });
        
        // Get canvas dimensions
        const imgData = canvas.toDataURL('image/jpeg', 1.0);
        const canvasWidth = canvas.width;
        const canvasHeight = canvas.height;
        
        // Calculate scaling
        const scale = Math.min(
          (pdfWidth - 2 * margin) / canvasWidth,
          (pdfHeight - 2 * margin) / canvasHeight
        );
        
        const scaledWidth = canvasWidth * scale;
        const scaledHeight = canvasHeight * scale;
        
        // Center on page
        const x = (pdfWidth - scaledWidth) / 2;
        const y = margin;
        
        // Add to PDF
        pdf.addImage(imgData, 'JPEG', x, y, scaledWidth, scaledHeight);
      } catch (error) {
        console.error("Error rendering page:", error);
      } finally {
        // Clean up
        document.body.removeChild(pageContainer);
      }
    }
    
    // Clean up
    document.body.classList.remove('pdf-export-mode');
    document.head.removeChild(pdfStylesheet);
    
    // Save the PDF
    pdf.save(filename);
    
    // Hide loading indicator - ensure it's hidden
    setTimeout(() => {
      hideLoading();
    }, 100);
    
    // Show success message
    showMessage('PDF generated successfully!', 'success');
    
  } catch (error) {
    console.error('Error generating PDF:', error);
    hideLoading();
    showMessage('Error generating PDF. Please try again.', 'error');
  }
}
function optimizeSectionsForPDF() {
  // Find large sections that might need to be split
  const largeSections = document.querySelectorAll('.section');
  
  largeSections.forEach(section => {
    // Check if section is too large (height > 700px as a rough estimate)
    if (section.offsetHeight > 700) {
      // Add a class that allows page breaks within this section
      section.classList.add('pdf-large-section');
      
      // Add CSS that allows breaking within tables in large sections
      const tables = section.querySelectorAll('table');
      tables.forEach(table => {
        table.classList.add('pdf-breakable-table');
      });
    }
  });
  
  // Add this CSS to your PDF stylesheet
  const additionalCSS = `
    .pdf-export-mode .pdf-large-section {
      break-inside: auto !important;
    }
    
    .pdf-export-mode .pdf-breakable-table {
      page-break-inside: auto !important;
    }
    
    .pdf-export-mode .pdf-breakable-table tr {
      page-break-inside: avoid !important;
    }
  `;
  
  return additionalCSS;
}
// Function to create and download as TXT
function createAndDownloadTXT(filename) {
  try {
    // Get all pages
    const pages = document.querySelectorAll('.page');
    let textContent = '';
    
    // Process each page
    pages.forEach((page, pageIndex) => {
      // Clone the page to avoid modifying the original
      const clonedPage = page.cloneNode(true);
      
      // Extract page title if available
      const pageTitle = clonedPage.querySelector('.page-title');
      if (pageTitle) {
        textContent += '='.repeat(40) + '\n';
        textContent += pageTitle.textContent.trim() + '\n';
        textContent += '='.repeat(40) + '\n\n';
      } else if (pageIndex > 0) {
        textContent += '\n\n' + '-'.repeat(40) + '\n\n';
      }
      
      // Process each section in the page
      const sections = clonedPage.querySelectorAll('.section');
      
      sections.forEach(section => {
        // Extract section header
        const sectionHeader = section.querySelector('.section-header');
        if (sectionHeader) {
          textContent += sectionHeader.textContent.trim() + '\n';
          textContent += '-'.repeat(sectionHeader.textContent.trim().length) + '\n\n';
        }
        
        // Process tables in the section
        const tables = section.querySelectorAll('table');
        
        tables.forEach(table => {
          // Get table headers
          const headers = Array.from(table.querySelectorAll('th')).map(th => th.textContent.trim());
          
          if (headers.length > 0) {
            // Add headers
            textContent += headers.join(' | ') + '\n';
            textContent += headers.map(h => '-'.repeat(h.length)).join('-+-') + '\n';
            
            // Get table rows
            const rows = table.querySelectorAll('tbody tr');
            
            rows.forEach(row => {
              if (row.classList.contains('note-row')) {
                // Handle note rows differently
                const noteTextarea = row.querySelector('textarea');
                if (noteTextarea && noteTextarea.value) {
                  textContent += 'Note: ' + noteTextarea.value + '\n';
                }
              } else {
                // Regular data rows
                const cells = Array.from(row.querySelectorAll('td')).map(td => {
                  // Check for inputs, textareas, and checkboxes
                  const input = td.querySelector('input[type="text"], input[type="date"], textarea');
                  const checkbox = td.querySelector('input[type="checkbox"]');
                  
                  if (input && input.value) {
                    return input.value.trim();
                  } else if (checkbox) {
                    return checkbox.checked ? '[X]' : '[ ]';
                  } else {
                    return td.textContent.trim();
                  }
                });
                
                textContent += cells.join(' | ') + '\n';
              }
            });
            
            textContent += '\n';
          }
        });
        
        // Process other input fields outside tables
        const inputs = section.querySelectorAll('input[type="text"]:not([data-processed]), textarea:not([data-processed])');
        
        inputs.forEach(input => {
          const label = input.previousElementSibling;
          if (label && label.tagName === 'LABEL') {
            textContent += label.textContent.trim() + ': ' + input.value.trim() + '\n';
          }
          
          // Mark as processed to avoid duplicates
          input.setAttribute('data-processed', 'true');
        });
        
        // Add spacing between sections
        textContent += '\n\n';
      });
      
      // Process page content outside sections
      const inputs = page.querySelectorAll('input[type="text"]:not([data-processed]), textarea:not([data-processed])');
      
      inputs.forEach(input => {
        const label = input.previousElementSibling;
        if (label && label.tagName === 'LABEL') {
          textContent += label.textContent.trim() + ': ' + input.value.trim() + '\n';
        }
        
        // Mark as processed to avoid duplicates
        input.setAttribute('data-processed', 'true');
      });
    });
    
    // Clean up - remove all data-processed attributes
    document.querySelectorAll('[data-processed]').forEach(el => {
      el.removeAttribute('data-processed');
    });
    
    // Create and download the text file
    const blob = new Blob([textContent], { type: 'text/plain' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = filename;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
    
    // Hide loading indicator
    hideLoading();
    
    // Show success message
    showMessage('Text file generated successfully!', 'success');
    
  } catch (error) {
    console.error('Error generating text file:', error);
    hideLoading();
    showMessage('Error generating text file. Please try again.', 'error');
  }
}

// Function to load required libraries
function loadLibraries(urls) {
  return Promise.all(urls.map(url => {
    return new Promise((resolve, reject) => {
      const script = document.createElement('script');
      script.src = url;
      script.onload = resolve;
      script.onerror = reject;
      document.head.appendChild(script);
    });
  }));
}

// Function to show toast message
function showMessage(message, type = 'info') {
  const toast = document.createElement('div');
  toast.style.cssText = `
    position: fixed;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    padding: 12px 24px;
    border-radius: 4px;
    font-size: 14px;
    font-weight: 500;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    z-index: 10000;
    animation: fadeIn 0.3s, fadeOut 0.3s 2.7s;
  `;
  
  // Set styles based on message type
  if (type === 'success') {
    toast.style.backgroundColor = '#e6f4ea';
    toast.style.color = '#137333';
    toast.style.border = '1px solid #34a853';
  } else if (type === 'error') {
    toast.style.backgroundColor = '#fce8e6';
    toast.style.color = '#c5221f';
    toast.style.border = '1px solid #ea4335';
  } else {
    toast.style.backgroundColor = '#e8f0fe';
    toast.style.color = '#1a73e8';
    toast.style.border = '1px solid #4285f4';
  }
  
  toast.innerHTML = `
    ${message}
    <style>
      @keyframes fadeIn {
        from { opacity: 0; transform: translate(-50%, 20px); }
        to { opacity: 1; transform: translate(-50%, 0); }
      }
      @keyframes fadeOut {
        from { opacity: 1; transform: translate(-50%, 0); }
        to { opacity: 0; transform: translate(-50%, 20px); }
      }
    </style>
  `;
  
  document.body.appendChild(toast);
  
  // Remove toast after animation
  setTimeout(() => {
    if (document.body.contains(toast)) {
      document.body.removeChild(toast);
    }
  }, 3000);
}

// Attach the function to the Print as PDF button
function attachExportButtons() {
  // Desktop button
  const printButton = document.getElementById('printPDFButton');
  if (printButton) {
    printButton.addEventListener('click', function() {
      exportDocument();
    });
  }
  
  // Mobile button
  const mobilePrintButton = document.getElementById('mobilePrintButton');
  if (mobilePrintButton) {
    mobilePrintButton.addEventListener('click', function() {
      exportDocument();
    });
  }
}

// Initialize when DOM is loaded
if (document.readyState === 'loading') {
  document.addEventListener('DOMContentLoaded', attachExportButtons);
} else {
  attachExportButtons();
}

// Make function globally accessible
window.exportDocument = exportDocument;

// Initialize navigation when DOM is loaded
document.addEventListener('DOMContentLoaded', function() {
    const navigation = new HeaderNavigation();
    
    // Prevent PDF download on mobile header click
    const mobileToggle = document.getElementById('mobileMenuToggle');
    if (mobileToggle) {
        mobileToggle.addEventListener('click', function(e) {
            e.preventDefault();
            e.stopPropagation();
            e.stopImmediatePropagation();
            
            // Only toggle menu, don't trigger any other actions
            navigation.toggleMobileMenu();
            return false;
        });
    }
    
    // Check connection status periodically
    setInterval(() => {
        navigation.updateConnectionStatus(navigator.onLine);
    }, 5000);
    
    // Handle online/offline events
    window.addEventListener('online', () => {
        navigation.updateConnectionStatus(true);
        navigation.showStatusMessage('Connection restored', 'success');
    });
    
    window.addEventListener('offline', () => {
        navigation.updateConnectionStatus(false);
        navigation.showStatusMessage('Connection lost', 'error');
    });
});

        // Smooth scroll behavior for anchor links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        // Add keyboard navigation support
        document.addEventListener('keydown', function(e) {
            // ESC key closes mobile menu
            if (e.key === 'Escape') {
                const mobileMenu = document.getElementById('mobileNavMenu');
                const mobileToggle = document.getElementById('mobileMenuToggle');
                if (mobileMenu && mobileMenu.classList.contains('active')) {
                    mobileToggle.click();
                }
            }
            
            // Alt + M opens mobile menu on mobile devices
            if (e.altKey && e.key === 'm' && window.innerWidth <= 768) {
                const mobileToggle = document.getElementById('mobileMenuToggle');
                if (mobileToggle) {
                    mobileToggle.click();
                }
            }
        });
        
        // Add this function at the end of your script
function attachPrintButton() {
  const printButton = document.getElementById('printPDFButton');
  if (printButton) {
    printButton.addEventListener('click', function() {
      exportDocument();
    });
  }
  
  const mobilePrintButton = document.getElementById('mobilePrintButton');
  if (mobilePrintButton) {
    mobilePrintButton.addEventListener('click', function() {
      exportDocument();
    });
  }
}

// Function to convert inputs to textareas in a specific container
function convertInputsInContainer(container) {
  const textInputs = container.querySelectorAll('input[type="text"]:not(.signature-input)');
  
  textInputs.forEach(input => {
    const textarea = document.createElement('textarea');
    
    // Copy all attributes
    Array.from(input.attributes).forEach(attr => {
      textarea.setAttribute(attr.name, attr.value);
    });
    
    // Set textarea-specific properties
    textarea.value = input.value;
    textarea.style.minHeight = '25px';
    textarea.style.resize = 'vertical';
    textarea.style.overflow = 'auto';
    textarea.rows = 1;
    
    // Replace input with textarea
    input.parentNode.replaceChild(textarea, input);
  });
}

// Convert all text inputs to textareas
function convertAllInputsToTextareas() {
  convertInputsInContainer(document.body);
}

// Override appendChild to automatically convert inputs
const originalAppendChild = Element.prototype.appendChild;
Element.prototype.appendChild = function(child) {
  const result = originalAppendChild.call(this, child);
  
  // If we're adding a table row or similar element, convert its inputs
  if (child && (child.tagName === 'TR' || child.tagName === 'DIV')) {
    setTimeout(() => {
      convertInputsInContainer(child);
    }, 10);
  }
  
  return result;
};

// Run after DOM loads
document.addEventListener('DOMContentLoaded', function() {
  setTimeout(convertAllInputsToTextareas, 100);
});

// Also run after loading form data
const originalLoadFormData = loadFormData;
loadFormData = async function() {
  await originalLoadFormData();
  setTimeout(convertAllInputsToTextareas, 500);
};

    </script>
</body>
</html>

<body>
    
<div class="main-content">
            <div class="title-section">
                <div class="main-title">Raised by a Canadian Farmer</div>
                <div class="subtitle">On-Farm Food Safety Program (2021) and<br>Animal Care Program (2018) Flock-Specific Records</div>
            </div>

        <div class="production-info">
            <div class="left-column">
                <div style="font-weight: bold; margin-bottom: 15px;">Production Information</div>
                <div class="info-row">
                    <span class="info-label">Farm:</span>
                    <span class="info-label">Vassilaokos Farm Inc.</span>
                </div>
<div class="info-row">
    <span class="info-label">Quota Period:</span>
    <span class="info-value-no-underline" id="quotaPeriodDisplay">Loading...</span>
</div>
                <div class="info-row">
                    <span class="info-label">Barn #:</span>
                     <span class="info-label">1</span>
                </div>
                <div class="info-row">
                    <span class="info-label">Floor #:</span>
                 <span class="info-label">1 and 2</span>
                </div>
         <div class="info-row">
    <span class="info-label">Placement Date:</span>
    <span class="info-value-no-underline" id="placementDateDisplay">Loading...</span>
</div>
                <div class="info-row">
                    <span class="info-label">Name of farm representative:</span>
                 <input type="text" class="info-value" placeholder="Chris Rose">
                </div>
            </div>
            
            <div class="right-column">
                <div style="font-weight: bold; margin-bottom: 15px;">Chick Quality Assessment</div>
                <table style="margin-bottom: 0;" class="table-header-dark">
                    <thead>
                        <tr>
                            <th rowspan="2">Quality Assessment</th>
                            <th colspan="2">Upon Receipt of Chicks</th>
                            <th colspan="2">3-4 Day-old Chicks</th>
                        </tr>
                        <tr>
                            <th>Acceptable</th>
                            <th>Not Acceptable</th>
                            <th>Acceptable</th>
                            <th>Not Acceptable</th>
                        </tr>
                    </thead>
           <tbody>
    <tr>
        <td>Alertness</td>
        <td style="text-align: center;"><input type="checkbox"></td>
        <td style="text-align: center;"><input type="checkbox"></td>
        <td style="text-align: center;"><input type="checkbox"></td>
        <td style="text-align: center;"><input type="checkbox"></td>
    </tr>
    <tr>
        <td>Vigour</td>
        <td style="text-align: center;"><input type="checkbox"></td>
        <td style="text-align: center;"><input type="checkbox"></td>
        <td style="text-align: center;"><input type="checkbox"></td>
        <td style="text-align: center;"><input type="checkbox"></td>
    </tr>
    <tr>
        <td>Condition</td>
        <td style="text-align: center;"><input type="checkbox"></td>
        <td style="text-align: center;"><input type="checkbox"></td>
        <td style="text-align: center;"><input type="checkbox"></td>
        <td style="text-align: center;"><input type="checkbox"></td>
    </tr>
    <tr>
        <td>Normality</td>
        <td style="text-align: center;"><input type="checkbox"></td>
        <td style="text-align: center;"><input type="checkbox"></td>
        <td style="text-align: center;"><input type="checkbox"></td>
        <td style="text-align: center;"><input type="checkbox"></td>
    </tr>
</tbody>

    

                    </tbody>
                </table>
            </div>
        </div>
 <div style="margin: 20px 0;">
            <label>Placement notes:</label>
            <textarea class="full-width" placeholder="Additional comments or notes"></textarea>
        </div>
        <!-- Water Section -->
        <div class="section">
            <div class="section-header">
                Water - Record all products (e.g. for cleaning, acidification/pH, probiotics, etc.) used in the water. For cleaning products, record the verification results (at least twice during the grow-out)
            </div>
            <div class="section-content">
                <table class="table-header-dark">
                    <thead>
                        <tr>
                            <th>Product Name</th>
                            <th>Date(s) Used</th>
                            <th colspan="2">Chemical Concentration Verification</th>
                            <th style="width: 100px;"></th>
                        </tr>
                        <tr>
                            <th></th>
                            <th></th>
                            <th>Date</th>
                            <th>Results (e.g. ppm, pH)</th>
                            <th></th>
                        </tr>
                    </thead>
                  <tbody>
    <tr>
        <td><input type="text" class="table-input" placeholder="Product name"></td>
        <td><input type="date" class="table-input"></td>
   <td><input type="date" class="table-input"></td>
        <td><input type="text" class="table-input" placeholder="Results"></td>
 <td style="text-align: center;">
    <!-- No delete button for first row -->
</td>
    </tr>
</tbody>
           </table>
                <div style="margin-top: 10px; text-align: center;">
                   <button type="button" id="addWaterEntryButton" style="background-color: #1a73e8; color: white; padding: 10px 20px; font-size: 14px; border: none; border-radius: 8px; cursor: pointer; box-shadow: 0 2px 4px rgba(0,0,0,0.2); transition: all 0.2s ease; font-weight: 500; letter-spacing: 0.3px;">
    Add Entry
</button>
                </div>
            </div>
        </div>

  <!-- Feed Section -->
        <div class="section">
            <div class="section-header">Feed</div>
            <div class="section-content">
                <div class="note">
                    Each load of feed is visually inspected and the bill checked for medications and kept in the producer's file: 
<input type="text" class="signature-input" placeholder="Chris Rose" id="feedSignature">
              
                </div>
                
               <table class="table-header-dark">
    <thead>
        <tr>
            <th>Record the date that control measures were used when switching from a medicated feed with a withdrawal period to feed without a withdrawal period*</th>
            <th>Record the type and amount of ingredients (e.g. wheat) added to finished feeds</th>
            <th>Record the dates of feed samples (if required)</th>
            <th style="width: 50px;"></th>
        </tr>
    </thead>
   <tbody>
    <tr style="background-color: #f5f5f5; border-top: 2px solid #333;">
        <td><input type="date" class="table-input"></td>
        <td><textarea class="table-input" placeholder="Enter ingredients"></textarea></td>
        <td><input type="date" class="table-input"></td>
        <td style="text-align: center;">
            <!-- No delete button for first row -->
        </td>
    </tr>
   <tr class="note-row" style="background-color: #f9f9f9; border-bottom: 2px solid #333;">
    <td colspan="4">
        <div style="padding: 5px;">
            <label style="font-weight: bold; font-size: 10px;">Notes:</label>
            <textarea class="entry-note-input" placeholder="Notes for this entry..." style="width: 100%; min-height: 40px; max-height: 120px; resize: vertical; margin-top: 3px; padding: 4px; font-size: 10px; border: 1px solid #ccc;"></textarea>
        </div>
    </td>
</tr>
</tbody>
</table>
                               <div style="margin-top: 10px; text-align: center;">
   <button type="button" id="addFeedEntryButton" style="background-color: #1a73e8; color: white; padding: 10px 20px; font-size: 14px; border: none; border-radius: 8px; cursor: pointer; box-shadow: 0 2px 4px rgba(0,0,0,0.2); transition: all 0.2s ease; font-weight: 500; letter-spacing: 0.3px;">
    Add Entry
</button>
</div>



                <div class="note">
                    * For single bin systems record the date when the sides of the bin were knocked down to prevent feed hang-ups; for double bin systems record the date when the switch to the feed bin without a withdrawal period occurred.
                </div>
            </div>
        </div>

        <!-- Feed Transfer Record Section -->
        <div class="section">
            <div class="section-header">Feed Transfer Record</div>
            <div class="section-content">
                <table class="table-header-dark">
                    <thead>
                        <tr>
                   <table class="table-header-dark">
    <thead>
        <tr>
            <th>Date feed moved</th>
            <th>Original farm name and bin #</th>
            <th>Destination farm name and bin #</th>
            <th>List any medications with withdrawal periods used in the flock</th>
            <th>Method of transport</th>
            <th>Sample taken</th>
            <th>Cross-contamination prevention measures used at the original bin</th>
            <th style="width: 50px;"></th>
        </tr>
    </thead>
   <tbody>
    <tr style="background-color: #f5f5f5; border-top: 2px solid #333;">
        <td><input type="date" class="table-input"></td>
        <td><input type="text" class="table-input" placeholder="Farm/bin"></td>
        <td><input type="text" class="table-input" placeholder="Farm/bin"></td>
        <td><textarea class="table-input" placeholder="Medications"></textarea></td>
        <td><input type="text" class="table-input" placeholder="Truck"></td>
        <td>
            <select class="table-input">
                <option value="Yes" selected>Yes</option>
                <option value="No">No</option>
            </select>
        </td>
        <td><input type="text" class="table-input" placeholder="Yes" value="Yes"></td>
        <td style="text-align: center;">
            <!-- No delete button for first row -->
        </td>
    </tr>
   <tr class="note-row" style="background-color: #f9f9f9; border-bottom: 2px solid #333;">
    <td colspan="8">
        <div style="padding: 5px;">
            <label style="font-weight: bold; font-size: 10px;">Notes:</label>
            <textarea class="entry-note-input" placeholder="Notes for this entry..." style="width: 100%; min-height: 40px; max-height: 120px; resize: vertical; margin-top: 3px; padding: 4px; font-size: 10px; border: 1px solid #ccc;"></textarea>
        </div>
    </td>
</tr>
</tbody>
</table>
                <div style="margin-top: 10px; text-align: center;">
               <button type="button" id="addFeedTransferEntryButton" style="background-color: #1a73e8; color: white; padding: 10px 20px; font-size: 14px; border: none; border-radius: 8px; cursor: pointer; box-shadow: 0 2px 4px rgba(0,0,0,0.2); transition: all 0.2s ease; font-weight: 500; letter-spacing: 0.3px;">
    Add Entry
</button>
                </div>
    </div>
        </div>

    <!-- PAGE 2: Barn Preparation Checklist -->
    <div class="page">
        <div class="page-title">Barn Preparation Checklist</div>

        <!-- Barn Cleaning Section -->
        <div class="section">
            <div class="section-content">
                <table class="table-header-dark">
                    <thead>
                        <tr>
                            <th class="task-description">BARN CLEANING</th>
                            <th class="date-column">DATE(S) COMPLETED</th>
                            <th class="product-column">RECORD THE PRODUCT NAME AND/OR A DESCRIPTION OF THE PROCEDURE</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Remove litter/manure from barn *If using Option #3 - time since shipment of last flock:</td>
                            <td><input type="date" class="table-input"></td>
                            <td><input type="text" class="table-input" placeholder="Location/procedure"></td>
                        </tr>
                        <tr>
                            <td>Dry-clean (i.e. blow down/brushing) barn, entranceway and equipment (feeders/drinkers/fans/floor/walls/barn footwear/ catching equipment etc.)</td>
                            <td><input type="date" class="table-input"></td>
                            <td><input type="text" class="table-input" placeholder="Service/procedure"></td>
                        </tr>
                        <tr>
                            <td>Mortality buckets/pails are washed with water and detergent and/or disinfectant</td>
                            <td><input type="date" class="table-input"></td>
                            <td><input type="text" class="table-input" placeholder="Prevail Disinfectant"></td>
                        </tr>
                        <tr>
                            <td>Barn and equipment (as per the above dry-clean list) is pressure washed with water</td>
                            <td><input type="date" class="table-input"></td>
                            <td><input type="text" class="table-input" placeholder="Service/product"></td>
                        </tr>
                        <tr>
                            <td>Option 1: <input type="checkbox" id="option1_detergent"> Detergent and/or <input type="checkbox" id="option1_disinfectant"> disinfectant/fumigation used in the barn and on the equipment</td>
                            <td><input type="date" class="table-input"></td>
                            <td><input type="text" class="table-input" placeholder="Prevail Disinfectant"></td>
                        </tr>
                      <tr>
<td>Option 2: <input type="checkbox" id="option2_detergent"> Detergent and/or <input type="checkbox" id="option2_disinfectant"> disinfectant/fumigation used on the equipment</td>
<td><input type="date" class="table-input"></td>
<td><input type="text" class="table-input" placeholder="N/A"></td>
</tr>
<tr>
            <td>Equipment used during clean-out is cleaned</td>
            <td><input type="date" class="table-input"></td>
          <td><input type="text" class="table-input" placeholder="See Linde Poultry Service"></td>
        </tr>
                        <tr>
                            <td>Flush, clean and/or disinfect water lines (open drinkers disinfected if applicable)</td>
                            <td><input type="date" class="table-input"></td>
                            <td>
                                <div class="checkbox-container">
                                    <input type="checkbox" id="flush">
                                    <label for="flush">Flush</label>
                                </div>
                                <input type="text" class="table-input" placeholder="Product name" style="margin-top: 5px;">
                            </td>
                        </tr>
                        <tr>
                            <td>Inspect inside and outside of feed bin and clean if needed (min. 1/year)</td>
                            <td><input type="date" class="table-input"></td>
                            <td><textarea class="table-input" placeholder="Description"></textarea></td>
                        </tr>
                        <tr>
                            <td>Downtime: Indicate the number of days from when the flock was shipped to the placement of chicks</td>
                            <td colspan="2" style="text-align: center;"><input type="number" class="small-input" placeholder="Days" min="0"></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Facilities Preparation Section -->
        <div class="section">
            <div class="section-content">
                <table class="table-header-dark">
                    <thead>
                        <tr>
                            <th class="task-description">Facilities Preparation</th>
                            <th class="date-column">Date(s)</th>
                            <th class="product-column">Description/Results</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Water system checked (including filters or UV bulbs)</td>
                            <td><input type="date" class="table-input"></td>
                            <td><input type="text" class="table-input" placeholder="Dates of filters/bulbs changed"></td>
                        </tr>
                        <tr>
                            <td>Heating system checked</td>
                            <td><input type="date" class="table-input"></td>
                            <td><input type="text" class="table-input" placeholder="Status"></td>
                        </tr>
                        <tr>
                            <td>Stand-by generator checked</td>
                            <td><input type="date" class="table-input"></td>
                            <td><input type="text" class="table-input" placeholder="Test results"></td>
                        </tr>
                        <tr>
                            <td>Monitoring system checked</td>
                            <td><input type="date" class="table-input"></td>
                            <td><input type="text" class="table-input" placeholder="Test results"></td>
                        </tr>
                        <tr>
                            <td>Ventilation system checked</td>
                            <td><input type="date" class="table-input"></td>
                            <td><input type="text" class="table-input" placeholder="Status"></td>
                        </tr>
                        <tr>
                            <td>Light system checked</td>
                            <td><input type="date" class="table-input"></td>
                            <td><input type="text" class="table-input" placeholder="Status"></td>
                        </tr>
                        <tr>
                            <td>Drinkers and feeders checked individually</td>
                            <td><input type="date" class="table-input"></td>
                            <td><input type="text" class="table-input" placeholder="Status"></td>
                        </tr>
                        <tr>
                            <td>Bedding material (checked for mold/feathers/droppings/sharp edges or harmful compounds at placement)</td>
                            <td><input type="date" class="table-input"></td>
                            <td><input type="text" class="table-input" placeholder="Condition and type"></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Pest Control Section -->
        <div class="section">
            <div class="section-content">
                <table class="table-header-dark">
                    <thead>
                        <tr>
                            <th class="task-description">Pest Control - Describe the pest control methods used</th>
                            <th class="date-column">Date(s)</th>
                            <th class="product-column">Description/Product</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Describe any barn repairs</td>
                            <td><input type="date" class="table-input"></td>
                            <td><textarea class="table-input" placeholder="Description of repairs"></textarea></td>
                        </tr>
                        <tr>
                            <td>Vegetation cut around building(s)</td>
                            <td><input type="date" class="table-input"></td>
                            <td><input type="text" class="table-input" placeholder="Status"></td>
                        </tr>
                        <tr>
                            <td>CAZ kept maintained</td>
                            <td><input type="date" class="table-input"></td>
                            <td><input type="text" class="table-input" placeholder="Status"></td>
                        </tr>
                        <tr>
                            <td>Rodent controls used</td>
                            <td><input type="date" class="table-input"></td>
                            <td><input type="text" class="table-input" placeholder="Product/method"></td>
                        </tr>
                        <tr>
                            <td>Wild bird controls used</td>
                            <td><input type="date" class="table-input"></td>
                            <td><input type="text" class="table-input" placeholder="Product/method"></td>
                        </tr>
                        <tr>
                            <td>Fly controls used</td>
                            <td><input type="date" class="table-input"></td>
                            <td><input type="text" class="table-input" placeholder="Product"></td>
                        </tr>
                        <tr>
                            <td>Insecticides (e.g. for darkling beetles) used</td>
                            <td><input type="date" class="table-input"></td>
                            <td><input type="text" class="table-input" placeholder="Product"></td>
                        </tr>
                        <tr>
                            <td>Other pests (names) and controls used</td>
                            <td><input type="date" class="table-input"></td>
                            <td><input type="text" class="table-input" placeholder="Controls"></td>
                        </tr>
                        <tr>
                            <td>No pets in the RA (✓)</td>
                            <td><input type="date" class="table-input"></td>
                            <td><input type="text" class="signature-input" placeholder="Signature"></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

     
    <!-- PAGE 1: Medications & Daily Checks -->
    <div class="page">
        <div class="header-info">
            <span>Flock Information</span>
        </div>

      <!-- Medications Section -->
       <div class="section">
           <div class="section-header">
               Medications - Complete the following table for all medications administered through feed or water
           </div>
           <div class="section-content">
               <table>
                   <thead>
                       <tr>
                           <th>Name of Medications</th>
                           <th>Route of Administration</th>
                           <th colspan="3">Water Medicator Tested</th>
                           <th>Record any control measures used in the last 2 weeks of grow-out*</th>
                           <th style="width: 50px;"></th>
                       </tr>
                       <tr>
                           <th></th>
                           <th></th>
                           <th>Date</th>
                           <th>Results</th>
                           <th>Corrective Actions (if any)</th>
                           <th></th>
                           <th></th>
                       </tr>
                   </thead>
                   <tbody>
                       <tr>
                           <td><input type="text" class="table-input" placeholder="Medication name"></td>
                           <td>
                               <div class="checkbox-container">
                                   <input type="checkbox" id="feed1">
                                   <label for="feed1">feed</label>
                               </div>
                             <div class="checkbox-container">
                                   <input type="checkbox" id="water1">
                                   <label for="water1">water</label>
                               </div>
                           </td>
                           <td><input type="date" class="table-input"></td>
                         <td><input type="date" class="table-input"></td>
                           <td><input type="text" class="table-input" placeholder="Actions"></td>
                           <td><input type="text" class="table-input" placeholder="Control measures"></td>
                           <td style="text-align: center;">
                               <!-- No delete button for first row -->
                           </td>
                       </tr>
                   </tbody>
               </table>
               <div style="margin-top: 10px; text-align: center;">
               <button type="button" id="addMedicationEntryButton" style="background-color: #1a73e8; color: white; padding: 10px 20px; font-size: 14px; border: none; border-radius: 8px; cursor: pointer; box-shadow: 0 2px 4px rgba(0,0,0,0.2); transition: all 0.2s ease; font-weight: 500; letter-spacing: 0.3px;">
    Add Entry
</button>
               </div>
               <div class="note">
                   *For medication with a withdrawal period used in the last 14 days. Record the date feed was minimized or the water lines flushed.
               </div>
           </div>
       </div>
        <!-- Deviation Chart Section -->
        <div class="section">
            <div class="section-header">
                Deviation Chart
            </div>
            <div class="section-content">
                <p>Complete this table when a deviation from <u>any</u> Standard Operating Procedures occurs including:</p>
                <div style="display: flex; flex-wrap: wrap; gap: 20px; margin: 10px 0;">
                    <div class="checkbox-container">
                        <input type="checkbox" id="temp">
                        <label for="temp">Temperature levels</label>
                    </div>
                    <div class="checkbox-container">
                        <input type="checkbox" id="lighting">
                        <label for="lighting">Lighting program</label>
                    </div>
                    <div class="checkbox-container">
                        <input type="checkbox" id="humidity">
                        <label for="humidity">Humidity or ammonia levels</label>
                    </div>
                    <div class="checkbox-container">
                        <input type="checkbox" id="mortality">
                        <label for="mortality">High mortality</label>
                    </div>
                    <div class="checkbox-container">
                        <input type="checkbox" id="bedding">
                        <label for="bedding">Bedding quality</label>
                    </div>
                    <div class="checkbox-container">
                        <input type="checkbox" id="medication">
                        <label for="medication">Medication administered through feed or water</label>
                    </div>
                    <div class="checkbox-container">
                        <input type="checkbox" id="alarms">
                        <label for="alarms">Alarms</label>
                    </div>
                </div>
                <p><strong>Deviations only need to be recorded if they exceed upper or lower limits outlined in SOP.</strong></p>
                
                <table>
                    <thead>
                      <tr>
                            <th>Date</th>
                            <th>Description of the Deviation</th>
                            <th>Reason for the Deviation</th>
                            <th>Actions taken to Correct the Deviation</th>
                            <th style="width: 50px;"></th>
                        </tr>
                    </thead>
                    <tbody>
                      
                        <tr>
                            <td><input type="date" class="table-input"></td>
                            <td><textarea class="table-input" placeholder="Describe deviation"></textarea></td>
                            <td><textarea class="table-input" placeholder="Reason for deviation"></textarea></td>
                    <td><textarea class="table-input" placeholder="Corrective actions"></textarea></td>
                            <td style="text-align: center;">
                                <!-- No delete button for first row -->
                            </td>
                        </tr>
                    </tbody>
             </table>
                <div style="margin-top: 10px; text-align: center;">
                <button type="button" id="addDeviationEntryButton" style="background-color: #1a73e8; color: white; padding: 10px 20px; font-size: 14px; border: none; border-radius: 8px; cursor: pointer; box-shadow: 0 2px 4px rgba(0,0,0,0.2); transition: all 0.2s ease; font-weight: 500; letter-spacing: 0.3px;">
    Add Entry
</button>
                </div>
            </div>
        </div>
        
<!-- Daily Checks Section -->
<div class="section">
    <div class="section-header">Daily Checks</div>
    <div class="section-content">
        <p>I confirm that the information on these Flock Specific records is accurate and that the following food safety and animal care checks have been performed on a daily basis (any deviations from SOP's are to be recorded in the Deviation Chart):</p>
        
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin: 15px 0;">
            <div class="checkbox-container">
                <input type="checkbox" id="feedquality">
                <label for="feedquality">Feed quality and availability</label>
            </div>
            <div class="checkbox-container">
                <input type="checkbox" id="thermal">
                <label for="thermal">Thermal comfort of the flock</label>
            </div>
            <div class="checkbox-container">
                <input type="checkbox" id="templevels">
                <label for="templevels">Temperature levels</label>
            </div>
            <div class="checkbox-container">
                <input type="checkbox" id="humiditylevels">
                <label for="humiditylevels">Humidity levels</label>
            </div>
            <div class="checkbox-container">
                <input type="checkbox" id="wateravail">
                <label for="wateravail">Water availability (quality – cloudiness and discoloration – checked weekly)</label>
            </div>
            <div class="checkbox-container">
                <input type="checkbox" id="flockhealth">
                <label for="flockhealth">Flock Health</label>
            </div>
            <div class="checkbox-container">
                <input type="checkbox" id="ventilation">
                <label for="ventilation">Ventilation system</laalevels</label>
            </div>
            <div class="checkbox-container">
                <input type="checkbox" id="waterquality">
                <label for="waterquality">Water quality (mold and slime) for open drinkers</label>
            </div>
            <div class="checkbox-container">
                <input type="checkbox" id="heatingsystem">
                <label for="heatingsystem">Heating system</label>
            </div>
            <div class="checkbox-container">
                <input type="checkbox" id="lightingsystem">
                <label for="lightingsystem">Lighting system</label>
            </div>
            <div class="checkbox-container">
                <input type="checkbox" id="litterquality">
                <label for="litterquality">Litter quality</label>
            </div>
            <div class="checkbox-container">
                <input type="checkbox" id="birdsinspected">
                <label for="birdsinspected">Birds inspected minimum twice daily</label>
            </div>
        </div>

        <div style="margin: 20px 0;">
            <label>Additional notes:</label>
            <textarea class="full-width" placeholder="Additional comments or notes"></textarea>
        </div>
<div class="signature-section">
    <div class="form-row">
        <label>Signature:</label>
      <img src="/dad signaiture.jpg" alt="Signature" style="height: 40px; width: auto; margin-left: 10px; vertical-align: middle;">
    </div>
    <div class="form-row">
        <label>Date:</label>
        <input type="date" class="medium-input">
    </div>
</div>
    </div>
</div>
  </div>
</div> <!-- Close main-content div -->

</body>
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/11.3.1/firebase-app.js";
import { getFirestore, collection, addDoc, getDocs, deleteDoc, doc, getDoc, query, where, onSnapshot, setDoc } 
from "https://www.gstatic.com/firebasejs/11.3.1/firebase-firestore.js";

// ✅ Initialize Firebase
const firebaseConfig = {
   apiKey: "AIzaSyB20OmcQemfIXm4712im9mqiBnpeVt8sJQ",
   authDomain: "chicken-project-2.firebaseapp.com",
   projectId: "chicken-project-2",
   storageBucket: "chicken-project-2.firebasestorage.app",
   messagingSenderId: "596273529964",
   appId: "1:596273529964:web:bd51e2646d5ed48afa4449",
   measurementId: "G-9YLPHR08DB"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

// ✅ Attach Firebase functions to window for non-module scripts
window.db = db;
window.collection = collection;
window.addDoc = addDoc;
window.getDocs = getDocs;
window.deleteDoc = deleteDoc;
window.doc = doc;
window.getDoc = getDoc;
window.query = query;
window.where = where;
window.onSnapshot = onSnapshot;
window.setDoc = setDoc;

// ✅ Function to setup Firebase listener for flock log
function setupFlockLogListener() {
   console.log("📥 Setting up Flock Log Firebase listener...");
   
   const quotaPeriodDisplay = document.getElementById('quotaPeriodDisplay');
   const placementDateDisplay = document.getElementById('placementDateDisplay');
   
   // Set initial loading text
   if (quotaPeriodDisplay) {
       quotaPeriodDisplay.textContent = 'Loading from database...';
   }

   if (placementDateDisplay) {
       placementDateDisplay.textContent = 'Loading...';
   }

   // Listen for real-time updates from the startnewcrop collection
   const docRef = doc(db, 'startnewcrop', 'vas-b1-snc');
   
   onSnapshot(docRef, (docSnapshot) => {
       if (docSnapshot.exists()) {
           const data = docSnapshot.data();
           console.log("📄 Flock data received:", data);
           console.log("📋 Available fields:", Object.keys(data));
           console.log("🔍 quota_period value:", data.quota_period);
           console.log("🔍 date_started value:", data.date_started);
           
           // Update quota period
           if (quotaPeriodDisplay) {
               if (data.quota_period) {
                   quotaPeriodDisplay.textContent = data.quota_period;
                   console.log("✅ Quota period updated to:", data.quota_period);
               } else {
                   quotaPeriodDisplay.textContent = 'No quota period found';
                   console.log("❌ No quota_period field found");
               }
           }

           // Update placement date  
           if (placementDateDisplay) {
               if (data.date_started) {
                   let dateValue;
                   if (data.date_started.toDate) {
                       dateValue = data.date_started.toDate().toLocaleDateString();
                   } else if (data.date_started.seconds) {
                       dateValue = new Date(data.date_started.seconds * 1000).toLocaleDateString();
                   } else {
                       dateValue = data.date_started;
                   }
                   placementDateDisplay.textContent = dateValue;
                   console.log("✅ Placement date updated to:", dateValue);
               } else {
                   placementDateDisplay.textContent = 'No date found';
                   console.log("❌ No date_started field found");
               }
           }
       } else {
           console.error("❌ Document does not exist in startnewcrop collection!");
           if (quotaPeriodDisplay) {
               quotaPeriodDisplay.textContent = 'No data found';
           }
       }
   }, (error) => {
       console.error('❌ Error fetching flock data:', error);
       if (quotaPeriodDisplay) {
           quotaPeriodDisplay.textContent = 'Error loading data';
       }
   });
}

// Function to save form data to Firestore
async function saveFormData() {
   console.log("💾 Saving form data...");
   
   const saveButton = document.getElementById('saveFormButton');
   const saveStatus = document.getElementById('saveStatus');
   
   // Check if we're on mobile - if so, don't change button text
   const isMobile = window.innerWidth <= 768;
   
   // Disable button and show loading
   saveButton.disabled = true;
   if (!isMobile) {
       saveButton.textContent = '⏳ Saving...';
   }
   saveStatus.textContent = 'Saving data to database...';
   saveStatus.style.color = 'blue';
   
   try {
       const docRef = doc(db, 'vas-b1-fl', 'vas-b1-f1');
       
       // Get all form inputs with detailed logging
       console.log("🔍 Finding form elements...");
       
       // Production info
     const farmRepInput = document.querySelector('input[placeholder="Chris Rose"]');
       const placementNotesTextarea = document.querySelector('textarea[placeholder="Additional comments or notes"]');
       console.log("Farm rep input:", farmRepInput?.value);
       console.log("Placement notes:", placementNotesTextarea?.value);
       
       // Chick Quality - get the table and log what we find
       const chickTable = document.querySelector('.table-header-dark');
       console.log("Chick table found:", !!chickTable);
       
       const allCheckboxes = document.querySelectorAll('input[type="checkbox"]');
       console.log("Total checkboxes found:", allCheckboxes.length);
       
       // Get chick quality data by finding the specific table
       function getChickQualityData() {
           const chickQuality = {
               upon_receipt: { alertness: {}, vigour: {}, condition: {}, normality: {} },
               three_four_days: { alertness: {}, vigour: {}, condition: {}, normality: {} }
           };
           
           // Find the chick quality table rows
      const chickTable = document.querySelector('.table-header-dark');
if (!chickTable) {
    console.log("❌ Chick table not found");
    return chickQuality;
}

const tableRows = chickTable.querySelectorAll('tbody tr');
console.log("🔍 Chick table structure:", chickTable);
console.log("🔍 Found tbody:", !!chickTable.querySelector('tbody'));
           console.log("Chick quality table rows found:", tableRows.length);
           
        tableRows.forEach((row, index) => {
    const rowCheckboxes = row.querySelectorAll('input[type="checkbox"]');
    console.log(`Row ${index}:`, row.textContent.trim());
    console.log(`Row ${index} checkboxes:`, rowCheckboxes.length);
    
    if (rowCheckboxes.length >= 4 && index < 4) {
        const qualities = ['alertness', 'vigour', 'condition', 'normality'];
        const quality = qualities[index];
        
        console.log(`Processing ${quality} row...`);
        console.log(`Checkbox states: [${rowCheckboxes[0].checked}, ${rowCheckboxes[1].checked}, ${rowCheckboxes[2].checked}, ${rowCheckboxes[3].checked}]`);
        
        chickQuality.upon_receipt[quality] = {
            acceptable: rowCheckboxes[0].checked,
            not_acceptable: rowCheckboxes[1].checked
        };
        chickQuality.three_four_days[quality] = {
            acceptable: rowCheckboxes[2].checked,
            not_acceptable: rowCheckboxes[3].checked
        };
    }
});

console.log("🐣 Final chick quality data:", chickQuality);
           
           return chickQuality;
       }
       
       function getBarnCleaningData() {
    console.log("🧹 Collecting barn cleaning data...");
    
    // Find the barn cleaning section
    const allSections = document.querySelectorAll('.section');
    let barnCleaningSection = null;
    
    allSections.forEach(section => {
        const table = section.querySelector('.table-header-dark');
        if (table && table.textContent.includes('BARN CLEANING')) {
            barnCleaningSection = section;
        }
    });
    
    if (!barnCleaningSection) {
        console.log("❌ Barn cleaning section not found");
        return {};
    }
    
    const barnCleaningData = {};
    const tableRows = barnCleaningSection.querySelectorAll('.table-header-dark tbody tr');
    
    console.log("Barn cleaning table rows found:", tableRows.length);
    
    // Define the task identifiers for each row
    const taskIds = [
        'remove_litter_manure',
        'dry_clean_barn',
        'mortality_buckets_wash',
        'pressure_wash_barn',
        'option1_detergent_disinfectant',
        'option2_detergent_disinfectant', 
        'equipment_cleanout',
        'flush_water_lines',
        'inspect_feed_bin',
        'downtime_days'
    ];
    
    tableRows.forEach((row, index) => {
        if (index < taskIds.length) {
            const taskId = taskIds[index];
            const inputs = row.querySelectorAll('input, textarea, select');
            
            console.log(`Barn cleaning row ${index} (${taskId}):`, inputs.length, 'inputs found');
            
            if (taskId === 'downtime_days') {
                // Special handling for downtime (number input)
                const downtimeInput = row.querySelector('input[type="number"]');
                barnCleaningData[taskId] = {
                    days: downtimeInput?.value ? parseInt(downtimeInput.value) : null
                };
        } else if (taskId === 'option1_detergent_disinfectant' || taskId === 'option2_detergent_disinfectant') {
    // Special handling for option rows with checkboxes
    const dateInput = inputs[0];
    const productInput = row.querySelector('td:nth-child(3) input[type="text"]');
    const checkboxes = row.querySelectorAll('input[type="checkbox"]');
    
    barnCleaningData[taskId] = {
        date_completed: dateInput?.value || "",
        product_description: productInput?.value || "",
        detergent_used: checkboxes[0]?.checked || false,
        disinfectant_used: checkboxes[1]?.checked || false
    };
            } else if (taskId === 'flush_water_lines') {
                // Special handling for flush water lines with checkbox
                const dateInput = inputs[0];
                const productInput = inputs[inputs.length - 1];
                const flushCheckbox = row.querySelector('input[type="checkbox"]');
                
                barnCleaningData[taskId] = {
                    date_completed: dateInput?.value || "",
                    product_description: productInput?.value || "",
                    flush_performed: flushCheckbox?.checked || false
                };
            } else {
                // Standard handling for most rows
                const dateInput = inputs[0];
                const descriptionInput = inputs[1];
                
                barnCleaningData[taskId] = {
                    date_completed: dateInput?.value || "",
                    product_description: descriptionInput?.value || ""
                };
            }
            
            console.log(`${taskId}:`, barnCleaningData[taskId]);
        }
    });
    
    console.log("🧹 Final barn cleaning data:", barnCleaningData);
    return barnCleaningData;
}

function getFacilitiesPreparationData() {
    console.log("🏭 Collecting facilities preparation data...");
    
    // Find the facilities preparation section
    const allSections = document.querySelectorAll('.section');
    let facilitiesSection = null;
    
    allSections.forEach(section => {
        const table = section.querySelector('.table-header-dark');
        if (table && table.textContent.includes('Facilities Preparation')) {
            facilitiesSection = section;
        }
    });
    
    if (!facilitiesSection) {
        console.log("❌ Facilities preparation section not found");
        return {};
    }
    
    const facilitiesData = {};
    const tableRows = facilitiesSection.querySelectorAll('.table-header-dark tbody tr');
    
    console.log("Facilities preparation table rows found:", tableRows.length);
    
    // Define the task identifiers for each row
    const taskIds = [
        'water_system_checked',
        'heating_system_checked',
        'standby_generator_checked',
        'monitoring_system_checked',
        'ventilation_system_checked',
        'light_system_checked',
        'drinkers_feeders_checked',
        'bedding_material_checked'
    ];
    
    tableRows.forEach((row, index) => {
        if (index < taskIds.length) {
            const taskId = taskIds[index];
            const inputs = row.querySelectorAll('input, textarea');
            
            console.log(`Facilities prep row ${index} (${taskId}):`, inputs.length, 'inputs found');
            
            // Standard handling for all facilities prep rows (date + description)
            const dateInput = inputs[0];
            const descriptionInput = inputs[1];
            
            facilitiesData[taskId] = {
                date_completed: dateInput?.value || "",
                description_results: descriptionInput?.value || ""
            };
            
            console.log(`${taskId}:`, facilitiesData[taskId]);
        }
    });
    
    console.log("🏭 Final facilities preparation data:", facilitiesData);
    return facilitiesData;
}

function getPestControlData() {
    console.log("🐭 Collecting pest control data...");
    
    // Find the pest control section
    const allSections = document.querySelectorAll('.section');
    let pestControlSection = null;
    
    allSections.forEach(section => {
        const table = section.querySelector('.table-header-dark');
        if (table && table.textContent.includes('Pest Control - Describe the pest control methods used')) {
            pestControlSection = section;
        }
    });
    
    if (!pestControlSection) {
        console.log("❌ Pest control section not found");
        return {};
    }
    
    const pestControlData = {};
    const tableRows = pestControlSection.querySelectorAll('.table-header-dark tbody tr');
    
    console.log("Pest control table rows found:", tableRows.length);
    
    // Define the task identifiers for each row
    const taskIds = [
        'describe_barn_repairs',
        'vegetation_cut_around_buildings',
        'caz_kept_maintained',
        'rodent_controls_used',
        'wild_bird_controls_used',
        'fly_controls_used',
        'insecticides_used',
        'other_pests_controls',
        'no_pets_in_ra'
    ];
    
    tableRows.forEach((row, index) => {
        if (index < taskIds.length) {
            const taskId = taskIds[index];
            const inputs = row.querySelectorAll('input, textarea');
            
            console.log(`Pest control row ${index} (${taskId}):`, inputs.length, 'inputs found');
            
            if (taskId === 'no_pets_in_ra') {
                // Special handling for "No pets in the RA" row (date + signature)
                const dateInput = inputs[0];
                const signatureInput = inputs[1];
                
                pestControlData[taskId] = {
                    date_completed: dateInput?.value || "",
                    signature: signatureInput?.value || ""
                };
            } else {
                // Standard handling for most rows (date + description/product)
                const dateInput = inputs[0];
                const descriptionInput = inputs[1];
                
                pestControlData[taskId] = {
                    date_completed: dateInput?.value || "",
                    description_product: descriptionInput?.value || ""
                };
            }
            
            console.log(`${taskId}:`, pestControlData[taskId]);
        }
    });
    
    console.log("🐭 Final pest control data:", pestControlData);
    return pestControlData;
}

function getMedicationsData() {
    console.log("💊 Collecting medications data...");
    
    // Find the medications section
    const allSections = document.querySelectorAll('.section');
    let medicationsSection = null;
    
    allSections.forEach(section => {
        const header = section.querySelector('.section-header');
        if (header && header.textContent.includes('Medications - Complete the following table')) {
            medicationsSection = section;
        }
    });
    
    if (!medicationsSection) {
        console.log("❌ Medications section not found");
        return {};
    }
    
    const medicationsData = {
        medications: []
    };
    
    const tableRows = medicationsSection.querySelectorAll('table tbody tr');
    console.log("Medications table rows found:", tableRows.length);
    
 tableRows.forEach((row, index) => {
    // Skip if row doesn't exist in DOM
    if (!row || !document.contains(row)) {
        console.log(`Skipping deleted medication row ${index}`);
        return;
    }
        
        const inputs = row.querySelectorAll('input, select');
        const checkboxes = row.querySelectorAll('input[type="checkbox"]');
        
        console.log(`Medications row ${index}:`, inputs.length, 'inputs found,', checkboxes.length, 'checkboxes found');
        
        if (inputs.length >= 5) {
            // Find medication name input (first text input)
            const medicationNameInput = row.querySelector('input[type="text"]');
            
            // Find route of administration checkboxes
            const feedCheckbox = row.querySelector('input[id*="feed"]') || checkboxes[0];
            const waterCheckbox = row.querySelector('input[id*="water"]') || checkboxes[1];
            
            // Find date inputs (should be date type inputs)
            const dateInputs = row.querySelectorAll('input[type="date"]');
            const testDate = dateInputs[0];
            const resultDate = dateInputs[1];
            
            // Find text inputs for actions and control measures
            const textInputs = row.querySelectorAll('input[type="text"]');
            const correctiveActions = textInputs.length > 1 ? textInputs[textInputs.length - 2] : null;
            const controlMeasures = textInputs[textInputs.length - 1];
            
            const medicationName = medicationNameInput?.value || "";
            const feedRoute = feedCheckbox?.checked || false;
            const waterRoute = waterCheckbox?.checked || false;
            const testDateValue = testDate?.value || "";
            const resultDateValue = resultDate?.value || "";
            const correctiveActionsValue = correctiveActions?.value || "";
            const controlMeasuresValue = controlMeasures?.value || "";
            
            console.log(`Medication ${index} data:`, {
                medicationName,
                feedRoute,
                waterRoute,
                testDateValue,
                resultDateValue,
                correctiveActionsValue,
                controlMeasuresValue
            });
        // Always save the row regardless of data
medicationsData.medications.push({
    name: medicationName,
    route_of_administration: {
        feed: feedRoute,
        water: waterRoute
    },
    water_medicator_tested: {
        date: testDateValue,
        results: resultDateValue
    },
    corrective_actions: correctiveActionsValue,
    control_measures: controlMeasuresValue
});
        }
    });
    
    console.log("💊 Final medications data:", medicationsData);
    return medicationsData;
}
function getDeviationChartData() {
    console.log("📊 Collecting deviation chart data...");
    
    // Find the deviation chart section
    const allSections = document.querySelectorAll('.section');
    let deviationSection = null;
    
    allSections.forEach(section => {
        const header = section.querySelector('.section-header');
        if (header && header.textContent.includes('Deviation Chart')) {
            deviationSection = section;
        }
    });
    
    if (!deviationSection) {
        console.log("❌ Deviation chart section not found");
        return {};
    }
    
    const deviationData = {
        deviation_types_checkboxes: {},
        deviations: []
    };
    
    // Collect the deviation type checkboxes
    const checkboxes = deviationSection.querySelectorAll('input[type="checkbox"]');
    const checkboxIds = ['temp', 'lighting', 'humidity', 'mortality', 'bedding', 'medication', 'alarms'];
    
    console.log("Deviation checkboxes found:", checkboxes.length);
    
    checkboxes.forEach((checkbox, index) => {
        if (index < checkboxIds.length) {
            const checkboxId = checkboxIds[index];
            deviationData.deviation_types_checkboxes[checkboxId] = checkbox.checked;
            console.log(`Deviation type ${checkboxId}:`, checkbox.checked);
        }
    });
    
// Collect deviation table data
    const tableRows = deviationSection.querySelectorAll('table tbody tr');
    console.log("Deviation table rows found:", tableRows.length);
    
tableRows.forEach((row, index) => {
    // Skip if row doesn't exist in DOM
    if (!row || !document.contains(row)) {
        console.log(`Skipping deleted deviation row ${index}`);
        return;
    }
        const inputs = row.querySelectorAll('input, textarea');
        
        console.log(`Deviation row ${index}:`, inputs.length, 'inputs found');
        
        if (inputs.length >= 4) {
            const dateInput = inputs[0]; // Date
            const descriptionTextarea = inputs[1]; // Description of the Deviation
            const reasonTextarea = inputs[2]; // Reason for the Deviation
            const actionsTextarea = inputs[3]; // Actions taken to Correct the Deviation
            
            const date = dateInput?.value || "";
            const description = descriptionTextarea?.value || "";
            const reason = reasonTextarea?.value || "";
            const actions = actionsTextarea?.value || "";
            
            console.log(`Deviation ${index} data:`, {
                date,
                description,
                reason,
                actions
            });
            
        // Always save the row regardless of data
deviationData.deviations.push({
    date: date,
    description_of_deviation: description,
    reason_for_deviation: reason,
    actions_taken_to_correct: actions
});
        }
    });
    
    console.log("📊 Final deviation chart data:", deviationData);
    return deviationData;
}

  // Feed information - IMPROVED COLLECTION - FIXED VERSION
console.log("🌾 Collecting feed data...");

const initialInput = document.getElementById('feedSignature');
       
// Find the feed section more specifically
const allSections = document.querySelectorAll('.section');
let feedSection = null;

allSections.forEach(section => {
    const header = section.querySelector('.section-header');
    if (header && header.textContent.trim() === 'Feed') {
        feedSection = section;
    }
});

if (!feedSection) {
    console.log("❌ Feed section not found, trying alternative approach...");
    // Fallback: look for section containing the specific text
    feedSection = Array.from(allSections).find(section => 
        section.textContent.includes('Record the dates of feed samples')
    );
}

console.log("🔍 Feed section found:", !!feedSection);

// Collect feed entries from table rows
const feedEntries = [];
if (feedSection) {
    const feedTableRows = feedSection.querySelectorAll('.table-header-dark tbody tr');
    console.log("Feed table rows found:", feedTableRows.length);
    
    feedTableRows.forEach((row, index) => {
        // Skip deleted rows and note rows
        if (!row.parentNode || row.classList.contains('note-row')) {
            return;
        }
        
        const inputs = row.querySelectorAll('input, textarea');
        console.log(`Feed row ${index} inputs found:`, inputs.length);
        
        if (inputs.length >= 3) {
            const controlMeasuresDate = inputs[0]?.value || "";
            const addedIngredients = inputs[1]?.value || "";
            const feedSampleDate = inputs[2]?.value || "";
            
            // Get the note from the next row
            const noteRow = row.nextElementSibling;
            let entryNote = "";
            if (noteRow && noteRow.classList.contains('note-row')) {
                const noteTextarea = noteRow.querySelector('.entry-note-input');
                entryNote = noteTextarea?.value || "";
            }
            
            feedEntries.push({
                control_measures_date: controlMeasuresDate ? new Date(controlMeasuresDate) : null,
                added_ingredients: addedIngredients,
                feed_sample_date: feedSampleDate ? new Date(feedSampleDate) : null,
                entry_note: entryNote
            });
        }
    });
}

const feedData = {
    visual_inspection_initial: initialInput?.value || "",
    feed_entries: feedEntries
};

console.log("🌾 Final feed data to save:", feedData);
      // Feed Transfer Record - IMPROVED COLLECTION - FIXED VERSION
console.log("🚚 Collecting feed transfer data...");

// Find the Feed Transfer Record section more specifically
let feedTransferSection = null;

allSections.forEach(section => {
    const header = section.querySelector('.section-header');
    if (header && header.textContent.trim() === 'Feed Transfer Record') {
        feedTransferSection = section;
    }
});

if (!feedTransferSection) {
    console.log("❌ Feed Transfer Record section not found, trying alternative approach...");
    feedTransferSection = Array.from(allSections).find(section => 
        section.textContent.includes('Date feed moved')
    );
}

console.log("🔍 Feed Transfer Record section found:", !!feedTransferSection);

const feedTransfers = [];
if (feedTransferSection) {
    const transferTableRows = feedTransferSection.querySelectorAll('.table-header-dark tbody tr');
    console.log("Feed transfer table rows found:", transferTableRows.length);
    
 transferTableRows.forEach((row, index) => {
    // Skip if row doesn't exist in DOM or is a note row
    if (!row || !document.contains(row) || row.classList.contains('note-row')) {
        console.log(`Skipping deleted or note row ${index}`);
        return;
    }
    
    const inputs = row.querySelectorAll('input, select, textarea');
    console.log(`Transfer row ${index} inputs found:`, inputs.length);
    
    if (inputs.length >= 7) {
        const dateMoved = inputs[0]?.value || "";
        const originalFarmBin = inputs[1]?.value || "";
        const destinationFarmBin = inputs[2]?.value || "";
        const medications = inputs[3]?.value || "";
        const transportMethod = inputs[4]?.value || "";
        const sampleTaken = inputs[5]?.value || "";
        const preventionMeasures = inputs[6]?.value || "";
        
        // Get the note from the next row
        const noteRow = row.nextElementSibling;
        let entryNote = "";
        if (noteRow && noteRow.classList.contains('note-row')) {
            const noteTextarea = noteRow.querySelector('.entry-note-input');
            entryNote = noteTextarea?.value || "";
        }
        
        console.log(`Feed transfer row ${index} data:`, {
            dateMoved,
            originalFarmBin,
            destinationFarmBin,
            medications,
            transportMethod,
            sampleTaken,
            preventionMeasures,
            entryNote
        });
        
        // Always save the row regardless of data
        feedTransfers.push({
            date_moved: dateMoved ? new Date(dateMoved) : null,
            original_farm_bin: originalFarmBin,
            destination_farm_bin: destinationFarmBin,
            medications: medications,
            transport_method: transportMethod,
            sample_taken: sampleTaken,
            prevention_measures: preventionMeasures,
            entry_note: entryNote
        });
    }
});

console.log("🚚 Final feed transfers to save:", feedTransfers);

} // <- ADD THIS MISSING CLOSING BRACE

// Water products - IMPROVED COLLECTION (supports multiple rows) - FIXED VERSION
console.log("💧 Collecting water products data...");

console.log("🚚 Final feed transfers to save:", feedTransfers);

// Water products - IMPROVED COLLECTION (supports multiple rows) - FIXED VERSION
console.log("💧 Collecting water products data...");

// Find water section more specifically
const waterSections = document.querySelectorAll('.section');
let waterSection = null;

waterSections.forEach(section => {
    const header = section.querySelector('.section-header');
    if (header && header.textContent.includes('Water - Record all products')) {
        waterSection = section;
    }
});

if (!waterSection) {
    // Fallback to first section
    waterSection = document.querySelector('.section');
}

const waterTableRows = waterSection?.querySelectorAll('.table-header-dark tbody tr') || [];
console.log("Water table rows found:", waterTableRows.length);

const waterProducts = [];
waterTableRows.forEach((row, index) => {
    // Skip deleted rows (they won't be in the DOM anymore)
    if (!row.parentNode) {
        console.log(`Skipping deleted row ${index}`);
        return;
    }
    
    const inputs = row.querySelectorAll('input');
    console.log(`Water row ${index} inputs found:`, inputs.length);
    
    if (inputs.length >= 4) {
        const productName = inputs[0]?.value || "";
        const dateUsed = inputs[1]?.value || "";
        const verificationDate = inputs[2]?.value || "";
        const results = inputs[3]?.value || "";
        
        console.log(`Water row ${index} data:`, {
            productName,
            dateUsed, 
            verificationDate,
            results
        });
        
   // Always save the row regardless of data
waterProducts.push({
    product_name: productName,
    dates_used: dateUsed ? [new Date(dateUsed)] : [],
    verification: [{
        date: verificationDate,
        results: results
    }]
});
    }
});

console.log("💧 Final water products to save:", waterProducts);
       
       // Daily checks
       const dailyCheckboxes = document.querySelectorAll('#feedquality, #thermal, #templevels, #humiditylevels, #wateravail, #flockhealth, #ventilation, #ammonialevels, #waterquality, #heatingsystem, #lightingsystem, #litterquality, #birdsinspected');
       const checkedDaily = Array.from(dailyCheckboxes).filter(cb => cb.checked).map(cb => cb.id);
       
     const signatureInput = null; // Signature is now an image, not an input
       const signatureDateInput = document.querySelector('input[type="date"].medium-input');
       const additionalNotesDaily = document.querySelector('.signature-section').previousElementSibling?.querySelector('textarea');
       
       console.log("Daily checks:");
       console.log("- Checkboxes found:", dailyCheckboxes.length);
       console.log("- Checked boxes:", checkedDaily);
       console.log("- Signature:", !!signatureInput, signatureInput?.value);
       console.log("- Signature date:", !!signatureDateInput, signatureDateInput?.value);
       console.log("- Additional notes:", !!additionalNotesDaily, additionalNotesDaily?.value);
       
   
// REPLACE IT WITH THIS (add the missing feed_transfers line):

const formData = {
    production_info: {
        farm_representative: farmRepInput?.value || "",
        placement_notes: placementNotesTextarea?.value || ""
    },
    
    chick_quality: getChickQualityData(),
    
    water_products: waterProducts,
    
    feed: feedData,
    
feed_transfers: {
    transfers: feedTransfers
},
    barn_cleaning: getBarnCleaningData(),
    facilities_preparation: getFacilitiesPreparationData(),
    pest_control: getPestControlData(),
    medications: getMedicationsData(),
    deviation_chart: getDeviationChartData(),
    
    daily_checks: {
        confirmed_checks: checkedDaily,
        additional_notes: additionalNotesDaily?.value || "",
        signature: signatureInput?.value || "",
        signature_date: signatureDateInput?.value ? new Date(signatureDateInput.value) : null
    },
    
    metadata: {
        updated_at: new Date(),
        last_saved_by: "user"
    }
};
       
       console.log("📊 Final form data to save:", formData);
       
       // Save to Firestore with merge
       await setDoc(docRef, formData, { merge: true });
       
// Success feedback
       saveButton.disabled = false;
       if (!isMobile) {
           saveButton.textContent = '💾 Save Farm Records';
       }
       saveStatus.textContent = '✅ Data saved successfully!';
       saveStatus.style.color = 'green';
       
       console.log("✅ Form data saved successfully!");
       
       // Clear success message after 3 seconds
       setTimeout(() => {
           saveStatus.textContent = '';
       }, 3000);
       
   } catch (error) {
       console.error("❌ Error saving form data:", error);
       
    // Error feedback
       saveButton.disabled = false;
       if (!isMobile) {
           saveButton.textContent = '💾 Save Farm Records';
       }
       saveStatus.textContent = '❌ Error saving data. Please try again.';
       saveStatus.style.color = 'red';
       
       // Clear error message after 5 seconds
       setTimeout(() => {
           saveStatus.textContent = '';
       }, 5000);
   }
}

// Function to load existing data from Firestore
async function loadFormData() {
   console.log("📥 Loading existing form data...");
   
   try {
       const docRef = doc(db, 'vas-b1-fl', 'vas-b1-f1');
       const docSnap = await getDoc(docRef);
       
       if (docSnap.exists()) {
           const data = docSnap.data();
           console.log("📄 Loaded data:", data);
           
           // Load farm representative
           const farmRepInput = document.querySelector('input[placeholder="Chris Rose"]');
           if (farmRepInput && data.production_info?.farm_representative) {
               farmRepInput.value = data.production_info.farm_representative;
               console.log("✅ Loaded farm representative:", data.production_info.farm_representative);
           }
           
           // Load placement notes
           const placementNotesTextarea = document.querySelector('textarea[placeholder="Additional comments or notes"]');
           if (placementNotesTextarea && data.production_info?.placement_notes) {
               placementNotesTextarea.value = data.production_info.placement_notes;
           }
           
           // Load chick quality checkboxes
           if (data.chick_quality) {
               const tbody = document.querySelector('.table-header-dark tbody');
               const rows = tbody?.querySelectorAll('tr') || [];
               const qualities = ['alertness', 'vigour', 'condition', 'normality'];
               
               rows.forEach((row, index) => {
                   if (index < 4) {
                       const checkboxes = row.querySelectorAll('input[type="checkbox"]');
                       const quality = qualities[index];
                       
                       if (checkboxes.length >= 4 && data.chick_quality.upon_receipt?.[quality]) {
                           if (checkboxes[0]) checkboxes[0].checked = data.chick_quality.upon_receipt[quality].acceptable;
                           if (checkboxes[1]) checkboxes[1].checked = data.chick_quality.upon_receipt[quality].not_acceptable;
                       }
                       
                       if (checkboxes.length >= 4 && data.chick_quality.three_four_days?.[quality]) {
                           if (checkboxes[2]) checkboxes[2].checked = data.chick_quality.three_four_days[quality].acceptable;
                           if (checkboxes[3]) checkboxes[3].checked = data.chick_quality.three_four_days[quality].not_acceptable;
                       }
                   }
               });
           }

     // Load water products data (supports multiple rows) - FIXED VERSION
if (data.water_products && data.water_products.length > 0) {
    console.log("💧 Loading water products data...");
    
    // Find water section more specifically
    const waterSections = document.querySelectorAll('.section');
    let waterSection = null;
    
    waterSections.forEach(section => {
        const header = section.querySelector('.section-header');
        if (header && header.textContent.includes('Water - Record all products')) {
            waterSection = section;
        }
    });
    
    if (!waterSection) {
        // Fallback to first section
        waterSection = document.querySelector('.section');
    }
    
    const waterTableBody = waterSection?.querySelector('.table-header-dark tbody');
    
    if (waterTableBody) {
        // Clear existing rows except the first one
        const existingRows = waterTableBody.querySelectorAll('tr');
        for (let i = 1; i < existingRows.length; i++) {
            existingRows[i].remove();
        }
        
        // Load all water products
        data.water_products.forEach((waterProduct, index) => {
            let targetRow;
            
            // Use existing first row or create new row
            if (index === 0) {
                targetRow = waterTableBody.querySelector('tr');
            } else {
                // Create new row for additional entries using the same function
                targetRow = document.createElement('tr');
                targetRow.innerHTML = `
                    <td><input type="text" class="table-input" placeholder="Product name"></td>
                    <td><input type="date" class="table-input"></td>
                    <td><input type="date" class="table-input"></td>
                    <td><input type="text" class="table-input" placeholder="Results"></td>
                    <td style="text-align: center;">
                        <button type="button" class="delete-water-row" style="background-color: #f44336; color: white; border: none; border-radius: 3px; width: 25px; height: 25px; cursor: pointer; font-size: 16px;" onclick="deleteWaterRow(this)">✕</button>
                    </td>
                `;
                waterTableBody.appendChild(targetRow);
            }
            
            const inputs = targetRow.querySelectorAll('input');
            
            if (inputs.length >= 4) {
                // Load product name
                if (inputs[0] && waterProduct.product_name) {
                    inputs[0].value = waterProduct.product_name;
                }
                
                // Load date used (first date if multiple)
                if (inputs[1] && waterProduct.dates_used && waterProduct.dates_used.length > 0) {
                    const date = waterProduct.dates_used[0].toDate ? 
                        waterProduct.dates_used[0].toDate() : 
                        new Date(waterProduct.dates_used[0]);
                    inputs[1].value = date.toISOString().split('T')[0];
                }
                
                // Load verification date and results
                if (waterProduct.verification && waterProduct.verification.length > 0) {
                    if (inputs[2] && waterProduct.verification[0].date) {
                        inputs[2].value = waterProduct.verification[0].date;
                    }
                    if (inputs[3] && waterProduct.verification[0].results) {
                        inputs[3].value = waterProduct.verification[0].results;
                    }
                }
            }
        });
    }
    
    console.log("✅ Water products data loaded successfully!");
}

           
       // Load feed information with multiple entries support - FIXED VERSION
if (data.feed) {
    console.log("🌾 Loading feed data...");
    
    // Load visual inspection signature
    const visualInspectionInput = document.getElementById('feedSignature');
    if (visualInspectionInput && data.feed.visual_inspection_initial) {
        visualInspectionInput.value = data.feed.visual_inspection_initial;
    }
    
    // Load feed entries (supports multiple rows)
    if (data.feed.feed_entries && data.feed.feed_entries.length > 0) {
        console.log("🔍 Loading feed entries...");
        
        // Find the Feed section more specifically
        const allSections = document.querySelectorAll('.section');
        let feedSection = null;
        
        allSections.forEach(section => {
            const header = section.querySelector('.section-header');
            if (header && header.textContent.trim() === 'Feed') {
                feedSection = section;
            }
        });
        
        if (!feedSection) {
            feedSection = Array.from(allSections).find(section => 
                section.textContent.includes('Record the dates of feed samples')
            );
        }
        
        if (feedSection) {
            const feedTableBody = feedSection.querySelector('.table-header-dark tbody');
            
          if (feedTableBody) {
    // Clear existing rows except the first entry and its note row
    const existingRows = feedTableBody.querySelectorAll('tr');
    for (let i = 2; i < existingRows.length; i++) {
        existingRows[i].remove();
    }
                
               // Load all feed entries
// Load all feed entries
data.feed.feed_entries.forEach((feedEntry, index) => {
    let targetRow;
    
    // Determine styling based on entry index
    const isDarkEntry = index % 2 === 0; // First entry (index 0) is dark, then alternates
    
    // Use existing first row or create new row
    if (index === 0) {
        targetRow = feedTableBody.querySelector('tr:not(.note-row)');
        // Apply styling to existing first row
        if (targetRow) {
            if (isDarkEntry) {
                targetRow.style.backgroundColor = '#f5f5f5';
                targetRow.style.borderTop = '2px solid #333';
            } else {
                targetRow.style.backgroundColor = '#ffffff';
                targetRow.style.borderTop = '1px solid #ccc';
            }
        }
    } else {
        // Create new row for additional entries
        targetRow = document.createElement('tr');
        if (isDarkEntry) {
            targetRow.style.backgroundColor = '#f5f5f5';
            targetRow.style.borderTop = '2px solid #333';
        } else {
            targetRow.style.backgroundColor = '#ffffff';
            targetRow.style.borderTop = '1px solid #ccc';
        }
        targetRow.innerHTML = `
            <td><input type="date" class="table-input"></td>
            <td><textarea class="table-input" placeholder="Enter ingredients"></textarea></td>
            <td><input type="date" class="table-input"></td>
            <td style="text-align: center;">
                <button type="button" class="delete-feed-row" style="background-color: #f44336; color: white; border: none; border-radius: 3px; width: 25px; height: 25px; cursor: pointer; font-size: 16px;" onclick="deleteFeedRow(this)">✕</button>
            </td>
        `;
        
        // Create note row
        const noteRow = document.createElement('tr');
        noteRow.className = 'note-row';
        if (isDarkEntry) {
            noteRow.style.backgroundColor = '#f9f9f9';
            noteRow.style.borderBottom = '2px solid #333';
        } else {
            noteRow.style.backgroundColor = '#fafafa';
            noteRow.style.borderBottom = '1px solid #ccc';
        }
        noteRow.innerHTML = `
    <td colspan="4">
        <div style="padding: 5px;">
            <label style="font-weight: bold; font-size: 10px;">Notes:</label>
            <textarea class="entry-note-input" placeholder="Notes for this entry..." style="width: 100%; min-height: 40px; max-height: 120px; resize: vertical; margin-top: 3px; padding: 4px; font-size: 10px; border: 1px solid #ccc;"></textarea>
        </div>
    </td>
`;
        
        feedTableBody.appendChild(targetRow);
        feedTableBody.appendChild(noteRow);
    }
    
    // Apply styling to existing first note row if it exists
    if (index === 0) {
        const existingNoteRow = targetRow.nextElementSibling;
        if (existingNoteRow && existingNoteRow.classList.contains('note-row')) {
            if (isDarkEntry) {
                existingNoteRow.style.backgroundColor = '#f9f9f9';
                existingNoteRow.style.borderBottom = '2px solid #333';
            } else {
                existingNoteRow.style.backgroundColor = '#fafafa';
                existingNoteRow.style.borderBottom = '1px solid #ccc';
            }
        }
    }
    
    const inputs = targetRow.querySelectorAll('input, textarea');
    
    if (inputs.length >= 3) {
        // Load control measures date
        if (inputs[0] && feedEntry.control_measures_date) {
            const date = feedEntry.control_measures_date.toDate ? 
                feedEntry.control_measures_date.toDate() : 
                new Date(feedEntry.control_measures_date);
            inputs[0].value = date.toISOString().split('T')[0];
        }
        
        // Load added ingredients
        if (inputs[1] && feedEntry.added_ingredients) {
            inputs[1].value = feedEntry.added_ingredients;
        }
        
        // Load feed sample date
        if (inputs[2] && feedEntry.feed_sample_date) {
            const date = feedEntry.feed_sample_date.toDate ? 
                feedEntry.feed_sample_date.toDate() : 
                new Date(feedEntry.feed_sample_date);
            inputs[2].value = date.toISOString().split('T')[0];
        }
    }
    
    // Load entry note
    const noteRow = targetRow.nextElementSibling;
    if (noteRow && noteRow.classList.contains('note-row') && feedEntry.entry_note) {
        const noteTextarea = noteRow.querySelector('.entry-note-input');
        if (noteTextarea) {
            noteTextarea.value = feedEntry.entry_note;
        }
    }
});
            }
        }
        
        console.log("✅ Feed entries loaded successfully!");

        // Load feed notes
if (data.feed?.notes) {
    const feedNotesTextarea = document.getElementById('feedNotes');
    if (feedNotesTextarea) {
        feedNotesTextarea.value = data.feed.notes;
        console.log("✅ Feed notes loaded successfully!");
    }
}

    }
}

          // Load feed transfer records - FIXED VERSION
// Handle both old format (array) and new format (object with transfers array)
const feedTransfersArray = Array.isArray(data.feed_transfers) ? data.feed_transfers : data.feed_transfers?.transfers || [];

if (feedTransfersArray.length > 0) {
    console.log("🔍 Loading feed transfer records...");
    
    // Find the Feed Transfer Record section more specifically
    const allSections = document.querySelectorAll('.section');
    let feedTransferSection = null;
    
    allSections.forEach(section => {
        const header = section.querySelector('.section-header');
        if (header && header.textContent.trim() === 'Feed Transfer Record') {
            feedTransferSection = section;
        }
    });
    
    if (!feedTransferSection) {
        feedTransferSection = Array.from(allSections).find(section => 
            section.textContent.includes('Date feed moved')
        );
    }
    
  if (feedTransferSection) {
    const feedTransferTableBody = feedTransferSection.querySelector('.table-header-dark tbody');
    
    if (feedTransferTableBody) {
        // Clear existing rows except the first entry and its note row
        const existingRows = feedTransferTableBody.querySelectorAll('tr');
        for (let i = 2; i < existingRows.length; i++) {
            existingRows[i].remove();
        }
        
  // Load all feed transfer records
feedTransfersArray.forEach((transfer, index) => {
    let targetRow;
    
    // Determine styling based on entry index
    const isDarkEntry = index % 2 === 0; // First entry (index 0) is dark, then alternates
    
    // Use existing first row or create new row
    if (index === 0) {
        targetRow = feedTransferTableBody.querySelector('tr:not(.note-row)');
        // Apply styling to existing first row
        if (targetRow) {
            if (isDarkEntry) {
                targetRow.style.backgroundColor = '#f5f5f5';
                targetRow.style.borderTop = '2px solid #333';
            }
            // Normal entries keep default styling
        }
    } else {
        // Create new row for additional entries
        targetRow = document.createElement('tr');
        if (isDarkEntry) {
            targetRow.style.backgroundColor = '#f5f5f5';
            targetRow.style.borderTop = '2px solid #333';
        }
        // Normal entries get no special styling
        targetRow.innerHTML = `
            <td><input type="date" class="table-input"></td>
            <td><input type="text" class="table-input" placeholder="Farm/bin"></td>
            <td><input type="text" class="table-input" placeholder="Farm/bin"></td>
            <td><textarea class="table-input" placeholder="Medications"></textarea></td>
            <td><input type="text" class="table-input" placeholder="Truck"></td>
            <td>
                <select class="table-input">
                    <option value="Yes" selected>Yes</option>
                    <option value="No">No</option>
                </select>
            </td>
            <td><input type="text" class="table-input" placeholder="Yes"></td>
            <td style="text-align: center;">
                <button type="button" class="delete-feed-transfer-row" style="background-color: #f44336; color: white; border: none; border-radius: 3px; width: 25px; height: 25px; cursor: pointer; font-size: 16px;" onclick="deleteFeedTransferRow(this)">✕</button>
            </td>
        `;
        
        // Create note row
        const noteRow = document.createElement('tr');
        noteRow.className = 'note-row';
        if (isDarkEntry) {
            noteRow.style.backgroundColor = '#f9f9f9';
            noteRow.style.borderBottom = '2px solid #333';
        } else {
            noteRow.style.backgroundColor = '#fafafa';
            noteRow.style.borderBottom = '1px solid #ccc';
        }
        noteRow.innerHTML = `
    <td colspan="8">
        <div style="padding: 5px;">
            <label style="font-weight: bold; font-size: 10px;">Notes:</label>
            <textarea class="entry-note-input" placeholder="Notes for this entry..." style="width: 100%; min-height: 40px; max-height: 120px; resize: vertical; margin-top: 3px; padding: 4px; font-size: 10px; border: 1px solid #ccc;"></textarea>
        </div>
    </td>
`;
        feedTransferTableBody.appendChild(targetRow);
        feedTransferTableBody.appendChild(noteRow);
    }
    
    // Apply styling to existing first note row if it exists
    if (index === 0) {
        const existingNoteRow = targetRow.nextElementSibling;
        if (existingNoteRow && existingNoteRow.classList.contains('note-row')) {
            if (isDarkEntry) {
                existingNoteRow.style.backgroundColor = '#f9f9f9';
                existingNoteRow.style.borderBottom = '2px solid #333';
            } else {
                existingNoteRow.style.backgroundColor = '#fafafa';
                existingNoteRow.style.borderBottom = '1px solid #ccc';
            }
        }
    }
    
    const inputs = targetRow.querySelectorAll('input, select, textarea');
    
    if (inputs.length >= 7) {
        // Load date moved
        if (inputs[0] && transfer.date_moved) {
            const date = transfer.date_moved.toDate ? 
                transfer.date_moved.toDate() : 
                new Date(transfer.date_moved);
            inputs[0].value = date.toISOString().split('T')[0];
        }
        
        // Load text fields
        if (inputs[1] && transfer.original_farm_bin) {
            inputs[1].value = transfer.original_farm_bin;
        }
        if (inputs[2] && transfer.destination_farm_bin) {
            inputs[2].value = transfer.destination_farm_bin;
        }
        if (inputs[3] && transfer.medications) {
            inputs[3].value = transfer.medications;
        }
        if (inputs[4] && transfer.transport_method) {
            inputs[4].value = transfer.transport_method;
        }
        if (inputs[5] && transfer.sample_taken) {
            inputs[5].value = transfer.sample_taken;
        }
        if (inputs[6] && transfer.prevention_measures) {
            inputs[6].value = transfer.prevention_measures;
        }
    }

    // Load entry note
    const noteRow = targetRow.nextElementSibling;
    if (noteRow && noteRow.classList.contains('note-row') && transfer.entry_note) {
        const noteTextarea = noteRow.querySelector('.entry-note-input');
        if (noteTextarea) {
            noteTextarea.value = transfer.entry_note;
        }
    }
});
        }
        
        console.log("✅ Feed transfer records loaded successfully!");

        // Load feed transfer notes
if (data.feed_transfers?.notes) {
    const feedTransferNotesTextarea = document.getElementById('feedTransferNotes');
    if (feedTransferNotesTextarea) {
        feedTransferNotesTextarea.value = data.feed_transfers.notes;
        console.log("✅ Feed transfer notes loaded successfully!");
    }
}

    }
}

       // Load daily checks
           if (data.daily_checks?.confirmed_checks) {
               // First mark all daily check boxes as unchecked
               const dailyCheckIds = ['feedquality', 'thermal', 'templevels', 'humiditylevels', 'wateravail', 'flockhealth', 'ventilation', 'ammonialevels', 'waterquality', 'heatingsystem', 'lightingsystem', 'litterquality', 'birdsinspected'];
               dailyCheckIds.forEach(id => {
                   const checkbox = document.getElementById(id);
                   if (checkbox) {
                       checkbox.checked = false;
                       checkbox.setAttribute('data-loaded', 'true');
                   }
               });
               
               // Then check only the saved ones
               data.daily_checks.confirmed_checks.forEach(checkId => {
                   const checkbox = document.getElementById(checkId);
                   if (checkbox) {
                       checkbox.checked = true;
                   }
               });
           }
           
           if (data.daily_checks?.signature_date) {
    const signatureDateInput = document.querySelector('input[type="date"].medium-input');
    if (signatureDateInput) {
        const date = data.daily_checks.signature_date.toDate ? 
            data.daily_checks.signature_date.toDate() : 
            new Date(data.daily_checks.signature_date);
        signatureDateInput.value = date.toISOString().split('T')[0];
        console.log("✅ Loaded signature date:", date.toISOString().split('T')[0]);
    }
}

           if (data.daily_checks?.additional_notes) {
               const additionalNotesTextarea = document.querySelector('div.signature-section').previousElementSibling?.querySelector('textarea');
               if (additionalNotesTextarea) {
                   additionalNotesTextarea.value = data.daily_checks.additional_notes;
               }
           }
           await loadBarnCleaningData(data);
           await loadFacilitiesPreparationData(data);
           await loadPestControlData(data);
           await loadMedicationsData(data);
           await loadDeviationChartData(data);
           console.log("✅ Form data loaded successfully!");
       } else {
           console.log("📄 No existing data found");
       }
   } catch (error) {
       console.error("❌ Error loading form data:", error);
   }
}



// ===== UTILITY FUNCTION TO APPLY STYLING =====
function applyAlternatingRowStyling(tableBody, sectionType) {
    const dataRows = tableBody.querySelectorAll('tr:not(.note-row)');
    
    dataRows.forEach((row, index) => {
        const isDarkEntry = index % 2 === 0; // 0,2,4... are dark, 1,3,5... are normal
        const noteRow = row.nextElementSibling;
        
        // Clear existing styles first
        row.style.backgroundColor = '';
        row.style.borderTop = '';
        if (noteRow && noteRow.classList.contains('note-row')) {
            noteRow.style.backgroundColor = '';
            noteRow.style.borderBottom = '';
        }
        
        // Apply dark styling only to even-indexed entries (0,2,4...)
        if (isDarkEntry) {
            row.style.backgroundColor = '#f5f5f5';
            row.style.borderTop = '2px solid #333';
            
            if (noteRow && noteRow.classList.contains('note-row')) {
                noteRow.style.backgroundColor = '#f9f9f9';
                noteRow.style.borderBottom = '2px solid #333';
            }
        }
        // Odd-indexed entries (1,3,5...) get no special styling - just default table appearance
    });
}

async function loadBarnCleaningData(data) {
    if (!data.barn_cleaning) {
        console.log("📄 No barn cleaning data to load");
        return;
    }
    
    console.log("🧹 Loading barn cleaning data...");
    
    // Find the barn cleaning section
    const allSections = document.querySelectorAll('.section');
    let barnCleaningSection = null;
    
    allSections.forEach(section => {
        const table = section.querySelector('.table-header-dark');
        if (table && table.textContent.includes('BARN CLEANING')) {
            barnCleaningSection = section;
        }
    });
    
    if (!barnCleaningSection) {
        console.log("❌ Barn cleaning section not found for loading");
        return;
    }
    
    const tableRows = barnCleaningSection.querySelectorAll('.table-header-dark tbody tr');
    const taskIds = [
        'remove_litter_manure',
        'dry_clean_barn', 
        'mortality_buckets_wash',
        'pressure_wash_barn',
        'option1_detergent_disinfectant',
        'option2_detergent_disinfectant',
        'equipment_cleanout',
        'flush_water_lines',
        'inspect_feed_bin',
        'downtime_days'
    ];
    
    tableRows.forEach((row, index) => {
        if (index < taskIds.length) {
            const taskId = taskIds[index];
            const taskData = data.barn_cleaning[taskId];
            
            if (!taskData) return;
            
            const inputs = row.querySelectorAll('input, textarea, select');
            
            if (taskId === 'downtime_days') {
                // Load downtime days
                const downtimeInput = row.querySelector('input[type="number"]');
                if (downtimeInput && taskData.days !== null) {
                    downtimeInput.value = taskData.days;
                }
          } else if (taskId === 'option1_detergent_disinfectant' || taskId === 'option2_detergent_disinfectant') {
    // Load option rows with checkboxes
    const dateInput = inputs[0];
    // Find the text input in the third column specifically
    const productInput = row.querySelector('td:nth-child(3) input[type="text"]');
    const checkboxes = row.querySelectorAll('input[type="checkbox"]');
    
    if (dateInput && taskData.date_completed) {
        dateInput.value = taskData.date_completed;
    }
    if (productInput && taskData.product_description) {
        productInput.value = taskData.product_description;
    }
                if (checkboxes[0]) {
                    checkboxes[0].checked = taskData.detergent_used;
                }
                if (checkboxes[1]) {
                    checkboxes[1].checked = taskData.disinfectant_used;
                }
            } else if (taskId === 'flush_water_lines') {
                // Load flush water lines with checkbox
                const dateInput = inputs[0];
          const productInput = row.querySelector('td:last-child input[type="text"]') || inputs[inputs.length - 1];
                const flushCheckbox = row.querySelector('input[type="checkbox"]');
                
                if (dateInput && taskData.date_completed) {
                    dateInput.value = taskData.date_completed;
                }
              if (productInput && taskData.product_description) {
    productInput.value = taskData.product_description;
    productInput.setAttribute('data-loaded', 'true');
}
                if (flushCheckbox) {
                    flushCheckbox.checked = taskData.flush_performed;
                }
            } else {
                // Load standard rows
                const dateInput = inputs[0];
                const descriptionInput = inputs[1];
                
                if (dateInput && taskData.date_completed) {
                    dateInput.value = taskData.date_completed;
                }
                if (descriptionInput && taskData.product_description) {
                    descriptionInput.value = taskData.product_description;
                }
            }
        }
    });
    
    console.log("✅ Barn cleaning data loaded successfully!");
}

async function loadFacilitiesPreparationData(data) {
    if (!data.facilities_preparation) {
        console.log("📄 No facilities preparation data to load");
        return;
    }
    
    console.log("🏭 Loading facilities preparation data...");
    
    // Find the facilities preparation section
    const allSections = document.querySelectorAll('.section');
    let facilitiesSection = null;
    
    allSections.forEach(section => {
        const table = section.querySelector('.table-header-dark');
        if (table && table.textContent.includes('Facilities Preparation')) {
            facilitiesSection = section;
        }
    });
    
    if (!facilitiesSection) {
        console.log("❌ Facilities preparation section not found for loading");
        return;
    }
    
    const tableRows = facilitiesSection.querySelectorAll('.table-header-dark tbody tr');
    const taskIds = [
        'water_system_checked',
        'heating_system_checked',
        'standby_generator_checked',
        'monitoring_system_checked',
        'ventilation_system_checked',
        'light_system_checked',
        'drinkers_feeders_checked',
        'bedding_material_checked'
    ];
    
    tableRows.forEach((row, index) => {
        if (index < taskIds.length) {
            const taskId = taskIds[index];
            const taskData = data.facilities_preparation[taskId];
            
            if (!taskData) return;
            
            const inputs = row.querySelectorAll('input, textarea');
            
            // Load standard rows (date + description)
            const dateInput = inputs[0];
            const descriptionInput = inputs[1];
            
            if (dateInput && taskData.date_completed) {
                dateInput.value = taskData.date_completed;
            }
            if (descriptionInput && taskData.description_results) {
                descriptionInput.value = taskData.description_results;
            }
        }
    });
    
    console.log("✅ Facilities preparation data loaded successfully!");
}

async function loadPestControlData(data) {
    if (!data.pest_control) {
        console.log("📄 No pest control data to load");
        return;
    }
    
    console.log("🐭 Loading pest control data...");
    
    // Find the pest control section
    const allSections = document.querySelectorAll('.section');
    let pestControlSection = null;
    
    allSections.forEach(section => {
        const table = section.querySelector('.table-header-dark');
        if (table && table.textContent.includes('Pest Control - Describe the pest control methods used')) {
            pestControlSection = section;
        }
    });
    
    if (!pestControlSection) {
        console.log("❌ Pest control section not found for loading");
        return;
    }
    
    const tableRows = pestControlSection.querySelectorAll('.table-header-dark tbody tr');
    const taskIds = [
        'describe_barn_repairs',
        'vegetation_cut_around_buildings',
        'caz_kept_maintained',
        'rodent_controls_used',
        'wild_bird_controls_used',
        'fly_controls_used',
        'insecticides_used',
        'other_pests_controls',
        'no_pets_in_ra'
    ];
    
    tableRows.forEach((row, index) => {
        if (index < taskIds.length) {
            const taskId = taskIds[index];
            const taskData = data.pest_control[taskId];
            
            if (!taskData) return;
            
            const inputs = row.querySelectorAll('input, textarea');
            
            if (taskId === 'no_pets_in_ra') {
                // Load "No pets in the RA" row (date + signature)
                const dateInput = inputs[0];
                const signatureInput = inputs[1];
                
                if (dateInput && taskData.date_completed) {
                    dateInput.value = taskData.date_completed;
                }
                if (signatureInput && taskData.signature) {
                    signatureInput.value = taskData.signature;
                }
            } else {
                // Load standard rows (date + description/product)
                const dateInput = inputs[0];
                const descriptionInput = inputs[1];
                
                if (dateInput && taskData.date_completed) {
                    dateInput.value = taskData.date_completed;
                }
                if (descriptionInput && taskData.description_product) {
                    descriptionInput.value = taskData.description_product;
                }
            }
        }
    });
    
    console.log("✅ Pest control data loaded successfully!");
}

async function loadMedicationsData(data) {
    if (!data.medications || !data.medications.medications) {
        console.log("📄 No medications data to load");
        return;
    }
    
    console.log("💊 Loading medications data...");
    
    // Find the medications section
    const allSections = document.querySelectorAll('.section');
    let medicationsSection = null;
    
    allSections.forEach(section => {
        const header = section.querySelector('.section-header');
        if (header && header.textContent.includes('Medications - Complete the following table')) {
            medicationsSection = section;
        }
    });
    
    if (!medicationsSection) {
        console.log("❌ Medications section not found for loading");
        return;
    }
    
    const medicationsTableBody = medicationsSection.querySelector('table tbody');
    
    if (medicationsTableBody) {
        // Clear existing rows except the first one
        const existingRows = medicationsTableBody.querySelectorAll('tr');
        for (let i = 1; i < existingRows.length; i++) {
            existingRows[i].remove();
        }
        
        // Load all medication entries
        data.medications.medications.forEach((medication, index) => {
            let targetRow;
            
            // Use existing first row or create new row
            if (index === 0) {
                targetRow = medicationsTableBody.querySelector('tr');
            } else {
                // Create new row for additional entries
                const rowIndex = index + 1;
                targetRow = document.createElement('tr');
                targetRow.innerHTML = `
                    <td><input type="text" class="table-input" placeholder="Medication name"></td>
                    <td>
                        <div class="checkbox-container">
                            <input type="checkbox" id="feed${rowIndex}">
                            <label for="feed${rowIndex}">feed</label>
                        </div>
                        <div class="checkbox-container">
                            <input type="checkbox" id="water${rowIndex}">
                            <label for="water${rowIndex}">water</label>
                        </div>
                    </td>
                    <td><input type="date" class="table-input"></td>
                    <td><input type="date" class="table-input"></td>
                    <td><input type="text" class="table-input" placeholder="Actions"></td>
                    <td><input type="text" class="table-input" placeholder="Control measures"></td>
                    <td style="text-align: center;">
                        <button type="button" class="delete-medication-row" style="background-color: #f44336; color: white; border: none; border-radius: 3px; width: 25px; height: 25px; cursor: pointer; font-size: 16px;" onclick="deleteMedicationRow(this)">✕</button>
                    </td>
                `;
                medicationsTableBody.appendChild(targetRow);
            }
            
            const inputs = targetRow.querySelectorAll('input, select');
            const checkboxes = targetRow.querySelectorAll('input[type="checkbox"]');
            
            // Load medication name
            const medicationNameInput = targetRow.querySelector('input[type="text"]');
            if (medicationNameInput && medication.name) {
                medicationNameInput.value = medication.name;
            }
            
            // Load route of administration checkboxes
            const feedCheckbox = targetRow.querySelector('input[id*="feed"]') || checkboxes[0];
            const waterCheckbox = targetRow.querySelector('input[id*="water"]') || checkboxes[1];
            
            if (feedCheckbox && medication.route_of_administration) {
                feedCheckbox.checked = medication.route_of_administration.feed;
            }
            if (waterCheckbox && medication.route_of_administration) {
                waterCheckbox.checked = medication.route_of_administration.water;
            }
            
            // Load water medicator test dates
            const dateInputs = targetRow.querySelectorAll('input[type="date"]');
            if (dateInputs[0] && medication.water_medicator_tested?.date) {
                dateInputs[0].value = medication.water_medicator_tested.date;
            }
            if (dateInputs[1] && medication.water_medicator_tested?.results) {
                dateInputs[1].value = medication.water_medicator_tested.results;
            }
            
            // Load corrective actions and control measures
            const textInputs = targetRow.querySelectorAll('input[type="text"]');
            if (textInputs.length > 1 && medication.corrective_actions) {
                const correctiveActions = textInputs[textInputs.length - 2];
                if (correctiveActions) {
                    correctiveActions.value = medication.corrective_actions;
                }
            }
            
            if (textInputs.length > 0 && medication.control_measures) {
                const controlMeasures = textInputs[textInputs.length - 1];
                if (controlMeasures) {
                    controlMeasures.value = medication.control_measures;
                }
            }
        });
    }
    
    console.log("✅ Medications data loaded successfully!");
}

async function loadDeviationChartData(data) {
    if (!data.deviation_chart) {
        console.log("📄 No deviation chart data to load");
        return;
    }
    
    console.log("📊 Loading deviation chart data...");
    
    // Find the deviation chart section
    const allSections = document.querySelectorAll('.section');
    let deviationSection = null;
    
    allSections.forEach(section => {
        const header = section.querySelector('.section-header');
        if (header && header.textContent.includes('Deviation Chart')) {
            deviationSection = section;
        }
    });
    
    if (!deviationSection) {
        console.log("❌ Deviation chart section not found for loading");
        return;
    }
    
    // Load deviation type checkboxes
    if (data.deviation_chart.deviation_types_checkboxes) {
        const checkboxes = deviationSection.querySelectorAll('input[type="checkbox"]');
        const checkboxIds = ['temp', 'lighting', 'humidity', 'mortality', 'bedding', 'medication', 'alarms'];
        
        checkboxes.forEach((checkbox, index) => {
            if (index < checkboxIds.length) {
                const checkboxId = checkboxIds[index];
                if (data.deviation_chart.deviation_types_checkboxes[checkboxId] !== undefined) {
                    checkbox.checked = data.deviation_chart.deviation_types_checkboxes[checkboxId];
                }
            }
        });
        
        console.log("✅ Deviation type checkboxes loaded!");
    }
    
// Load deviation table data
    if (data.deviation_chart.deviations && data.deviation_chart.deviations.length > 0) {
        const deviationTableBody = deviationSection.querySelector('table tbody');
        
        if (deviationTableBody) {
            // Clear existing rows except the first one
            const existingRows = deviationTableBody.querySelectorAll('tr');
            for (let i = 1; i < existingRows.length; i++) {
                existingRows[i].remove();
            }
            
    data.deviation_chart.deviations.forEach((deviation, index) => {
            let targetRow;
                // Use existing first row or create new row
                if (index === 0) {
                    targetRow = deviationTableBody.querySelector('tr');
                } else {
                    // Create new row for additional entries
                    targetRow = document.createElement('tr');
                    targetRow.innerHTML = `
                        <td><input type="date" class="table-input"></td>
                        <td><textarea class="table-input" placeholder="Describe deviation"></textarea></td>
                        <td><textarea class="table-input" placeholder="Reason for deviation"></textarea></td>
                        <td><textarea class="table-input" placeholder="Corrective actions"></textarea></td>
                        <td style="text-align: center;">
                            <button type="button" class="delete-deviation-row" style="background-color: #f44336; color: white; border: none; border-radius: 3px; width: 25px; height: 25px; cursor: pointer; font-size: 16px;" onclick="deleteDeviationRow(this)">✕</button>
                        </td>
                    `;
                    deviationTableBody.appendChild(targetRow);
                }
                
                const inputs = targetRow.querySelectorAll('input, textarea');
                
                if (inputs.length >= 4) {
                    // Load date
                    if (inputs[0] && deviation.date) {
                        inputs[0].value = deviation.date;
                    }
                    
                    // Load description of deviation
                    if (inputs[1] && deviation.description_of_deviation) {
                        inputs[1].value = deviation.description_of_deviation;
                    }
                    
                    // Load reason for deviation
                    if (inputs[2] && deviation.reason_for_deviation) {
                        inputs[2].value = deviation.reason_for_deviation;
                    }
                    
                    // Load actions taken to correct
                    if (inputs[3] && deviation.actions_taken_to_correct) {
                        inputs[3].value = deviation.actions_taken_to_correct;
                    }
                }
            });
        }
        
        console.log("✅ Deviation table data loaded!");
    }
    console.log("✅ Deviation chart data loaded successfully!");
}


// ✅ Wait for DOM to load, then setup listeners
if (document.readyState === 'loading') {
   document.addEventListener('DOMContentLoaded', function() {
       setupFlockLogListener();
       
       const saveButton = document.getElementById('saveFormButton');
       if (saveButton) {
           saveButton.addEventListener('click', saveFormData);
       }
       
       // Load existing data when page loads
       loadFormData();
   });
} else {
   setupFlockLogListener();
   
   const saveButton = document.getElementById('saveFormButton');
   if (saveButton) {
       saveButton.addEventListener('click', saveFormData);
   }
   
   // Load existing data when page loads
   loadFormData();
}

// Chick Quality Assessment - Radio button behavior and default selection
function setupChickQualityBehavior(skipDefaults = false) {
    console.log("🐣 Setting up chick quality behavior...", skipDefaults ? "(no defaults)" : "(with defaults)");
    
    const chickTable = document.querySelector('.table-header-dark');
    if (!chickTable) {
        console.log("❌ Chick table not found");
        return;
    }
    
    const tableRows = chickTable.querySelectorAll('tbody tr');
    console.log("Found chick table rows:", tableRows.length);
    
    // Set default checkboxes and add radio button behavior
    tableRows.forEach((row, index) => {
        const checkboxes = row.querySelectorAll('input[type="checkbox"]');
        console.log(`Row ${index} checkboxes:`, checkboxes.length);
        
        if (checkboxes.length >= 4) {
            // Only set defaults if not skipping and no checkboxes are already checked
            if (!skipDefaults) {
                const hasAnyChecked = Array.from(checkboxes).some(cb => cb.checked);
                if (!hasAnyChecked) {
                    checkboxes[0].checked = true; // Upon Receipt - Acceptable
                    checkboxes[2].checked = true; // 3-4 Day-old - Acceptable
                    console.log(`✅ Set defaults for row ${index}`);
                }
            }
            
            // Add radio button behavior (always add this)
            checkboxes[0].addEventListener('change', function() {
                if (this.checked) checkboxes[1].checked = false;
            });
            checkboxes[1].addEventListener('change', function() {
                if (this.checked) checkboxes[0].checked = false;
            });
            checkboxes[2].addEventListener('change', function() {
                if (this.checked) checkboxes[3].checked = false;
            });
            checkboxes[3].addEventListener('change', function() {
                if (this.checked) checkboxes[2].checked = false;
            });
        }
    });
}

// Call the function when DOM loads and with delays (with defaults for new forms)
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', function() {
        setTimeout(() => setupChickQualityBehavior(false), 100);
    });
} else {
    setTimeout(() => setupChickQualityBehavior(false), 100);
}

// Modified loadFormData to skip defaults after loading
const originalLoadFormData = loadFormData;
loadFormData = async function() {
    await originalLoadFormData();
    // Skip defaults since we just loaded saved data
    setTimeout(() => setupChickQualityBehavior(true), 100);
    
    // Skip setting daily check defaults when loading saved data
    window.skipDailyCheckDefaults = true;
};
// Reset Form Function
async function resetFormData() {
    console.log("🔄 Resetting form data...");
    
    const resetButton = document.getElementById('resetFormButton');
    const resetStatus = document.getElementById('resetStatus');
    
    // Show confirmation dialog
    if (!confirm('Are you sure you want to reset all form data? This action cannot be undone.')) {
        return;
    }
    
// Check if we're on mobile
    const isMobile = window.innerWidth <= 768;
    
    // Disable button and show loading
    resetButton.disabled = true;
    if (!isMobile) {
        resetButton.textContent = '⏳ Resetting...';
    }
    resetStatus.textContent = 'Resetting all form data...';
    resetStatus.style.color = 'orange';
    try {
// Clear all text inputs (set defaults for specific placeholders)
document.querySelectorAll('input[type="text"]').forEach(input => {
    if (input.placeholder === "Chris Rose") {
        input.value = 'Chris Rose';
    } else if (input.placeholder === "Yes") {
        input.value = 'Yes';
    } else if (input.placeholder === "Truck") {
        input.value = 'Truck';
    } else if (input.placeholder === "Product name") {
        input.value = 'Chlorine';
    } else if (input.placeholder === "Location/procedure") {
        input.value = 'Removed by Linde Poultry Service';
    } else if (input.placeholder === "Service/procedure") {
        input.value = 'Blown down by Linde Poultry Service';
} else if (input.placeholder === "Service/product") {
    input.value = 'Barn washed by Clean And Scrub with Prevail';
} else if (input.placeholder === "Prevail Disinfectant") {
    input.value = 'Prevail Disinfectant';
} else if (input.placeholder === "See Linde Poultry Service") {
    input.value = 'See Linde Poultry Service';
} else if (input.placeholder === "N/A") {
    input.value = 'N/A';
    } else {
        input.value = '';
    }
});

// Clear all textareas (set defaults for specific placeholders)
document.querySelectorAll('textarea').forEach(textarea => {
    if (textarea.placeholder === "Description of repairs") {
        textarea.value = 'Ok, no issues';
    } else if (textarea.placeholder === "Description") {
        textarea.value = 'Bin in good condition';
    } else {
        textarea.value = '';
    }
});

        // Clear all date inputs
        document.querySelectorAll('input[type="date"]').forEach(input => {
            input.value = '';
        });
        
        // Clear all number inputs
        document.querySelectorAll('input[type="number"]').forEach(input => {
            input.value = '';
        });
        
        // Clear feed notes
const feedNotesTextarea = document.getElementById('feedNotes');
if (feedNotesTextarea) {
    feedNotesTextarea.value = '';
}

// Clear feed transfer notes  
const feedTransferNotesTextarea = document.getElementById('feedTransferNotes');
if (feedTransferNotesTextarea) {
    feedTransferNotesTextarea.value = '';
}

        // Clear all textareas
        document.querySelectorAll('textarea').forEach(textarea => {
            textarea.value = '';
        });
        
        // Remove extra Water rows (keep only the first row)
const waterSections = document.querySelectorAll('.section');
let waterSection = null;

waterSections.forEach(section => {
    const header = section.querySelector('.section-header');
    if (header && header.textContent.includes('Water - Record all products')) {
        waterSection = section;
    }
});

if (!waterSection) {
    // Fallback to first section
    waterSection = document.querySelector('.section');
}

if (waterSection) {
    const waterTableBody = waterSection.querySelector('.table-header-dark tbody');
    if (waterTableBody) {
        const rows = waterTableBody.querySelectorAll('tr');
        // Remove all rows except the first one
        for (let i = 1; i < rows.length; i++) {
            rows[i].remove();
        }
    }
}

// Remove extra Feed rows (keep only the first entry and its note row)
const allSections = document.querySelectorAll('.section');
let feedSection = null;

allSections.forEach(section => {
    const header = section.querySelector('.section-header');
    if (header && header.textContent.trim() === 'Feed') {
        feedSection = section;
    }
});

if (!feedSection) {
    feedSection = Array.from(allSections).find(section => 
        section.textContent.includes('Record the dates of feed samples')
    );
}

if (feedSection) {
    const feedTableBody = feedSection.querySelector('.table-header-dark tbody');
    if (feedTableBody) {
        const rows = feedTableBody.querySelectorAll('tr');
        // Remove all rows except the first entry and its note row
        for (let i = 2; i < rows.length; i++) {
            rows[i].remove();
        }
        
        // Ensure the first note row exists
        if (rows.length === 1 || !rows[1] || !rows[1].classList.contains('note-row')) {
            // Create and insert the missing note row
            const noteRow = document.createElement('tr');
            noteRow.className = 'note-row';
        noteRow.innerHTML = `
    <td colspan="4">
        <div style="padding: 5px;">
            <label style="font-weight: bold; font-size: 10px;">Entry Notes:</label>
            <textarea class="entry-note-input" placeholder="Notes for this entry..." style="width: 100%; min-height: 40px; max-height: 120px; resize: vertical; margin-top: 3px; padding: 4px; font-size: 10px; border: 1px solid #ccc;"></textarea>
        </div>
    </td>
`;
            
            // Insert after the first row
            if (rows[0]) {
                rows[0].insertAdjacentElement('afterend', noteRow);
            } else {
                feedTableBody.appendChild(noteRow);
            }
        }
    }
}
      // Remove extra Feed Transfer rows (keep only the first entry and its note row)
const feedTransferSection = Array.from(document.querySelectorAll('.section')).find(section => {
    const header = section.querySelector('.section-header');
    return header && header.textContent.trim() === 'Feed Transfer Record';
});

if (feedTransferSection) {
    const feedTransferTableBody = feedTransferSection.querySelector('.table-header-dark tbody');
    if (feedTransferTableBody) {
        const rows = feedTransferTableBody.querySelectorAll('tr');
        // Remove all rows except the first entry and its note row
        for (let i = 2; i < rows.length; i++) {
            rows[i].remove();
        }
        
        // Ensure the first note row exists
        if (rows.length === 1 || !rows[1] || !rows[1].classList.contains('note-row')) {
            // Create and insert the missing note row
            const noteRow = document.createElement('tr');
            noteRow.className = 'note-row';
         noteRow.innerHTML = `
    <td colspan="8">
        <div style="padding: 5px;">
            <label style="font-weight: bold; font-size: 10px;">Notes:</label>
            <textarea class="entry-note-input" placeholder="Notes for this entry..." style="width: 100%; min-height: 40px; max-height: 120px; resize: vertical; margin-top: 3px; padding: 4px; font-size: 10px; border: 1px solid #ccc;"></textarea>
        </div>
    </td>
`;
            
            // Insert after the first row
            if (rows[0]) {
                rows[0].insertAdjacentElement('afterend', noteRow);
            } else {
                feedTransferTableBody.appendChild(noteRow);
            }
        }
    }
}

// Remove extra Deviation rows (keep only the first row)
const deviationSection = Array.from(document.querySelectorAll('.section')).find(section => {
    const header = section.querySelector('.section-header');
    return header && header.textContent.includes('Deviation Chart');
});

if (deviationSection) {
    const deviationTableBody = deviationSection.querySelector('table tbody');
    if (deviationTableBody) {
        const rows = deviationTableBody.querySelectorAll('tr');
        // Remove all rows except the first one
        for (let i = 1; i < rows.length; i++) {
            rows[i].remove();
        }
    }
}

// Remove extra Medication rows (keep only the first row)
const medicationsSection = Array.from(document.querySelectorAll('.section')).find(section => {
    const header = section.querySelector('.section-header');
    return header && header.textContent.includes('Medications - Complete the following table');
});

if (medicationsSection) {
    const medicationsTableBody = medicationsSection.querySelector('table tbody');
    if (medicationsTableBody) {
        const rows = medicationsTableBody.querySelectorAll('tr');
        // Remove all rows except the first one
        for (let i = 1; i < rows.length; i++) {
            rows[i].remove();
        }
    }
}

        // Clear all select dropdowns
        document.querySelectorAll('select').forEach(select => {
            select.selectedIndex = 0;
        });
        
       // Uncheck all checkboxes
        document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
            checkbox.checked = false;
        });
        
  // Set default checkboxes back to checked after reset
setTimeout(() => {
    const option1DetergentCheckbox = document.getElementById('option1_detergent');
    const option1DisinfectantCheckbox = document.getElementById('option1_disinfectant');
    const flushCheckbox = document.getElementById('flush');
    
    if (option1DetergentCheckbox) {
        option1DetergentCheckbox.checked = true;
    }
    if (option1DisinfectantCheckbox) {
        option1DisinfectantCheckbox.checked = true;
    }
    if (flushCheckbox) {
        flushCheckbox.checked = true;
    }
    
    // Reset all Daily Checks checkboxes to checked
    const dailyCheckIds = ['feedquality', 'thermal', 'templevels', 'humiditylevels', 'wateravail', 'flockhealth', 'ventilation', 'ammonialevels', 'waterquality', 'heatingsystem', 'lightingsystem', 'litterquality', 'birdsinspected'];
    
    dailyCheckIds.forEach(id => {
        const checkbox = document.getElementById(id);
        if (checkbox) {
            checkbox.checked = true;
        }
    });
}, 50);
     // Reset chick quality to default (Acceptable checkboxes checked)
        setTimeout(() => {
            setupChickQualityBehavior(false); // false = set defaults
        }, 100);
      // Delete from Firestore
const docRef = doc(db, 'vas-b1-fl', 'vas-b1-f1');
await deleteDoc(docRef);

// Set defaults immediately after reset
setDefaultFarmRep();

// Success feedback
resetButton.disabled = false;
if (!isMobile) {
    resetButton.textContent = '🔄 Reset Page';
}
resetStatus.textContent = '✅ Form reset successfully!';
resetStatus.style.color = 'green';
        
        console.log("✅ Form reset completed!");
        
        // Clear success message after 3 seconds
        setTimeout(() => {
            resetStatus.textContent = '';
        }, 3000);
        
    } catch (error) {
        console.error("❌ Error resetting form:", error);
        
    resetButton.disabled = false;
if (!isMobile) {
    resetButton.textContent = '🔄 Reset Page';
}
resetStatus.textContent = '❌ Error resetting form. Please try again.';
resetStatus.style.color = 'red';
        
        // Clear error message after 5 seconds
        setTimeout(() => {
            resetStatus.textContent = '';
        }, 5000);
    }
}

// Attach reset function to button
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', function() {
        const resetButton = document.getElementById('resetFormButton');
        if (resetButton) {
            resetButton.addEventListener('click', resetFormData);
        }
    });
} else {
    const resetButton = document.getElementById('resetFormButton');
    if (resetButton) {
        resetButton.addEventListener('click', resetFormData);
    }
}

function setDefaultFarmRep() {
    // Set defaults for all placeholder inputs
    const defaultInputs = [
        { placeholder: "Chris Rose", value: "Chris Rose" },
        { placeholder: "Yes", value: "Yes" },
        { placeholder: "Truck", value: "Truck" }
    ];
    
    defaultInputs.forEach(({ placeholder, value }) => {
        const inputs = document.querySelectorAll(`input[placeholder="${placeholder}"]`);
        inputs.forEach(input => {
            if (!input.value) {
                input.value = value;
            }
        });
    });
    
// Set defaults for barn cleaning, facilities, and pest control placeholders
const additionalDefaults = [
    { placeholder: "Product name", value: "Chlorine" },
    { placeholder: "Location/procedure", value: "Removed by Linde Poultry Service" },
    { placeholder: "Service/procedure", value: "Blown down by Linde Poultry Service" },
{ placeholder: "Service/product", value: "Barn washed by Clean And Scrub with Prevail" },
{ placeholder: "See Linde Poultry Service", value: "See Linde Poultry Service" },
{ placeholder: "N/A", value: "N/A" },
    { placeholder: "Dates of filters/bulbs changed", value: "Dates of filters/bulbs changed" },
    { placeholder: "Status", value: "Good" },
    { placeholder: "Test results", value: "Tested Ok" },
    { placeholder: "Condition and type", value: "Good Condition - Wood shavings" },
    { placeholder: "Product/method", value: "Bait boxes in place - See program" },
    { placeholder: "Product", value: "Agita" },
    { placeholder: "Controls", value: "None" },
    { placeholder: "Signature", value: "Chris Rose" }
];

additionalDefaults.forEach(({ placeholder, value }) => {
    const inputs = document.querySelectorAll(`input[placeholder="${placeholder}"]`);
    inputs.forEach(input => {
        if (!input.value && !input.hasAttribute('data-loaded')) {
            input.value = value;
        }
    });
});

// Special handling for "Prevail Disinfectant" - ensure it's always set as real text
const prevailInputs = document.querySelectorAll('input[placeholder="Prevail Disinfectant"]');
prevailInputs.forEach(input => {
    if (!input.hasAttribute('data-loaded')) {
        input.value = 'Prevail Disinfectant';
    }
});

// Special handling for CAZ kept maintained - should be "Yes" instead of "Good"
const pestControlSection = Array.from(document.querySelectorAll('.section')).find(section => {
    const table = section.querySelector('.table-header-dark');
    return table && table.textContent.includes('Pest Control');
});

if (pestControlSection) {
    const cazRow = Array.from(pestControlSection.querySelectorAll('tr')).find(row => 
        row.textContent.includes('CAZ kept maintained')
    );
 if (cazRow) {
    const cazInput = cazRow.querySelector('input[placeholder="Status"]');
    if (cazInput && !cazInput.hasAttribute('data-loaded')) {
        cazInput.value = 'Yes';
    }
}

// Special handling for Wild bird controls used - should be "Screens in place"
const wildBirdRow = Array.from(pestControlSection.querySelectorAll('tr')).find(row => 
    row.textContent.includes('Wild bird controls used')
);
if (wildBirdRow) {
    const wildBirdInput = wildBirdRow.querySelector('input[placeholder="Product/method"]');
    if (wildBirdInput && !wildBirdInput.hasAttribute('data-loaded')) {
        wildBirdInput.value = 'Screens in place';
    }
}
}
// Set defaults for textareas
const textareaDefaults = [
    { placeholder: "Description of repairs", value: "Ok, no issues" },
    { placeholder: "Description", value: "Bin in good condition" }
];
textareaDefaults.forEach(({ placeholder, value }) => {
    const textareas = document.querySelectorAll(`textarea[placeholder="${placeholder}"]`);
    textareas.forEach(textarea => {
        if (!textarea.value) {
            textarea.value = value;
        }
    });
});

 // Handle feed signature separately by ID
    const feedSignatureInput = document.getElementById('feedSignature');
    if (feedSignatureInput && !feedSignatureInput.value) {
        feedSignatureInput.value = 'Chris Rose';
    }
    
    // Set Option 1 checkboxes as checked by default
    const option1DetergentCheckbox = document.getElementById('option1_detergent');
    const option1DisinfectantCheckbox = document.getElementById('option1_disinfectant');
    
    if (option1DetergentCheckbox) {
        option1DetergentCheckbox.checked = true;
    }
    if (option1DisinfectantCheckbox) {
        option1DisinfectantCheckbox.checked = true;
    }
    
 // Set Flush checkbox as checked by default
    const flushCheckbox = document.getElementById('flush');
    if (flushCheckbox) {
        flushCheckbox.checked = true;

        // Set all Daily Checks checkboxes as checked by default
    const dailyCheckIds = ['feedquality', 'thermal', 'templevels', 'humiditylevels', 'wateravail', 'flockhealth', 'ventilation', 'ammonialevels', 'waterquality', 'heatingsystem', 'lightingsystem', 'litterquality', 'birdsinspected'];
    
    dailyCheckIds.forEach(id => {
        const checkbox = document.getElementById(id);
        if (checkbox && !checkbox.hasAttribute('data-loaded')) {
            checkbox.checked = true;
        }
    });

    }
    
    

// Set all Daily Checks checkboxes as checked by default (only if not loading saved data)
    if (!window.skipDailyCheckDefaults) {
        const dailyCheckIds = ['feedquality', 'thermal', 'templevels', 'humiditylevels', 'wateravail', 'flockhealth', 'ventilation', 'ammonialevels', 'waterquality', 'heatingsystem', 'lightingsystem', 'litterquality', 'birdsinspected'];
        
        dailyCheckIds.forEach(id => {
            const checkbox = document.getElementById(id);
            if (checkbox) {
                checkbox.checked = true;
            }
        });
    }
}

// ===== UPDATED FEED ENTRY FUNCTION =====
function addFeedEntry() {
    console.log("Adding new feed entry...");
    
    const allSections = document.querySelectorAll('.section');
    let feedSection = null;
    
    allSections.forEach(section => {
        const header = section.querySelector('.section-header');
        if (header && header.textContent.trim() === 'Feed') {
            feedSection = section;
        }
    });
    
    if (!feedSection) {
        feedSection = Array.from(allSections).find(section => 
            section.textContent.includes('Record the dates of feed samples')
        );
    }
    
    if (!feedSection) {
        console.error("❌ Feed section still not found");
        return;
    }
    
    const feedTableBody = feedSection.querySelector('.table-header-dark tbody');
    
    if (!feedTableBody) {
        console.error("❌ Feed table body not found");
        return;
    }
    
    // Create entry row (no styling applied here)
    const newRow = document.createElement('tr');
    newRow.innerHTML = `
        <td><input type="date" class="table-input"></td>
        <td><textarea class="table-input" placeholder="Enter ingredients"></textarea></td>
        <td><input type="date" class="table-input"></td>
        <td style="text-align: center;">
            <button type="button" class="delete-feed-row" style="background-color: #f44336; color: white; border: none; border-radius: 3px; width: 25px; height: 25px; cursor: pointer; font-size: 16px;" onclick="deleteFeedRow(this)">✕</button>
        </td>
    `;
    
    // Create note row (no styling applied here)
    const noteRow = document.createElement('tr');
    noteRow.className = 'note-row';
    noteRow.innerHTML = `
    <td colspan="4">
        <div style="padding: 5px;">
            <label style="font-weight: bold; font-size: 10px;">Notes:</label>
            <textarea class="entry-note-input" placeholder="Notes for this entry..." style="width: 100%; min-height: 40px; max-height: 120px; resize: vertical; margin-top: 3px; padding: 4px; font-size: 10px; border: 1px solid #ccc;"></textarea>
        </div>
    </td>
`;
    
    feedTableBody.appendChild(newRow);
    feedTableBody.appendChild(noteRow);
    
    // Apply styling to all rows after adding
    applyAlternatingRowStyling(feedTableBody, 'feed');
    
    console.log("✅ New feed entry with note added successfully!");
    
    // AUTO-SAVE AFTER ADDING ENTRY
    console.log("💾 Auto-saving new feed entry...");
    saveFormData();
}

// ===== UPDATED DELETE FUNCTIONS =====
function deleteFeedRow(button) {
    console.log("🗑️ Delete feed button clicked");
    
    if (confirm('Are you sure you want to delete this feed entry?')) {
        const row = button.closest('tr');
        if (row) {
            const feedTableBody = row.closest('tbody');
            
            // Always delete the note row that follows
            const noteRow = row.nextElementSibling;
            if (noteRow && noteRow.classList.contains('note-row')) {
                noteRow.remove();
            }
            row.remove();
            
            // Reapply styling to all remaining rows
            if (feedTableBody) {
                applyAlternatingRowStyling(feedTableBody, 'feed');
            }
            
            console.log("✅ Feed entry and note deleted successfully!");
            
            // Auto-save after deletion
            console.log("💾 Auto-saving after deletion...");
            saveFormData();
        }
    }
}
// Make function globally accessible
window.deleteFeedRow = deleteFeedRow;

// Attach the function to the button when page loads
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', function() {
        const addFeedButton = document.getElementById('addFeedEntryButton');
        if (addFeedButton) {
            addFeedButton.addEventListener('click', addFeedEntry);
        }
    });
} else {
    const addFeedButton = document.getElementById('addFeedEntryButton');
    if (addFeedButton) {
        addFeedButton.addEventListener('click', addFeedEntry);
    }
}



// Add Water Entry Function
// Add Water Entry Function
// Add Water Entry Function - IMPROVED VERSION
// Modified Add Water Entry Function with Auto-Save
function addWaterEntry() {
    console.log("Adding new water entry...");
    
    const waterSections = document.querySelectorAll('.section');
    let waterSection = null;
    
    waterSections.forEach(section => {
        const header = section.querySelector('.section-header');
        if (header && header.textContent.includes('Water - Record all products')) {
            waterSection = section;
        }
    });
    
    if (!waterSection) {
        waterSection = document.querySelector('.section');
    }
    
    const waterTableBody = waterSection?.querySelector('.table-header-dark tbody');
    
    if (!waterTableBody) {
        console.error("❌ Water table body not found");
        return;
    }
    
    const newRow = document.createElement('tr');
    newRow.innerHTML = `
        <td><input type="text" class="table-input" placeholder="Product name" value="Chlorine"></td>
        <td><input type="date" class="table-input"></td>
        <td><input type="date" class="table-input"></td>
        <td><input type="text" class="table-input" placeholder="Results"></td>
        <td style="text-align: center;">
            <button type="button" class="delete-water-row" style="background-color: #f44336; color: white; border: none; border-radius: 3px; width: 25px; height: 25px; cursor: pointer; font-size: 16px;" onclick="deleteWaterRow(this)">✕</button>
        </td>
    `;
    
    waterTableBody.appendChild(newRow);
    
    console.log("✅ New water entry added successfully!");
    
    // AUTO-SAVE AFTER ADDING ENTRY
    console.log("💾 Auto-saving new water entry...");
    saveFormData();
}

// Delete Water Row Function with Auto-Save
function deleteWaterRow(button) {
    console.log("🗑️ Delete button clicked");
    
    if (confirm('Are you sure you want to delete this water entry?')) {
        const row = button.closest('tr');
        if (row) {
            row.remove();
            console.log("✅ Water entry deleted successfully!");
            
            // Auto-save after deletion
            console.log("💾 Auto-saving after deletion...");
            saveFormData();
        }
    }
}
// Make function globally accessible
window.deleteWaterRow = deleteWaterRow;
// Attach the function to the button when page loads
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', function() {
        const addWaterButton = document.getElementById('addWaterEntryButton');
        if (addWaterButton) {
            addWaterButton.addEventListener('click', addWaterEntry);
        }
    });
} else {
    const addWaterButton = document.getElementById('addWaterEntryButton');
    if (addWaterButton) {
        addWaterButton.addEventListener('click', addWaterEntry);
    }
}

// Call when page loads (before loading saved data)
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', function() {
        setDefaultFarmRep();
    });
} else {
    setDefaultFarmRep();
}

// ===== UPDATED FEED TRANSFER ENTRY FUNCTION =====
function addFeedTransferEntry() {
    console.log("Adding new feed transfer entry...");
    
    const allSections = document.querySelectorAll('.section');
    let feedTransferSection = null;
    
    allSections.forEach(section => {
        const header = section.querySelector('.section-header');
        if (header && header.textContent.trim() === 'Feed Transfer Record') {
            feedTransferSection = section;
        }
    });
    
    if (!feedTransferSection) {
        feedTransferSection = Array.from(allSections).find(section => 
            section.textContent.includes('Date feed moved')
        );
    }
    
    if (!feedTransferSection) {
        console.error("❌ Feed Transfer Record section still not found");
        return;
    }
    
    const feedTransferTableBody = feedTransferSection.querySelector('.table-header-dark tbody');
    
    if (!feedTransferTableBody) {
        console.error("❌ Feed Transfer Record table body not found");
        return;
    }
    
    // Create entry row (no styling applied here)
    const newRow = document.createElement('tr');
    newRow.innerHTML = `
        <td><input type="date" class="table-input"></td>
        <td><input type="text" class="table-input" placeholder="Farm/bin"></td>
        <td><input type="text" class="table-input" placeholder="Farm/bin"></td>
        <td><textarea class="table-input" placeholder="Medications"></textarea></td>
        <td><input type="text" class="table-input" placeholder="Truck" value="Truck"></td>
        <td>
            <select class="table-input">
                <option value="Yes" selected>Yes</option>
                <option value="No">No</option>
            </select>
        </td>
        <td><input type="text" class="table-input" placeholder="Yes" value="Yes"></td>
        <td style="text-align: center;">
            <button type="button" class="delete-feed-transfer-row" style="background-color: #f44336; color: white; border: none; border-radius: 3px; width: 25px; height: 25px; cursor: pointer; font-size: 16px;" onclick="deleteFeedTransferRow(this)">✕</button>
        </td>
    `;
    
    // Create note row (no styling applied here)
    const noteRow = document.createElement('tr');
    noteRow.className = 'note-row';
    noteRow.innerHTML = `
    <td colspan="8">
        <div style="padding: 5px;">
            <label style="font-weight: bold; font-size: 10px;">Notes:</label>
            <textarea class="entry-note-input" placeholder="Notes for this entry..." style="width: 100%; min-height: 40px; max-height: 120px; resize: vertical; margin-top: 3px; padding: 4px; font-size: 10px; border: 1px solid #ccc;"></textarea>
        </div>
    </td>
`;
    
    feedTransferTableBody.appendChild(newRow);
    feedTransferTableBody.appendChild(noteRow);
    
    // Apply styling to all rows after adding
    applyAlternatingRowStyling(feedTransferTableBody, 'feedTransfer');
    
    console.log("✅ New feed transfer entry with note added successfully!");
    
    // AUTO-SAVE AFTER ADDING ENTRY
    console.log("💾 Auto-saving new feed transfer entry...");
    saveFormData();
}


function deleteFeedTransferRow(button) {
    console.log("🗑️ Delete feed transfer button clicked");
    
    if (confirm('Are you sure you want to delete this feed transfer entry?')) {
        const row = button.closest('tr');
        if (row) {
            const feedTransferTableBody = row.closest('tbody');
            
            // Always delete the note row that follows
            const noteRow = row.nextElementSibling;
            if (noteRow && noteRow.classList.contains('note-row')) {
                noteRow.remove();
            }
            row.remove();
            
            // Reapply styling to all remaining rows
            if (feedTransferTableBody) {
                applyAlternatingRowStyling(feedTransferTableBody, 'feedTransfer');
            }
            
            console.log("✅ Feed transfer entry and note deleted successfully!");
            
            // Auto-save after deletion
            console.log("💾 Auto-saving after deletion...");
            saveFormData();
        }
    }
}
// ===== UPDATED LOADING FUNCTIONS =====
// ADD THIS TO THE END OF loadFormData() function:
function applyStylesAfterDataLoad() {
    // Apply styling to Feed section
    const feedSection = Array.from(document.querySelectorAll('.section')).find(section => {
        const header = section.querySelector('.section-header');
        return header && header.textContent.trim() === 'Feed';
    });
    
    if (feedSection) {
        const feedTableBody = feedSection.querySelector('.table-header-dark tbody');
        if (feedTableBody) {
            applyAlternatingRowStyling(feedTableBody, 'feed');
        }
    }
    
    // Apply styling to Feed Transfer section
    const feedTransferSection = Array.from(document.querySelectorAll('.section')).find(section => {
        const header = section.querySelector('.section-header');
        return header && header.textContent.trim() === 'Feed Transfer Record';
    });
    
    if (feedTransferSection) {
        const feedTransferTableBody = feedTransferSection.querySelector('.table-header-dark tbody');
        if (feedTransferTableBody) {
            applyAlternatingRowStyling(feedTransferTableBody, 'feedTransfer');
        }
    }
}

// ===== CALL STYLING AFTER PAGE LOADS =====
// Add this to your existing DOM ready event listeners:
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', function() {
        // Your existing code...
        
        // Apply initial styling after short delay to ensure HTML is rendered
        setTimeout(() => {
            applyStylesAfterDataLoad();
        }, 100);
    });
} else {
    // Your existing code...
    
    // Apply initial styling
    setTimeout(() => {
        applyStylesAfterDataLoad();
    }, 100);
}

// Make function globally accessible
window.deleteFeedTransferRow = deleteFeedTransferRow;

// Attach the function to the button when page loads
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', function() {
        const addFeedTransferButton = document.getElementById('addFeedTransferEntryButton');
        if (addFeedTransferButton) {
            addFeedTransferButton.addEventListener('click', addFeedTransferEntry);
        }
    });
} else {
    const addFeedTransferButton = document.getElementById('addFeedTransferEntryButton');
    if (addFeedTransferButton) {
        addFeedTransferButton.addEventListener('click', addFeedTransferEntry);
    }
}

// Modified Add Medication Entry Function with Auto-Save
function addMedicationEntry() {
    console.log("Adding new medication entry...");
    
    const allSections = document.querySelectorAll('.section');
    let medicationsSection = null;
    
    allSections.forEach(section => {
        const header = section.querySelector('.section-header');
        if (header && header.textContent.includes('Medications - Complete the following table')) {
            medicationsSection = section;
        }
    });
    
    if (!medicationsSection) {
        console.error("❌ Medications section not found");
        return;
    }
    
    const medicationsTableBody = medicationsSection.querySelector('table tbody');
    
    if (!medicationsTableBody) {
        console.error("❌ Medications table body not found");
        return;
    }
    
    const rowIndex = medicationsTableBody.querySelectorAll('tr').length + 1;
    
    const newRow = document.createElement('tr');
    newRow.innerHTML = `
        <td><input type="text" class="table-input" placeholder="Medication name"></td>
       <td>
    <div class="checkbox-container">
        <input type="checkbox" id="feed${rowIndex}" onchange="handleRouteChange(this, 'water${rowIndex}')">
        <label for="feed${rowIndex}">feed</label>
    </div>
    <div class="checkbox-container">
        <input type="checkbox" id="water${rowIndex}" onchange="handleRouteChange(this, 'feed${rowIndex}')">
        <label for="water${rowIndex}">water</label>
    </div>
</td>
        <td><input type="date" class="table-input"></td>
        <td><input type="date" class="table-input"></td>
        <td><input type="text" class="table-input" placeholder="Actions"></td>
        <td><input type="text" class="table-input" placeholder="Control measures"></td>
        <td style="text-align: center;">
            <button type="button" class="delete-medication-row" style="background-color: #f44336; color: white; border: none; border-radius: 3px; width: 25px; height: 25px; cursor: pointer; font-size: 16px;" onclick="deleteMedicationRow(this)">✕</button>
        </td>
    `;
    
    medicationsTableBody.appendChild(newRow);
    
    console.log("✅ New medication entry added successfully!");
    
    // AUTO-SAVE AFTER ADDING ENTRY
    console.log("💾 Auto-saving new medication entry...");
    saveFormData();
}

// Delete Medication Row Function
function deleteMedicationRow(button) {
    console.log("🗑️ Delete medication button clicked");
    
    if (confirm('Are you sure you want to delete this medication entry?')) {
        const row = button.closest('tr');
        if (row) {
            row.remove();
            console.log("✅ Medication entry deleted successfully!");
            
            // Auto-save after deletion
            console.log("💾 Auto-saving after deletion...");
            saveFormData();
        }
    }
}

// Make function globally accessible
window.deleteMedicationRow = deleteMedicationRow;

// Attach the function to the button when page loads
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', function() {
        const addMedicationButton = document.getElementById('addMedicationEntryButton');
        if (addMedicationButton) {
            addMedicationButton.addEventListener('click', addMedicationEntry);
        }
    });
} else {
    const addMedicationButton = document.getElementById('addMedicationEntryButton');
    if (addMedicationButton) {
        addMedicationButton.addEventListener('click', addMedicationEntry);
    }
}

// Modified Add Deviation Entry Function with Auto-Save
function addDeviationEntry() {
    console.log("Adding new deviation entry...");
    
    const allSections = document.querySelectorAll('.section');
    let deviationSection = null;
    
    allSections.forEach(section => {
        const header = section.querySelector('.section-header');
        if (header && header.textContent.includes('Deviation Chart')) {
            deviationSection = section;
        }
    });
    
    if (!deviationSection) {
        console.error("❌ Deviation Chart section not found");
        return;
    }
    
    const deviationTableBody = deviationSection.querySelector('table tbody');
    
    if (!deviationTableBody) {
        console.error("❌ Deviation Chart table body not found");
        return;
    }
    
    const newRow = document.createElement('tr');
    newRow.innerHTML = `
        <td><input type="date" class="table-input"></td>
        <td><textarea class="table-input" placeholder="Describe deviation"></textarea></td>
        <td><textarea class="table-input" placeholder="Reason for deviation"></textarea></td>
        <td><textarea class="table-input" placeholder="Corrective actions"></textarea></td>
        <td style="text-align: center;">
            <button type="button" class="delete-deviation-row" style="background-color: #f44336; color: white; border: none; border-radius: 3px; width: 25px; height: 25px; cursor: pointer; font-size: 16px;" onclick="deleteDeviationRow(this)">✕</button>
        </td>
    `;
    
    deviationTableBody.appendChild(newRow);
    
    console.log("✅ New deviation entry added successfully!");
    
    // AUTO-SAVE AFTER ADDING ENTRY
    console.log("💾 Auto-saving new deviation entry...");
    saveFormData();
}

// Delete Deviation Row Function
function deleteDeviationRow(button) {
    console.log("🗑️ Delete deviation button clicked");
    
    if (confirm('Are you sure you want to delete this deviation entry?')) {
        const row = button.closest('tr');
        if (row) {
            row.remove();
            console.log("✅ Deviation entry deleted successfully!");
            
            // Auto-save after deletion
            console.log("💾 Auto-saving after deletion...");
            saveFormData();
        }
    }
}

// Make function globally accessible
window.deleteDeviationRow = deleteDeviationRow;

// Attach the function to the button when page loads
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', function() {
        const addDeviationButton = document.getElementById('addDeviationEntryButton');
        if (addDeviationButton) {
            addDeviationButton.addEventListener('click', addDeviationEntry);
        }
    });
} else {
    const addDeviationButton = document.getElementById('addDeviationEntryButton');
    if (addDeviationButton) {
        addDeviationButton.addEventListener('click', addDeviationEntry);
    }
}

// Handle Route of Administration - only one can be selected
function handleRouteChange(checkedBox, otherBoxId) {
    if (checkedBox.checked) {
        const otherBox = document.getElementById(otherBoxId);
        if (otherBox) {
            otherBox.checked = false;
        }
    }
}

// Make function globally accessible
window.handleRouteChange = handleRouteChange;

// Apply radio button behavior to existing first row
document.addEventListener('DOMContentLoaded', function() {
    const feed1 = document.getElementById('feed1');
    const water1 = document.getElementById('water1');
    
    if (feed1 && water1) {
        feed1.onchange = function() { handleRouteChange(this, 'water1'); };
        water1.onchange = function() { handleRouteChange(this, 'feed1'); };
    }
});

// Sidebar toggle functionality
function toggleSidebar() {
    console.log("🔄 Toggling sidebar...");
    document.body.classList.toggle('sidebar-collapsed');
}

// Make function globally accessible
window.toggleSidebar = toggleSidebar;

// Navigation functionality for all nav buttons
function navigateToPage(filename) {
    console.log(`Navigating to: ${filename}`);
    window.location.href = filename;
}




// Add this to the end of your script
document.addEventListener('DOMContentLoaded', function() {
 // Create and append custom styling for Quick Nav on small laptops
 const customStyle = document.createElement('style');
 customStyle.textContent = `
   /* Improved Quick Nav Styling for laptop screens */
   @media screen and (min-width: 769px) and (max-width: 1366px) {
     /* Ensure the full nav is visible - increased by 10% + 12px height */
     .section-navigator {
       width: 180px; /* Increased from 164px to 180px (10% larger) */
       height: auto;
       min-height: calc(auto + 12px); /* Added 12px to minimum height */
       right: 5px;
       margin-top: 25px;
       top: calc(50% - 25px);
       transform: translateY(-50%);
       overflow: visible !important;
       padding: 19px 13px; /* Increased top/bottom padding by 6px each (total 12px) */
       box-shadow: 0 4px 15px rgba(0,0,0,0.15);
       max-height: none;
       z-index: 1002;
     }
     
     /* Reduce vertical spacing between items */
     .section-nav-items {
       gap: 3px !important;
       display: flex !important;
       flex-direction: column !important;
     }
     
     /* Improved text wrapping with adjusted padding for larger size */
     .section-nav-item {
       padding: 5px 10px !important;
       font-size: 10px !important;
       line-height: 1.2 !important;
       white-space: normal !important;
       border-radius: 6px !important;
       word-wrap: break-word !important;
       overflow-wrap: break-word !important;
       hyphens: none !important;
       display: block !important;
       text-align: left !important;
       height: auto !important;
       width: calc(100% - 6px) !important;
       box-sizing: border-box !important;
       margin: 0 3px !important;
       margin-bottom: 1px !important;
     }
     
     /* Improved header styling */
     .section-nav-header {
       font-size: 12px !important;
       margin-bottom: 8px !important; /* Increased from 5px to 8px for better spacing */
       padding-bottom: 6px !important; /* Increased from 4px to 6px */
       white-space: normal !important;
       text-align: center !important;
       width: calc(100% - 6px) !important;
       margin: 0 3px 8px 3px !important;
       overflow-wrap: break-word !important;
       hyphens: none !important;
     }
     
     /* Modified collapsed state - adjusted for larger size */
     .section-navigator.collapsed {
       transform: translateY(-50%) translateX(calc(100% - 35px)) !important;
     }
     
     /* Toggle button when collapsed */
     .section-navigator.collapsed .section-nav-toggle {
       width: 35px !important;
       height: 35px !important;
       left: -17px !important;
       background-color: #27ae60 !important;
       box-shadow: 0 3px 10px rgba(0,0,0,0.3) !important;
       z-index: 1003 !important;
     }
     
     /* Regular toggle styling */
     .section-nav-toggle {
       width: 31px !important;
       height: 31px !important;
       left: -15px !important;
       background-color: #1a73e8 !important;
       color: white !important;
       transition: all 0.3s ease !important;
       display: flex !important;
       align-items: center !important;
       justify-content: center !important;
     }
     
     /* Toggle hover effect */
     .section-nav-toggle:hover {
       transform: scale(1.15) !important;
       box-shadow: 0 4px 12px rgba(0,0,0,0.3) !important;
     }
   }
   
   /* Add smooth scrolling */
   html {
     scroll-behavior: smooth;
   }
   
   /* Better section targeting */
   [id] {
     scroll-margin-top: 160px;
   }
 `;
 document.head.appendChild(customStyle);
});


// Try to attach immediately and also after DOM loads
attachPrintButton();

if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', attachPrintButton);
} else {
    // Try again after a short delay in case elements are still loading
    setTimeout(attachPrintButton, 500);
}

// Mobile navigation button functionality
document.getElementById('mobileBackButton').addEventListener('click', function() {
    window.location.href = '../floors-dash/v-floor-b1.html';
});

document.getElementById('mobileMainMenuButton').addEventListener('click', function() {
    window.location.href = '../../index.html';
});



// Make function globally accessible
window.navigateToPage = navigateToPage;




// ✅ Attach function to window for external access
window.setupFlockLogListener = setupFlockLogListener;

</script>


<style>
body {
    font-family: Arial, sans-serif;
    margin: 0;
    margin-top: 64px;
    padding: 0;
    background-color: #f8f9fa;
    color: #333;
    font-size: 11px;
    line-height: 1.3;
    min-height: calc(100vh - 64px);
}
.main-content {
    width: 100%;
    max-width: 9.35in;
    margin: 0 auto;
    padding: 20px;
    transform: scale(1.10);
    transform-origin: top center;
    display: flex;
    flex-direction: column;
    align-items: center;
}
.page {
    width: 100%;
    max-width: 8.5in;
    margin: 0 auto;
}
     .page {
    margin-bottom: 50px;        /* Keep spacing between sections */
    padding-bottom: 30px;       /* Keep internal padding */
    border-bottom: none;        /* Remove the lines */
    page-break-after: always;   /* Keep print page breaks */
}
        .page:last-child {
            border-bottom: none;
            page-break-after: auto;
        }

        .page-title {
            font-size: 20px;
            font-weight: bold;
            text-align: center;
            margin-bottom: 30px;
            color: #2c3e50;
            border-bottom: 2px solid #2c3e50;
            padding-bottom: 10px;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 20px;
        }

        .logo-left, .logo-right {
            width: 80px;
            height: 80px;
            border-radius: 50%;
       
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 8px;
            text-align: center;
            flex-direction: column;
        }

        .title-section {
            flex-grow: 1;
            text-align: center;
            padding: 0 20px;
        }

        .main-title {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .subtitle {
            font-size: 12px;
            margin-bottom: 10px;
        }

        .version {
            font-size: 14px;
            font-weight: bold;
        }

        .header-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            font-weight: bold;
        }

        .header-note {
            text-align: right;
            font-style: italic;
            margin-bottom: 20px;
            color: #666;
        }

        .production-info {
            display: flex;
            gap: 40px;
            margin-bottom: 20px;
        }

        .left-column, .right-column {
            flex: 1;
        }

        .info-row {
            margin-bottom: 8px;
            display: flex;
            align-items: center;
        }

        .info-label {
            font-weight: bold;
            margin-right: 10px;
            min-width: 80px;
        }

        .info-value {
            border-bottom: 1px solid #666;
            flex-grow: 1;
            padding: 2px;
        }

        .section {
            margin-bottom: 25px;
            border: 1px solid #666;
            background-color: white;
        }

        .section-header {
         
            padding: 8px;
            font-weight: bold;
            font-size: 12px;
        }

        .section-content {
            padding: 10px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 15px;
        }

        th, td {
            border: 1px solid #666;
            padding: 6px;
            text-align: left;
            vertical-align: top;
        }

        th {
            background-color: #e9ecef;
            font-weight: bold;
            font-size: 10px;
        }

     

        .checkbox {
            width: 15px;
            height: 15px;
            border: 1px solid #666;
            display: inline-block;
            margin-right: 5px;
            position: relative;
        }

        .checkbox.checked::after {
            content: "✓";
            position: absolute;
            top: -3px;
            left: 2px;
            font-size: 12px;
            color: #333;
        }

        .note {
            font-style: italic;
            font-size: 10px;
            margin: 10px 0;
        }

        .handwriting {
            font-family: cursive;
            color: #0066cc;
        }

        .form-row {
            margin-bottom: 8px;
        }

        .form-row label {
            display: inline-block;
            width: 200px;
            font-weight: bold;
        }

        .input-field {
            border-bottom: 1px solid #666;
            display: inline-block;
            min-width: 150px;
            padding: 2px;
        }

        .signature-section {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
            padding-top: 15px;
            border-top: 1px solid #666;
        }

        .highlighted {
            background-color: #90EE90;
        }

        .crossed-out {
            text-decoration: line-through;
        }

        .task-description {
            width: 50%;
        }

        .date-column {
            width: 15%;
            text-align: center;
        }

        .product-column {
            width: 35%;
        }

        .signature-area {
            margin-top: 30px;
            text-align: center;
        }

@media screen and (max-width: 768px) {
    /* Hide desktop navigation */
    .nav-links {
        display: none !important;
    }
    
    /* Show mobile navigation */
    .mobile-nav {
        display: block !important;
    }
    
    /* Hide left sidebar navigation section on mobile */
    .left-sidebar .sidebar-section:first-child {
        display: none;
    }
    
    .left-sidebar {
        width: 60px;
        padding: 15px 8px;
        top: 165px; /* Adjust for mobile nav height */
        height: calc(100vh - 165px);
    }
    
    .sidebar-button span:not(.sidebar-icon) {
        display: none;
    }
    
    body {
        margin-left: 0 !important; /* Remove left margin for centering */
        margin-top: 180px; /* Adjust for mobile nav */
        padding: 0 20px !important; /* Add horizontal padding for margins */
        font-size: 10px;
        display: flex;
        justify-content: center; /* Center content horizontally */
        width: 100vw; /* Full viewport width */
        box-sizing: border-box;
    }
    
    .main-content {
        transform: scale(0.85) !important; /* Make everything bigger (was 0.7) */
        max-width: 160% !important; /* Keep section size the same */
        width: 160% !important;
        transform-origin: top center !important; /* Center the transform origin */
        margin: 0 auto !important; /* Center the content */
        padding: 15px !important;
        position: relative;
        left: -19%; /* Move 7% to the left from -12% (-12% + -7% = -19%) */
        right: 0;
    }
    
    .production-info {
        flex-direction: column;
        gap: 20px;
    }
    
    .logo-left, .logo-right {
        width: 60px;
        height: 60px;
        font-size: 7px;
    }
    
    th, td {
        padding: 4px;
        font-size: 9px;
    }
    
    .logo-img {
        height: 50px; /* Smaller logo on mobile */
    }
    
    /* Fix medications and feed transfer tables on mobile */
    .section:has(.section-header:contains("Medications")) table,
    .section:has(.section-header:contains("Feed Transfer Record")) table {
        font-size: 10px !important;
        table-layout: auto !important;
    }
    
    .section:has(.section-header:contains("Medications")) th,
    .section:has(.section-header:contains("Medications")) td,
    .section:has(.section-header:contains("Feed Transfer Record")) th,
    .section:has(.section-header:contains("Feed Transfer Record")) td {
        padding: 4px !important;
        font-size: 10px !important;
        word-wrap: break-word !important;
        overflow-wrap: break-word !important;
        hyphens: auto !important;
        line-height: 1.2 !important;
    }
    
    /* Fix medications checkbox layout - keep labels with checkboxes */
    .section:has(.section-header:contains("Medications")) .checkbox-container {
        display: flex !important;
        align-items: center !important;
        gap: 4px !important;
        margin-right: 8px !important;
        margin-bottom: 4px !important;
        white-space: nowrap !important;
    }
    
    .section:has(.section-header:contains("Medications")) .checkbox-container label {
        font-size: 9px !important;
        margin: 0 !important;
        white-space: nowrap !important;
    }
    
    .section:has(.section-header:contains("Medications")) input[type="checkbox"] {
        width: 14px !important;
        height: 14px !important;
        margin: 0 !important;
        flex-shrink: 0 !important;
    }
    
    /* Make the route of administration cell stack vertically */
    .section:has(.section-header:contains("Medications")) td:nth-child(2) {
        display: flex !important;
        flex-direction: column !important;
        gap: 4px !important;
        align-items: flex-start !important;
    }
    
    /* Apply responsive tactics to ALL other sections */
    .section table:not(.section:has(.section-header:contains("Medications")) table):not(.section:has(.section-header:contains("Feed Transfer Record")) table) {
        font-size: 9px !important;
        table-layout: auto !important;
    }
    
    .section th:not(.section:has(.section-header:contains("Medications")) th):not(.section:has(.section-header:contains("Feed Transfer Record")) th),
    .section td:not(.section:has(.section-header:contains("Medications")) td):not(.section:has(.section-header:contains("Feed Transfer Record")) td) {
        padding: 3px !important;
        font-size: 9px !important;
        word-wrap: break-word !important;
        overflow-wrap: break-word !important;
        hyphens: auto !important;
        line-height: 1.2 !important;
    }
    
    /* Water section responsive columns */
    .section:has(.section-header:contains("Water")) table th:first-child,
    .section:has(.section-header:contains("Water")) table td:first-child {
        width: 30% !important;
    }
    
    .section:has(.section-header:contains("Water")) table th:nth-child(2),
    .section:has(.section-header:contains("Water")) table td:nth-child(2),
    .section:has(.section-header:contains("Water")) table th:nth-child(3),
    .section:has(.section-header:contains("Water")) table td:nth-child(3) {
        width: 20% !important;
    }
    
    .section:has(.section-header:contains("Water")) table th:nth-child(4),
    .section:has(.section-header:contains("Water")) table td:nth-child(4) {
        width: 22% !important;
    }
    
    .section:has(.section-header:contains("Water")) table th:last-child,
    .section:has(.section-header:contains("Water")) table td:last-child {
        width: 8% !important;
    }
    
    /* Feed section responsive columns - make more readable */
    .section:has(.section-header:contains("Feed")) table th:first-child,
    .section:has(.section-header:contains("Feed")) table td:first-child,
    .section:has(.section-header:contains("Feed")) table th:nth-child(3),
    .section:has(.section-header:contains("Feed")) table td:nth-child(3) {
        width: 22% !important;
    }
    
    .section:has(.section-header:contains("Feed")) table th:nth-child(2),
    .section:has(.section-header:contains("Feed")) table td:nth-child(2) {
        width: 48% !important;
    }
    
    .section:has(.section-header:contains("Feed")) table th:last-child,
    .section:has(.section-header:contains("Feed")) table td:last-child {
        width: 8% !important;
    }
    
    /* Make Feed section more readable */
    .section:has(.section-header:contains("Feed")) table {
        font-size: 11px !important;
    }
    
    .section:has(.section-header:contains("Feed")) th,
    .section:has(.section-header:contains("Feed")) td {
        padding: 5px !important;
        font-size: 11px !important;
        line-height: 1.3 !important;
    }
    
    .section:has(.section-header:contains("Feed")) .section-header {
        font-size: 14px !important;
        padding: 10px !important;
        line-height: 1.4 !important;
    }
    
    /* Make Feed Transfer Record section more readable */
    .section:has(.section-header:contains("Feed Transfer Record")) table {
        font-size: 11px !important;
    }
    
    .section:has(.section-header:contains("Feed Transfer Record")) th,
    .section:has(.section-header:contains("Feed Transfer Record")) td {
        padding: 5px !important;
        font-size: 11px !important;
        line-height: 1.3 !important;
    }
    
    .section:has(.section-header:contains("Feed Transfer Record")) .section-header {
        font-size: 14px !important;
        padding: 10px !important;
        line-height: 1.4 !important;
    }
    
    /* Barn Cleaning section responsive columns */
    .section:has(.section-header:contains("BARN CLEANING")) table th:first-child,
    .section:has(.section-header:contains("BARN CLEANING")) table td:first-child {
        width: 50% !important;
    }
    
    .section:has(.section-header:contains("BARN CLEANING")) table th:nth-child(2),
    .section:has(.section-header:contains("BARN CLEANING")) table td:nth-child(2) {
        width: 20% !important;
    }
    
    .section:has(.section-header:contains("BARN CLEANING")) table th:nth-child(3),
    .section:has(.section-header:contains("BARN CLEANING")) table td:nth-child(3) {
        width: 30% !important;
    }
    
    /* Facilities Preparation section responsive columns */
    .section:has(.section-header:contains("Facilities Preparation")) table th:first-child,
    .section:has(.section-header:contains("Facilities Preparation")) table td:first-child {
        width: 50% !important;
    }
    
    .section:has(.section-header:contains("Facilities Preparation")) table th:nth-child(2),
    .section:has(.section-header:contains("Facilities Preparation")) table td:nth-child(2) {
        width: 20% !important;
    }
    
    .section:has(.section-header:contains("Facilities Preparation")) table th:nth-child(3),
    .section:has(.section-header:contains("Facilities Preparation")) table td:nth-child(3) {
        width: 30% !important;
    }
    
    /* Pest Control section responsive columns */
    .section:has(.section-header:contains("Pest Control")) table th:first-child,
    .section:has(.section-header:contains("Pest Control")) table td:first-child {
        width: 50% !important;
    }
    
    .section:has(.section-header:contains("Pest Control")) table th:nth-child(2),
    .section:has(.section-header:contains("Pest Control")) table td:nth-child(2) {
        width: 20% !important;
    }
    
    .section:has(.section-header:contains("Pest Control")) table th:nth-child(3),
    .section:has(.section-header:contains("Pest Control")) table td:nth-child(3) {
        width: 30% !important;
    }
    
    /* Deviation Chart section responsive columns */
    .section:has(.section-header:contains("Deviation Chart")) table th:first-child,
    .section:has(.section-header:contains("Deviation Chart")) table td:first-child {
        width: 15% !important;
    }
    
    .section:has(.section-header:contains("Deviation Chart")) table th:nth-child(2),
    .section:has(.section-header:contains("Deviation Chart")) table td:nth-child(2),
    .section:has(.section-header:contains("Deviation Chart")) table th:nth-child(3),
    .section:has(.section-header:contains("Deviation Chart")) table td:nth-child(3),
    .section:has(.section-header:contains("Deviation Chart")) table th:nth-child(4),
    .section:has(.section-header:contains("Deviation Chart")) table td:nth-child(4) {
        width: 26% !important;
    }
    
    .section:has(.section-header:contains("Deviation Chart")) table th:last-child,
    .section:has(.section-header:contains("Deviation Chart")) table td:last-child {
        width: 7% !important;
    }
    
    /* Make medication table columns more responsive */
    .section:has(.section-header:contains("Medications")) table th:first-child,
    .section:has(.section-header:contains("Medications")) table td:first-child {
        width: 20% !important;
    }
    
    .section:has(.section-header:contains("Medications")) table th:nth-child(2),
    .section:has(.section-header:contains("Medications")) table td:nth-child(2) {
        width: 15% !important;
    }
    
    .section:has(.section-header:contains("Medications")) table th:nth-child(3),
    .section:has(.section-header:contains("Medications")) table td:nth-child(3),
    .section:has(.section-header:contains("Medications")) table th:nth-child(4),
    .section:has(.section-header:contains("Medications")) table td:nth-child(4) {
        width: 12% !important;
    }
    
    .section:has(.section-header:contains("Medications")) table th:nth-child(5),
    .section:has(.section-header:contains("Medications")) table td:nth-child(5),
    .section:has(.section-header:contains("Medications")) table th:nth-child(6),
    .section:has(.section-header:contains("Medications")) table td:nth-child(6) {
        width: 18% !important;
    }
    
    /* Make feed transfer table columns more responsive */
    .section:has(.section-header:contains("Feed Transfer Record")) table th,
    .section:has(.section-header:contains("Feed Transfer Record")) table td {
        width: 12.5% !important;
    }
    
    .section:has(.section-header:contains("Feed Transfer Record")) table th:last-child,
    .section:has(.section-header:contains("Feed Transfer Record")) table td:last-child {
        width: 8% !important;
    }
    
    /* Make checkboxes and inputs smaller in these tables */
    .section:has(.section-header:contains("Medications")) input[type="checkbox"],
    .section:has(.section-header:contains("Feed Transfer Record")) input[type="checkbox"] {
        width: 12px !important;
        height: 12px !important;
    }
    
    .section:has(.section-header:contains("Medications")) .checkbox-container,
    .section:has(.section-header:contains("Feed Transfer Record")) .checkbox-container {
        margin-right: 5px !important;
        margin-bottom: 2px !important;
    }
    
    .section:has(.section-header:contains("Medications")) .checkbox-container label,
    .section:has(.section-header:contains("Feed Transfer Record")) .checkbox-container label {
        font-size: 7px !important;
    }
    
    /* Make Daily Checks text larger and checkboxes bigger */
    .section:has(.section-header:contains("Daily Checks")) {
        font-size: 14px !important;
    }
    
    .section:has(.section-header:contains("Daily Checks")) label {
        font-size: 14px !important;
        line-height: 1.4 !important;
    }
    
    .section:has(.section-header:contains("Daily Checks")) input[type="checkbox"] {
        width: 18px !important;
        height: 18px !important;
        margin: 4px !important;
    }
    
    .section:has(.section-header:contains("Daily Checks")) .checkbox-container {
        margin-right: 15px !important;
        margin-bottom: 12px !important;
        display: flex !important;
        align-items: center !important;
        gap: 8px !important;
    }
    
    /* Make BARN CLEANING header text larger */
    .section:has(.section-header:contains("BARN CLEANING")) .section-header {
        font-size: 16px !important;
        padding: 12px !important;
    }
    
    .section:has(.section-header:contains("BARN CLEANING")) th {
        font-size: 11px !important;
        padding: 6px !important;
        line-height: 1.3 !important;
    }
    
    /* Make table inputs fill their cells completely */
    .table-input {
        width: 100% !important;
        height: 100% !important;
        border: none !important;
        background: transparent !important;
        padding: 4px !important;
        font-size: 11px !important;
        box-sizing: border-box !important;
        min-height: 30px !important;
        resize: vertical !important;
    }
    
    /* Special handling for textarea inputs in tables */
    .table-input[type="textarea"], 
    textarea.table-input {
        min-height: 40px !important;
        resize: vertical !important;
    }
    
    /* Make table cells accommodate full-width inputs */
    .section table td {
        padding: 2px !important;
        vertical-align: top !important;
    }
    
    .section table td input,
    .section table td textarea,
    .section table td select {
        width: 100% !important;
        height: 100% !important;
        border: none !important;
        background: transparent !important;
        font-size: 11px !important;
        padding: 4px !important;
        box-sizing: border-box !important;
        min-height: 30px !important;
    }

    
}
</style>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Farm Records</title>
    <style>
        /* Form input styles */
        input[type="text"], input[type="date"], textarea, select {
            border: 1px solid #666;
            padding: 4px;
            font-size: 10px;
            font-family: Arial, sans-serif;
            background-color: white;
            width: 100%;
            box-sizing: border-box;
        }

        input[type="checkbox"] {
            width: 15px;
            height: 15px;
            margin: 2px;
        }

        .form-input {
            min-width: 80px;
            display: inline-block;
        }

        .small-input {
            width: 60px;
        }

        .medium-input {
            width: 120px;
        }

        .large-input {
            width: 200px;
        }

        .full-width {
            width: 100%;
        }

        textarea {
            height: 40px;
            resize: vertical;
        }

        .checkbox-container {
            display: inline-flex;
            align-items: center;
            margin-right: 15px;
            margin-bottom: 5px;
        }

        .checkbox-container label {
            margin-left: 5px;
            font-size: 10px;
        }

        .radio-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .radio-option {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        input[type="radio"] {
            width: 15px;
            height: 15px;
        }

        .form-row {
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .form-label {
            font-weight: bold;
            min-width: 150px;
        }

        .table-input {
            border: none;
            background: transparent;
            padding: 2px;
            font-size: 10px;
        }

        .table-input:focus {
            background-color: #f0f8ff;
            border: 1px solid #3498db;
        }

        

        .signature-input {
            border-bottom: 1px solid #666;
            border-top: none;
            border-left: none;
            border-right: none;
            background: transparent;
            min-width: 150px;
            padding: 2px;
        }

        
    
    </style>

    
<style>
/* Targeted improvements for iPhone and small mobile screens */
@media screen and (max-width: 480px) {
    /* Daily Checks section text */
    .section:has(.section-header:contains("Daily Checks")) .checkbox-container label {
        font-size: 15px !important;
        font-weight: bold !important;
        line-height: 1.3 !important;
    }
    
    /* Make checkboxes larger for easier tapping */
    input[type="checkbox"] {
        width: 20px !important;
        height: 20px !important;
    }
    
    /* Specific checkbox labels in Daily Checks */
    .checkbox-container label[for="feedquality"],
    .checkbox-container label[for="thermal"],
    .checkbox-container label[for="templevels"],
    .checkbox-container label[for="humiditylevels"],
    .checkbox-container label[for="wateravail"],
    .checkbox-container label[for="flockhealth"],
    .checkbox-container label[for="ventilation"],
    .checkbox-container label[for="ammonialevels"],
    .checkbox-container label[for="waterquality"],
    .checkbox-container label[for="heatingsystem"],
    .checkbox-container label[for="lightingsystem"],
    .checkbox-container label[for="litterquality"],
    .checkbox-container label[for="birdsinspected"] {
        font-size: 14px !important;
    }
    
    /* Deviation Chart checkboxes */
    .checkbox-container label[for="temp"],
    .checkbox-container label[for="lighting"],
    .checkbox-container label[for="humidity"],
    .checkbox-container label[for="mortality"],
    .checkbox-container label[for="bedding"],
    .checkbox-container label[for="medication"],
    .checkbox-container label[for="alarms"] {
        font-size: 14px !important;
    }
    
    /* Medication route of administration */
    .checkbox-container label[for*="feed"],
    .checkbox-container label[for*="water"] {
        font-size: 14px !important;
    }
    
    /* Section headers */
    .section-header {
        font-size: 14px !important;
        padding: 8px !important;
    }
    
    /* Table headers */
    th {
        font-size: 12px !important;
        padding: 5px !important;
    }
}

/* Add these lines to the previous CSS block */

/* Pest Control section header */
.section-header:contains("Pest Control") {
    font-size: 15px !important;
    padding: 10px !important;
    line-height: 1.4 !important;
}

/* Facilities Preparation section header */
.section-header:contains("Facilities Preparation") {
    font-size: 15px !important;
    padding: 10px !important;
    line-height: 1.4 !important;
}

/* BARN CLEANING header and subheaders */
.section-header:contains("BARN CLEANING"),
th:contains("DATE(S) COMPLETED"),
th:contains("RECORD THE PRODUCT NAME") {
    font-size: 15px !important;
    padding: 10px !important;
    line-height: 1.4 !important;
}

/* Make sure these section headers are always bold */
.section-header {
    font-weight: bold !important;
}

/* Target specific table headers by their exact content */
@media screen and (max-width: 480px) {
    /* BARN CLEANING header and column labels */
    .section-header:contains("BARN CLEANING"),
    th.task-description:contains("BARN CLEANING"),
    th:contains("DATE(S) COMPLETED"),
    th:contains("RECORD THE PRODUCT NAME AND/OR A DESCRIPTION") {
        font-size: 15px !important;
        font-weight: bold !important;
        padding: 8px !important;
        line-height: 1.4 !important;
    }
    
    /* Facilities Preparation headers */
    .section-header:contains("Facilities Preparation"),
    th.task-description:contains("Facilities Preparation"),
    th.date-column:contains("Date(s)"),
    th.product-column:contains("Description/Results") {
        font-size: 15px !important;
        font-weight: bold !important;
        padding: 8px !important;
        line-height: 1.4 !important;
    }
    
    /* Pest Control headers */
    .section-header:contains("Pest Control"),
    th.task-description:contains("Pest Control"),
    th.date-column:contains("Date(s)"),
    th.product-column:contains("Description/Product") {
        font-size: 15px !important;
        font-weight: bold !important;
        padding: 8px !important;
        line-height: 1.4 !important;
    }
    
    /* More generic approach to catch these table headers */
    th.task-description,
    th.date-column,
    th.product-column {
        font-size: 15px !important;
        font-weight: bold !important;
        padding: 8px !important;
        line-height: 1.4 !important;
    }
    
    /* Direct selector approach as a fallback */
    table th:first-child,
    table th:nth-child(2),
    table th:nth-child(3) {
        font-size: 15px !important;
        font-weight: bold !important;
        padding: 8px !important;
    }
}
</style>

<style>
/* Target specific table header text */
@media screen and (max-width: 480px) {
    /* Specific text in Pest Control section */
    .section:has(.section-header:contains("Pest Control")) th:contains("Description/Product") {
        font-size: 15px !important;
        font-weight: bold !important;
        line-height: 1.4 !important;
    }
    
    /* Specific text in Facilities Preparation section */
    .section:has(.section-header:contains("Facilities Preparation")) th:contains("Description/Results") {
        font-size: 15px !important;
        font-weight: bold !important;
        line-height: 1.4 !important;
    }
    
    /* Specific text in BARN CLEANING section */
    .section:has(.section-header:contains("BARN CLEANING")) th:contains("RECORD THE PRODUCT NAME") {
        font-size: 15px !important;
        font-weight: bold !important;
        line-height: 1.4 !important;
    }
    
    /* More direct approach as fallback */
    .product-column, 
    th:nth-child(3),
    th.product-column {
        font-size: 15px !important;
        font-weight: bold !important;
    }
}
</style>
<style>
/* Direct targeting of table headers on mobile */
@media screen and (max-width: 480px) {
    /* Target all section headers to ensure they're readable */
    .section-header {
        font-size: 16px !important;
        padding: 10px !important;
        line-height: 1.4 !important;
        font-weight: bold !important;
    }
    
    /* Target the column headers in these sections */
    .table-header-dark th {
        font-size: 14px !important;
        font-weight: bold !important;
        padding: 8px !important;
        line-height: 1.4 !important;
    }
    
    /* Specifically target the task description columns */
    .task-description {
        font-size: 15px !important;
        font-weight: bold !important;
    }
    
    /* Target date columns */
    .date-column {
        font-size: 15px !important;
        font-weight: bold !important;
    }
    
    /* Target product columns */
    .product-column {
        font-size: 15px !important;
        font-weight: bold !important;
    }
    
    /* Override for column headers - very direct approach */
    table th {
        font-size: 15px !important;
        font-weight: bold !important;
        padding: 8px !important;
        line-height: 1.4 !important;
    }
    
    /* Make section headers for Barn Cleaning, Facilities and Pest Control more prominent */
    .section:nth-of-type(2) .section-header,
    .section:nth-of-type(3) .section-header,
    .section:nth-of-type(4) .section-header {
        font-size: 18px !important;
        padding: 12px !important;
    }
    
    /* Make all table headers in the Barn Cleaning, Facilities, and Pest Control sections larger */
    .section:nth-of-type(2) th,
    .section:nth-of-type(3) th,
    .section:nth-of-type(4) th {
        font-size: 16px !important;
        padding: 10px !important;
        line-height: 1.5 !important;
    }
}
</style>
<style>
/* Direct targeting of specific table header cells */
@media screen and (max-width: 480px) {
    /* Target Pest Control "Description/Product" column */
    .section-content table th:nth-child(3),
    .product-column,
    th.product-column {
        font-size: 15px !important;
        font-weight: bold !important;
        line-height: 1.4 !important;
        padding: 8px !important;
    }
    
    /* Target all third columns in all tables - typically the description columns */
    table th:nth-child(3) {
        font-size: 15px !important;
        font-weight: bold !important;
    }
    
    /* Force all product columns and description columns to be larger */
    th[class*="product"],
    th:nth-child(3) {
        font-size: 15px !important;
        font-weight: bold !important;
    }
    
    /* Target specific columns by position in specific sections */
    /* Barn Cleaning section */
    .section:has(.section-header:first-child) th:nth-child(3) {
        font-size: 15px !important;
        font-weight: bold !important;
    }
    
    /* Last attempt - add !important to all styles */
    .task-description,
    .date-column,
    .product-column,
    table th:nth-child(3),
    table th:last-child {
        font-size: 15px !important;
        font-weight: bold !important;
        line-height: 1.5 !important;
        padding: 8px !important;
    }
    
    /* Extreme approach - target all table cells with very specific styling */
    table td, table th {
        font-size: 14px !important;
    }
    
    /* Universal table header styles */
    th {
        font-size: 15px !important;
        font-weight: bold !important;
        padding: 8px !important;
    }
}
</style>
<style>
/* Adjustments for specific table headers and layout */
@media screen and (max-width: 480px) {
    /* Make Description/Results 1px smaller */
    .section:has(.section-header:contains("Facilities Preparation")) th:nth-child(3),
    .section:has(.section-header:contains("Facilities Preparation")) .product-column {
        font-size: 14px !important; /* 1px smaller than before */
    }
    
    /* For BARN CLEANING section - prevent text wrapping and enable horizontal scroll */
    .section:has(.section-header:contains("BARN CLEANING")) {
        width: 100% !important;
        overflow-x: auto !important; /* Enable horizontal scrolling */
        -webkit-overflow-scrolling: touch !important; /* Smooth scrolling on iOS */
    }
    
    .section:has(.section-header:contains("BARN CLEANING")) table {
        width: auto !important; /* Let table be its natural width */
        min-width: 100% !important; /* Ensure it takes full container width */
        table-layout: fixed !important; /* Fixed layout to prevent wrapping */
    }
    
    .section:has(.section-header:contains("BARN CLEANING")) th {
        white-space: nowrap !important; /* Prevent text wrapping */
        width: auto !important; /* Let cell be as wide as its content */
    }
    
    /* Make sure the RECORD THE PRODUCT NAME column is wide enough */
    .section:has(.section-header:contains("BARN CLEANING")) th:nth-child(3) {
        min-width: 180px !important; /* Set minimum width to prevent wrapping */
    }
    
    /* General improvements for horizontal scrolling on tables */
    .section-content {
        overflow-x: auto !important;
        -webkit-overflow-scrolling: touch !important;
    }
    
    /* Ensure tables don't break layout on small screens */
    .section table {
        min-width: 100% !important;
    }
}
</style>
<style>
/* Targeted horizontal scrolling for specific sections on iPhone */
@media screen and (max-width: 480px) {
  /* Apply to all section content areas - we'll target specific ones by ID or position */
  .section .section-content {
    overflow-x: auto !important;
    -webkit-overflow-scrolling: touch !important;
  }
  
  /* Target specific sections by their position or other attributes */
  /* For BARN CLEANING - usually in the second page, first section */
  .page:nth-of-type(2) .section:nth-of-type(1) .section-content,
  
  /* For other specific sections */
  .section:nth-of-type(3) .section-content, /* Deviation Chart */
  .section:nth-of-type(1) .section-content, /* Water section */
  .section:nth-of-type(2) .section-content { /* Feed section */
    overflow-x: auto !important;
    -webkit-overflow-scrolling: touch !important;
  }
  
  /* Make these specific tables wider */
  .page:nth-of-type(2) .section:nth-of-type(1) table,
  .section:nth-of-type(3) table,
  .section:nth-of-type(1) table,
  .section:nth-of-type(2) table {
    min-width: 650px !important;
    width: 650px !important;
  }
  
  /* Add scroll indicator to these sections */
  .page:nth-of-type(2) .section:nth-of-type(1) .section-content::after,
  .section:nth-of-type(3) .section-content::after,
  .section:nth-of-type(1) .section-content::after,
  .section:nth-of-type(2) .section-content::after {
    content: "⟷ Scroll sideways";
    display: block;
    text-align: center;
    font-size: 12px;
    color: #666;
    padding: 5px;
    margin-top: 5px;
  }
  
  /* Simpler fallback - make ALL section content areas scrollable */
  .section-content {
    overflow-x: auto !important;
    -webkit-overflow-scrolling: touch !important;
  }
  
  /* Make ALL tables in sections wider */
  .section table {
    min-width: 650px !important;
    width: 650px !important;
  }
}
</style>
<style>
/* Additional horizontal scrolling specifically for Chick Quality Assessment */
@media screen and (max-width: 480px) {
  /* Make Chick Quality Assessment horizontally scrollable */
  .right-column {
    overflow-x: auto !important;
    -webkit-overflow-scrolling: touch !important;
    max-width: 100% !important;
  }
  
  /* Make the table wider for better readability */
  .right-column table {
    min-width: 650px !important;
    width: 650px !important;
  }
  
  /* Ensure Chick Quality title stays visible */
  .right-column > div:first-child {
    font-weight: bold !important;
    margin-bottom: 10px !important;
    position: sticky !important;
    left: 0 !important;
  }
  
  /* Add scroll indicator */
  .right-column::after {
    content: "⟷ Scroll sideways";
    display: block;
    text-align: center;
    font-size: 12px;
    color: #666;
    padding: 5px;
    margin-top: 5px;
  }
}
</style>
<style>
/* iPhone and mobile fixes for form inputs */
@media screen and (max-width: 480px) {
    /* Daily Checks signature section - make everything bigger for iPhone */
    .section:has(.section-header:contains("Daily Checks")) .signature-section .form-row {
        display: flex !important;
        flex-direction: row !important;
        align-items: center !important;
        gap: 10px !important;
        margin-bottom: 15px !important;
        flex-wrap: nowrap !important;
    }
    
    /* Fix the specific date row in Daily Checks to align horizontally */
    .section:has(.section-header:contains("Daily Checks")) .form-row:has(input[type="date"]) {
        display: flex !important;
        flex-direction: row !important;
        align-items: center !important;
        gap: 10px !important;
        margin-bottom: 15px !important;
        flex-wrap: nowrap !important;
    }
    
    .section:has(.section-header:contains("Daily Checks")) .signature-section input[type="date"],
    .section:has(.section-header:contains("Daily Checks")) input[type="date"] {
        width: 160px !important;
        min-height: 50px !important;
        font-size: 18px !important;
        padding: 12px !important;
        border: 2px solid #666 !important;
        border-radius: 6px !important;
        flex-shrink: 0 !important;
    }
    
    .section:has(.section-header:contains("Daily Checks")) .signature-section .signature-input {
        min-height: 50px !important;
        font-size: 18px !important;
        padding: 12px !important;
        border-bottom: 3px solid #666 !important;
        width: 250px !important;
        flex-grow: 1 !important;
    }
    
    .section:has(.section-header:contains("Daily Checks")) .signature-section .form-row label,
    .section:has(.section-header:contains("Daily Checks")) .form-row label {
        font-size: 18px !important;
        font-weight: bold !important;
        min-width: 90px !important;
        width: 90px !important;
        margin-bottom: 0 !important;
        flex-shrink: 0 !important;
        display: inline-block !important;
    }
    
    /* Daily Checks additional notes textarea - bigger for iPhone */
    .section:has(.section-header:contains("Daily Checks")) textarea[placeholder*="Additional comments"] {
        min-height: 100px !important;
        font-size: 18px !important;
        padding: 15px !important;
        border: 2px solid #666 !important;
        border-radius: 6px !important;
        width: 100% !important;
    }
    
    /* Feed section signature input - bigger for iPhone */
    #feedSignature {
        min-height: 50px !important;
        font-size: 18px !important;
        padding: 12px !important;
        border-bottom: 3px solid #666 !important;
        width: 220px !important;
    }
    
    /* Placement notes textarea in chick quality section - bigger for iPhone */
    textarea[placeholder*="Additional comments or notes"] {
        min-height: 100px !important;
        font-size: 18px !important;
        padding: 15px !important;
        border: 2px solid #666 !important;
        border-radius: 6px !important;
        width: 100% !important;
        box-sizing: border-box !important;
    }
    
    /* Label for placement notes - bigger for iPhone */
    label:has(+ textarea[placeholder*="Additional comments or notes"]) {
        font-size: 18px !important;
        font-weight: bold !important;
        margin-bottom: 10px !important;
        display: block !important;
    }
    
    /* Make the "Placement notes:" label bigger */
    div:has(textarea[placeholder*="Additional comments or notes"]) label {
        font-size: 18px !important;
        font-weight: bold !important;
        margin-bottom: 10px !important;
        display: block !important;
    }
    
    /* Make "Flock Information" text larger */
    .header-info span {
        font-size: 20px !important;
        font-weight: bold !important;
    }
    
    /* Make "Barn Preparation Checklist" title larger */
    .page-title {
        font-size: 24px !important;
        font-weight: bold !important;
        margin-bottom: 25px !important;
    }
    
    /* Make Feed section "Notes:" text 30% smaller */
    .entry-note-input + label,
    label[style*="font-weight: bold; font-size: 10px"] {
        font-size: 7px !important;
    }
    
    .entry-note-input ~ label,
    div:has(.entry-note-input) label {
        font-size: 7px !important;
    }
    
    /* Make Production Information section bigger */
    .production-info {
        font-size: 16px !important;
        padding: 20px !important;
        margin-bottom: 30px !important;
        border: 2px solid #dee2e6 !important;
        border-radius: 8px !important;
        background-color: #f8f9fa !important;
    }
    
    .production-info .left-column > div:first-child,
    .production-info .right-column > div:first-child {
        font-size: 18px !important;
        font-weight: bold !important;
        margin-bottom: 15px !important;
    }
    
    .production-info .info-label {
        font-size: 14px !important;
        font-weight: bold !important;
        min-width: 140px !important;
        width: 140px !important;
        flex-shrink: 0 !important;
    }
    
    .production-info .info-value-no-underline {
        font-size: 14px !important;
        font-weight: bold !important;
    }
    
    .production-info .info-row {
        display: flex !important;
        align-items: center !important;
        gap: 10px !important;
        margin-bottom: 8px !important;
    }
    
    .production-info input[type="text"] {
        font-size: 14px !important;
        min-height: 40px !important;
        padding: 10px !important;
        border: 2px solid #666 !important;
        border-radius: 4px !important;
        flex-grow: 1 !important;
        width: auto !important;
    }
}
</style>
<style>
/* iPhone-specific fix for Daily Checks signature and date inputs */
@media screen and (max-width: 480px) {
  /* Force all form rows in signature section to display properly */
  .signature-section .form-row {
    display: flex !important;
    flex-direction: row !important;
    align-items: center !important;
    width: 100% !important;
    margin-bottom: 20px !important; /* Increased space between rows */
  }
  
  /* Make the labels smaller and fixed width with consistent spacing */
  .signature-section .form-row label {
    font-size: 16px !important;
    min-width: 90px !important; /* Wider to fit "Signature:" */
    width: 90px !important;
    margin-right: 12px !important; /* More space between label and input */
    flex-shrink: 0 !important;
  }
  
  /* Make signature input properly sized with larger text */
  .signature-section input[type="text"],
  .signature-section .signature-input {
    height: 48px !important; /* Taller for easier tapping */
    min-height: 48px !important;
    font-size: 18px !important; /* Larger text */
    padding: 8px 2px !important; /* Padding on top/bottom only */
    border-bottom: 2px solid #666 !important; /* Thicker bottom border */
    width: 200px !important; /* Fixed width */
  }
  
  /* Make date input properly sized */
  .signature-section input[type="date"] {
    width: 200px !important;
    min-height: 48px !important; /* Match signature height */
    font-size: 16px !important;
    padding: 8px !important;
  }
}
</style>
<style>
/* Fix for medication route of administration checkboxes on iPhone - adjusted by additional 15px */
@media screen and (max-width: 480px) {
    /* Direct targeting of the feed/water checkboxes and labels */
    .section:has(.section-header:contains("Medications")) td:nth-child(2) .checkbox-container {
        margin-right: 0 !important; /* Remove default right margin */
        padding-right: 0 !important;
        display: flex !important;
        align-items: center !important;
        margin-bottom: 12px !important; /* More space between stacked checkboxes */
        position: relative !important;
        left: -75px !important; /* Adjusted: -60px → -75px (additional 15px) */
    }
    
    /* Target the labels specifically */
    .section:has(.section-header:contains("Medications")) td:nth-child(2) .checkbox-container label {
        margin-left: 4px !important; /* Space between checkbox and label */
        font-size: 14px !important; /* Larger text */
        font-weight: bold !important; /* Bolder text */
        white-space: nowrap !important; /* Prevent wrapping */
    }
    
    /* Make checkboxes bigger for easier tapping */
    .section:has(.section-header:contains("Medications")) td:nth-child(2) input[type="checkbox"] {
        width: 18px !important;
        height: 18px !important;
        margin: 0 !important;
    }
    
    /* Force column to be wider */
    .section:has(.section-header:contains("Medications")) td:nth-child(2) {
        padding-left: 85px !important; /* Adjusted: 70px → 85px (additional 15px) */
        position: relative !important; /* For absolute positioning within */
    }
    
    /* Nuclear option - directly target all feed/water labels using their IDs */
    label[for*="feed"], label[for*="water"] {
        position: relative !important;
        left: -75px !important; /* Adjusted: -60px → -75px (additional 15px) */
        display: inline-block !important;
        margin-left: 2px !important;
        font-weight: bold !important;
        font-size: 14px !important;
    }
    
    /* Force feed/water to stay with checkboxes */
    input[id*="feed"] + label, input[id*="water"] + label {
        position: relative !important;
        left: -75px !important; /* Adjusted: -60px → -75px (additional 15px) */
    }
}
</style>
<style>
/* Adjust "Notes:" text size in Feed and Feed Transfer sections on iPhone */
@media screen and (max-width: 480px) {
    /* Target labels inside note rows */
    tr.note-row td div label,
    .note-row td div label,
    div[style*="padding: 5px"] label[style*="font-weight"],
    label:has(+ .entry-note-input) {
        font-size: 12px !important; /* Match regular text size */
        font-weight: bold !important; /* Keep it bold for visibility */
        line-height: 1.4 !important; /* Good line height for readability */
        margin-bottom: 5px !important; /* Space before the textarea */
        display: block !important; /* Make it stand on its own line */
        color: #333 !important; /* Dark gray color for better contrast */
    }
    
    /* Add a bit more space below the label before the textarea */
    tr.note-row td div,
    .note-row td div,
    div[style*="padding: 5px"] {
        padding-top: 8px !important; /* Space at the top of the note cell */
    }
    
    /* Make the textarea have a bit more space at the top */
    .entry-note-input {
        margin-top: 6px !important;
    }
}
</style>
<style>
/* Make the logo image 10% bigger on iPhone */
@media screen and (max-width: 480px) {
    /* Target the main logo image */
    .main-logo-img,
    img[src*="rosefarmmangement.jpeg"],
    .logo-img,
    .logo-section img {
        height: calc(1.1 * 39px) !important; /* 10% bigger than original (39px) */
        width: auto !important; /* Maintain aspect ratio */
        max-height: none !important; /* Override max-height restrictions */
        transform: scale(1.1) !important; /* Scale by 10% */
        transform-origin: left center !important; /* Scale from left side */
        margin: 2px 0 !important; /* Small margin for spacing */
    }
    
    /* Adjust logo section for slightly bigger logo */
    .logo-section {
        min-height: calc(1.1 * 39px + 4px) !important; /* Logo height plus margin */
        display: flex !important;
        align-items: center !important;
        padding: 2px 0 !important;
    }
    
    /* Adjust header height for slightly bigger logo */
    .modern-header {
        height: auto !important;
        min-height: calc(1.1 * 39px + 8px) !important; /* Logo height plus padding */
        padding: 4px 0 !important;
    }
    
    /* Ensure header container has proper spacing */
    .header-container {
        min-height: calc(1.1 * 39px + 4px) !important;
        padding: 2px 16px !important;
    }
}
</style>
<style>
    /* Adjust "Notes:" text size in Feed and Feed Transfer sections on iPhone */
@media screen and (max-width: 480px) {
    /* Target labels inside note rows */
    tr.note-row td div label,
    .note-row td div label,
    div[style*="padding: 5px"] label[style*="font-weight"],
    label:has(+ .entry-note-input) {
        font-size: 12px !important; /* Match regular text size */
        font-weight: bold !important; /* Keep it bold for visibility */
        line-height: 1.4 !important; /* Good line height for readability */
        margin-bottom: 5px !important; /* Space before the textarea */
        display: block !important; /* Make it stand on its own line */
        color: #333 !important; /* Dark gray color for better contrast */
    }
    
    /* Add a bit more space below the label before the textarea */
    tr.note-row td div,
    .note-row td div,
    div[style*="padding: 5px"] {
        padding-top: 8px !important; /* Space at the top of the note cell */
    }
    
    /* Make the textarea have a bit more space at the top */
    .entry-note-input {
        margin-top: 6px !important;
    }
    
    /* Move only the text labels 0px to the right, keep checkboxes in place */
    .checkbox-container:has(#feedquality) label,
    .checkbox-container:has(#wateravail) label,
    .checkbox-container:has(#waterquality) label {
        position: relative !important;
        left: 0px !important;
        transform: translateX(0px) !important;
    }
}
</style>
<style>
    /* Import Inter font */
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');

/* Base font change only - no positioning changes */
body, input, textarea, select, button, label, th, td {
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
}

/* Section headers - only color and font changes */
.section-header {
    background-color: #1a73e8;
    color: white;
    font-weight: 500;
}

/* Improved form inputs - visual only */
input[type="text"], input[type="date"], textarea, select {
    border-color: #ced4da;
    border-radius: 6px;
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
    transition: border-color 0.2s ease;
}

input[type="text"]:focus, input[type="date"]:focus, textarea:focus, select:focus {
    border-color: #1a73e8;
    outline: none;
    box-shadow: 0 0 0 3px rgba(26, 115, 232, 0.2);
}

/* Modern Add Entry buttons - styling only, no positioning changes */
button[id*="add"] {
    background-color: #1a73e8; 
    color: white; 
    padding: 10px 20px; 
    font-size: 14px; 
    border: none; 
    border-radius: 8px; 
    cursor: pointer; 
    box-shadow: 0 2px 4px rgba(0,0,0,0.2); 
    transition: all 0.2s ease;
    font-weight: 500;
    letter-spacing: 0.3px;
}

button[id*="add"]:hover {
    background-color: #1557b0;
    box-shadow: 0 4px 8px rgba(0,0,0,0.3);
    transform: translateY(-1px);
}

button[id*="add"]:active {
    transform: translateY(1px);
    box-shadow: 0 1px 2px rgba(0,0,0,0.2);
}

/* Delete buttons - visual only */
button[onclick*="delete"] {
    background-color: #e53935;
    color: white;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    transition: all 0.2s ease;
    box-shadow: 0 1px 3px rgba(0,0,0,0.2);
}

button[onclick*="delete"]:hover {
    background-color: #c62828;
    box-shadow: 0 2px 5px rgba(0,0,0,0.3);
}

/* Accent color for checkboxes */
input[type="checkbox"] {
    accent-color: #1a73e8;
}
/* Responsive Quick Nav for smaller laptops */
@media screen and (min-width: 769px) and (max-width: 1366px) {
  .section-navigator {
    right: 3px; /* Position closer to edge */
    width: 100px; /* Make narrower */
    padding: 7px; /* Reduce padding */
    font-size: 9px; /* Smaller font */
    max-height: 80vh; /* Limit height */
    overflow-y: auto; /* Enable scrolling if needed */
  }
  
  .section-nav-header {
    font-size: 12px;
    margin-bottom: 8px;
    padding-bottom: 5px;
  }
  
  .section-nav-items {
    gap: 6px;
  }
  
  .section-nav-item {
    padding: 4px 6px;
    font-size: 11px;
  }
}

/* Ensure it stays hidden on mobile - your existing mobile rule */
@media screen and (max-width: 768px) {
  .section-navigator {
    display: none;
  }
}
/* Adjust Quick Nav position on laptops */
@media screen and (min-width: 769px) {
  .section-navigator {
    margin-top: 25px; /* Add 25px margin from the top */
    top: calc(50% + 25px); /* Adjust the top positioning to account for margin */
  }
}
</style>

</html>